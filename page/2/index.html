<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Flutter-入门指北-10" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/28/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-10/" class="article-date">
  <time datetime="2019-03-28T01:05:37.000Z" itemprop="datePublished">2019-03-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/28/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-10/">Flutter Guide(10) -- 入门 Flutter 的手势交互和动画</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在 <code>Flutter</code> 中，自带手势监听的目前为止好像只有按钮部件和一些 <code>chip</code> 部件，例如 <code>Text</code> 等部件需要实现手势监听，就需要借助带有监听事件的部件来实现了，这节我们会讲下 <code>InkWell</code> 和 <code>GestureDetector</code> 来实现手势的监听。</p>
<h4 id="InkWell"><a href="#InkWell" class="headerlink" title="InkWell"></a>InkWell</h4><p>在前面的一些例子中，小伙伴应该看到了好几次 <code>InkWell</code> 这个部件，通过它我们可以实现对一些手势的监听，并实现 <code>MD</code> 的水波纹效果，举个简单的一个例子</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">InkWell(</span><br><span class="line">  child: Text(<span class="string">&#x27;点我...点我...我能响应点击手势&#x27;</span>),</span><br><span class="line">  onTap: () =&gt; <span class="built_in">print</span>(<span class="string">&#x27;啊...我被点击了...&#x27;</span>)</span><br><span class="line">),</span><br></pre></td></tr></table></figure>

<p>那么当点击 <code>Text</code> 的时候就会响应点击事件，控制台输出日志</p>
<p>我们还是老套路，分析下源码。<code>Ctrl</code> 点击 <code>InkWell</code> 来查看源码(<code>Android Studio</code> 的操作，别的我不懂喔…)，然后，「嗯…除了构造函数怎么什么都没有？？？」那只能看它的父类 <code>InkResponse</code> 了，在那之前，我们看下 <code>InkWell</code> 的说明</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">A rectangular area of a [Material] that responds to touch.</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>InkWell</code> 是在 <strong><code>MaterialDesign</code></strong> 风格下的一个用来响应触摸的<strong>矩形区域</strong>（注意加粗的文字，1.如果不是 <code>MD</code> 风格的部件下，你是不能用这个来做点击响应的；2.<code>InkWell</code> 是一块矩形区域，如果你要的是圆形区域，8 好意思，不行！）</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">The [InkWell] widget must have a [Material] widget as an ancestor. The</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[Material] widget is where the ink reactions are actually painted. This</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">matches the material design premise wherein the [Material] is what is</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">actually reacting to touches by spreading ink.<span class="code">```</span></span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>InkWell</code> 必须要有一个 <code>Material</code> 风格的部件作为锚点，巴拉巴拉巴拉….再次强调必须要在 <code>MD</code> 风格下使用。</p>
<p>接下来看下 <code>InkResponse</code> 吧</p>
<p>####InkResponse</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> InkResponse(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.child, <span class="comment">// 需要监听的子部件</span></span><br><span class="line">    <span class="comment">// 一个 `GestureTapCallback` 类型参数，看下 `GestureTapCallback` 的定义,</span></span><br><span class="line">    <span class="comment">// `typedef GestureTapCallback = void Function();` 就是简单的无参无返回类型参数</span></span><br><span class="line">    <span class="comment">// 监听手指点击事件</span></span><br><span class="line">    <span class="keyword">this</span>.onTap,</span><br><span class="line">    <span class="comment">// 一个 `GestureTapDownCallback` 类型参数，需要 `TapDownDetails` 类型参数，</span></span><br><span class="line">    <span class="comment">// `TapDownDetails` 里面有个 `Offset` 参数用于记录点击的位置，监听手指点击屏幕的事件</span></span><br><span class="line">    <span class="keyword">this</span>.onTapDown,</span><br><span class="line">    <span class="comment">// 同 `onTap` 表示点击事件取消监听</span></span><br><span class="line">    <span class="keyword">this</span>.onTapCancel,</span><br><span class="line">    <span class="comment">// 同 `onTap` 表示双击事件监听</span></span><br><span class="line">    <span class="keyword">this</span>.onDoubleTap,</span><br><span class="line">    <span class="comment">// 一个 `GestureLongPressCallback` 类型参数，也是无参无返回值，表示长按的监听</span></span><br><span class="line">    <span class="keyword">this</span>.onLongPress,</span><br><span class="line">    <span class="comment">// 监听高亮的变化，返回 `true` 表示往高亮变化，`false` 相反</span></span><br><span class="line">    <span class="keyword">this</span>.onHighlightChanged,</span><br><span class="line">    <span class="comment">// 是否需要裁剪区域，`InkWell` 该值为 `true`，会根据 `highlightShape` 裁剪</span></span><br><span class="line">    <span class="keyword">this</span>.containedInkWell = <span class="keyword">false</span>,</span><br><span class="line">    <span class="comment">// 高亮的外形，`InkWell` 该值设置成 `BoxShape.rectangle`，所以是个矩形区域</span></span><br><span class="line">    <span class="keyword">this</span>.highlightShape = BoxShape.circle,</span><br><span class="line">    <span class="keyword">this</span>.radius, <span class="comment">// 手指点下去的时候，出现水波纹的半径</span></span><br><span class="line">    <span class="keyword">this</span>.borderRadius, <span class="comment">// 点击时候外圈阴影的圆角半径</span></span><br><span class="line">    <span class="keyword">this</span>.customBorder,</span><br><span class="line">    <span class="keyword">this</span>.highlightColor, <span class="comment">// 高亮颜色</span></span><br><span class="line">    <span class="keyword">this</span>.splashColor, <span class="comment">// 手指点下生成的水波颜色</span></span><br><span class="line">    <span class="keyword">this</span>.splashFactory, <span class="comment">// 两个值 `InkRipple.splashFactory` 和 `InkSplash.splashFactory`</span></span><br><span class="line">    <span class="keyword">this</span>.enableFeedback = <span class="keyword">true</span>, <span class="comment">// 检测到手势是否有反馈</span></span><br><span class="line">    <span class="keyword">this</span>.excludeFromSemantics = <span class="keyword">false</span>,</span><br><span class="line">  &#125;) </span><br></pre></td></tr></table></figure>

<p>所以一些简单的触摸事件直接通过 <code>InkWell</code> 或者 <code>InkResponse</code> 就能够实现，但是面临一些比较复杂的手势，就有点不太够用了，我们需要通过 <code>GestureDector</code> 来进行处理</p>
<h4 id="GestureDector"><a href="#GestureDector" class="headerlink" title="GestureDector"></a>GestureDector</h4><p><code>GestureDetector</code> 也是一个部件，主要实现对各种手势动作的监听，其监听事件查看下面的表格</p>
<table>
<thead>
<tr>
<th align="left">回调方法</th>
<th>回调描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>onTapDown</code></td>
<td>点击屏幕的手势触碰到屏幕时候触发</td>
</tr>
<tr>
<td align="left"><code>onTapUp</code></td>
<td>点击屏幕抬手后触发，点击结束</td>
</tr>
<tr>
<td align="left"><code>onTap</code></td>
<td>点击事件已经完成的时候触发，和 <code>onTapUp</code> 几乎同时</td>
</tr>
<tr>
<td align="left"><code>onTapCancel</code></td>
<td>点击未完成，被其它手势取代的时候触发</td>
</tr>
<tr>
<td align="left"><code>onDoubleTap</code></td>
<td>双击屏幕的时候触发</td>
</tr>
<tr>
<td align="left"><code>onLongPress</code></td>
<td>长按屏幕的时候触发</td>
</tr>
<tr>
<td align="left"><code>onLongPressUp</code></td>
<td>长按屏幕后抬手触发</td>
</tr>
<tr>
<td align="left"><code>onVerticalDragDown</code></td>
<td>触碰到屏幕，可能发生垂直方向移动触发，<code>onVerticalDrag</code> 系列事件不会同 <code>onHorizontalDrag</code> 系列事件同时发生 ，如果发生了 <code>onVerticalDrag</code> 则接下来如何变化移动，都不会触发 <code>onHorizontalDrag</code> 事件，除非取消后重新触发。判断两者的关键是准备滑动的意图，先发生横向滑动则触发 <code>onHorizontalDrag</code> 事件，否则 <code>onVerticalDrag</code> 事件。</td>
</tr>
<tr>
<td align="left"><code>onVerticalDragStart</code></td>
<td>触碰到屏幕，并开始发生垂直方向的移动触发</td>
</tr>
<tr>
<td align="left"><code>onVerticalDragUpdate</code></td>
<td>垂直方向移动的距离变化触发</td>
</tr>
<tr>
<td align="left"><code>onVerticalDragEnd</code></td>
<td>抬手取消垂直方向移动的时候触发</td>
</tr>
<tr>
<td align="left"><code>onVerticalDragCancel</code></td>
<td>触发 <code>onVerticalDragDown</code> 但是没有完成整个 <code>onVerticalDrag</code> 事件触发</td>
</tr>
<tr>
<td align="left"></td>
<td><code>onHorizontalDrag</code> 系列介绍省略同上…</td>
</tr>
<tr>
<td align="left"><code>onPanDown</code></td>
<td>触碰到屏幕，准备滑动的时候触发，<code>onPan</code> 系列回调不可和 <code>onVerticalDrag</code> 或者 <code>onHorizontalDrag</code> 系列回调同时设置</td>
</tr>
<tr>
<td align="left"><code>onPanStart</code></td>
<td>触碰到屏幕，并开始滑动时候触发</td>
</tr>
<tr>
<td align="left"><code>onPanUpdate</code></td>
<td>滑动位置发生改变的时候触发</td>
</tr>
<tr>
<td align="left"><code>onPanEnd</code></td>
<td>滑动完成并抬手的时候触发</td>
</tr>
<tr>
<td align="left"><code>onPanCancel</code></td>
<td>触发 <code>onPanDown</code> 但是没有完成整个 <code>onPan</code> 事件触发</td>
</tr>
<tr>
<td align="left"><code>onScaleStart</code></td>
<td>两个手指之间建立联络点触发，初始缩放比例为 1.0</td>
</tr>
<tr>
<td align="left"><code>onScaleUpdate</code></td>
<td>手指距离发生变化，缩放比例也跟随变化触发</td>
</tr>
<tr>
<td align="left"><code>onScaleEnd</code></td>
<td>手指抬起，至间的联络断开时候触发</td>
</tr>
</tbody></table>
<p>还有 <code>onForcePress</code> 系列事件，这个是根据对屏幕的挤压力度进行触发，需要达到某些定值才能触发。<code>GestureDetector</code> 有个 <code>behavior</code> 属性用于设置手势监听过程中的表现形式</p>
<ol>
<li><code>deferToChild</code> 默认值，触摸到 <code>child</code> 的范围才会触发手势，空白处不会触发</li>
<li><code>opaque</code> 不透明模式，防止 <code>background widget</code> 接收到手势</li>
<li><code>translucent</code> 半透明模式，刚好同 <code>opaque</code> 相反，允许 <code>background widget</code> 接收到手势</li>
</ol>
<p>介绍完了手势，那就可以实际操练起来了，比如，实现一个跟随手指运动的小方块，先看下效果图</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-fad16bdf993f54d8.gif?imageMogr2/auto-orient/strip|imageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>简单的分析下，通过 <code>Positioned</code> 来设置小方块的位置，根据 <code>GestureDetector</code> 的 <code>onPanUpdate</code> 修改 <code>Positioned</code> 的 <code>left</code> 和 <code>top</code> 值，当 <code>onPanEnd</code> 或者 <code>onPanCancel</code> 的时候设置为原点，那么就可以有如图的效果了</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GestureDemoPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _GestureDemoPageState createState() =&gt; _GestureDemoPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_GestureDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">GestureDemoPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">double</span> left = <span class="number">0.0</span>;</span><br><span class="line">  <span class="built_in">double</span> top = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: Text(<span class="string">&#x27;Gesture Demo&#x27;</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: Stack(</span><br><span class="line">          alignment: Alignment.center,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Positioned(child: Container(width: <span class="number">50.0</span>, height: <span class="number">50.0</span>, color: Colors.red), left: left, top: top),</span><br><span class="line">            GestureDetector(</span><br><span class="line">              behavior: HitTestBehavior.translucent,</span><br><span class="line">              child: Container(</span><br><span class="line">                  color: Colors.transparent,</span><br><span class="line">                  width: MediaQuery.of(context).size.width - <span class="number">10</span>,</span><br><span class="line">                  height: MediaQuery.of(context).size.height),</span><br><span class="line">              onPanDown: (details) &#123;</span><br><span class="line">                setState(() &#123;</span><br><span class="line">                  left = details.globalPosition.dx;</span><br><span class="line">                  top = details.globalPosition.dy;</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">              onPanUpdate: (details) &#123;</span><br><span class="line">                setState(() &#123;</span><br><span class="line">                  left = details.globalPosition.dx;</span><br><span class="line">                  top = details.globalPosition.dy;</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">              onPanCancel: () &#123;</span><br><span class="line">                setState(() &#123;</span><br><span class="line">                  left = <span class="number">0.0</span>;</span><br><span class="line">                  top = <span class="number">0.0</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">              onPanEnd: (details) &#123;</span><br><span class="line">                setState(() &#123;</span><br><span class="line">                  left = <span class="number">0.0</span>;</span><br><span class="line">                  top = <span class="number">0.0</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果说要实现一个放大缩小的方块，就可以通过 <code>onScaleUpdate</code> 中获取到的 <code>details.scale</code> 来设置方块的宽高即可。这个比较简单就留给小伙伴们自己实现效果了。</p>
<p><em>该部分代码查看 <code>gesture_main.dart</code> 文件</em></p>
<h4 id="Animation-动画"><a href="#Animation-动画" class="headerlink" title="Animation 动画"></a>Animation 动画</h4><p><code>Flutter</code> 的 <code>Animation</code> 是个抽象类，具体的实现需要看其子类 <code>AnimationController</code>，在这之前，先了解下 <code>Animation</code> 的一些方法和介绍。</p>
<ol>
<li><p><code>addListener</code> &#x2F; <code>removeListener</code> 添加的监听用于监听值的变化，<code>remove</code> 用于停止监听</p>
</li>
<li><p><code>addStatusListener</code> &#x2F; <code>removeStatusListener</code> 添加动画状态变化的监听，<code>remove</code> 停止监听，<code>Animation</code> 的状态有 4 种：<code>dismissed</code> 动画初始状态，反向运动结束状态，<code>forward</code> 动画正向运动状态，<code>reverse</code> 动画反向运动状态，<code>completed</code> 动画正向运动结束状态。</p>
</li>
<li><p><code>drive</code> 方法用于连接动画，例如官方举的例子，因为 <code>AnimationController</code> 是其子类，所以也拥有该方法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Animation&lt;Alignment&gt; _alignment1 = _controller.drive(</span><br><span class="line">     AlignmentTween(</span><br><span class="line">       begin: Alignment.topLeft,</span><br><span class="line">       end: Alignment.topRight,</span><br><span class="line">     ),</span><br><span class="line">   );</span><br></pre></td></tr></table></figure>

<p>上面的例子将 <code>AnimationController</code> 和 <code>AlignmentTween</code> 结合成一个 <code>Animation&lt;Alignment&gt;</code> 动画，当然 <code>drive</code> 可以结合多个动画，例如</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Animation&lt;Alignment&gt; _alignment3 = _controller</span><br><span class="line">       .drive(CurveTween(curve: Curves.easeIn))</span><br><span class="line">       .drive(AlignmentTween(</span><br><span class="line">         begin: Alignment.topLeft,</span><br><span class="line">         end: Alignment.topRight,</span><br><span class="line">       ));</span><br></pre></td></tr></table></figure></li>
</ol>
<p>因为 <code>Animation</code> 是抽象类，所以具体的还是需要通过 <code>AnimationController</code> 来实现。</p>
<h4 id="AnimationController"><a href="#AnimationController" class="headerlink" title="AnimationController"></a>AnimationController</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AnimationController(&#123;</span><br><span class="line">    <span class="built_in">double</span> value, <span class="comment">// 设置初始的值</span></span><br><span class="line">    <span class="keyword">this</span>.duration, <span class="comment">// 动画的时长</span></span><br><span class="line">    <span class="keyword">this</span>.debugLabel, <span class="comment">// 主要是用于 `toString` 方法中输出信息</span></span><br><span class="line">    <span class="keyword">this</span>.lowerBound = <span class="number">0.0</span>, <span class="comment">// 最小范围</span></span><br><span class="line">    <span class="keyword">this</span>.upperBound = <span class="number">1.0</span>, <span class="comment">// 最大范围</span></span><br><span class="line">    <span class="comment">// AnimationController 结束时候的行为，有 `normal` 和 `preserve` 两个值可选</span></span><br><span class="line">    <span class="keyword">this</span>.animationBehavior = AnimationBehavior.normal, </span><br><span class="line">    <span class="comment">// 这个属性可以通过 with `SingleTickerProviderStateMixin` </span></span><br><span class="line">    <span class="comment">// 或者 `TickerProviderStateMixin` 引入到 `State`，通过 `this` 指定</span></span><br><span class="line">    <span class="meta">@required</span> TickerProvider vsync,</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p><code>AnimationController</code> 控制动画的方法有这么几个</p>
<ol>
<li><code>forward</code> 启动动画，和上面提到的 <code>forward</code> 状态不一样</li>
<li><code>reverse</code> 方向启动动画</li>
<li><code>repeat</code> 重复使动画运行</li>
<li><code>stop</code> 停止动画</li>
<li><code>reset</code> 重置动画</li>
</ol>
<p>大概了解了 <code>AnimationController</code> ，接下来通过一个实际的小例子来加深下印象，例如实现如下效果，点击开始动画，结束后再点击反向动画</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-0f55a9d8215eb84c.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AnimationDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">AnimationDemoPage</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController _animationController;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _animationController = AnimationController(</span><br><span class="line">        vsync: <span class="keyword">this</span>, duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>), lowerBound: <span class="number">28.0</span>, upperBound: <span class="number">50.0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当动画值发生变化的时候，重绘下 icon</span></span><br><span class="line">    _animationController.addListener(() &#123;</span><br><span class="line">      setState(() &#123;&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// 一定要释放资源</span></span><br><span class="line">    _animationController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Animation Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: IconButton(</span><br><span class="line">            icon: Icon(Icons.android, color: Colors.green[<span class="number">500</span>], size: _animationController.value),</span><br><span class="line">            onPressed: () &#123;</span><br><span class="line">              <span class="comment">// 根据状态执行不同动画运动方式</span></span><br><span class="line">              <span class="keyword">if</span> (_animationController.status == AnimationStatus.completed)</span><br><span class="line">                _animationController.reverse();</span><br><span class="line">              <span class="keyword">else</span> <span class="keyword">if</span> (_animationController.status == AnimationStatus.dismissed)</span><br><span class="line">                _animationController.forward();</span><br><span class="line">            &#125;),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么如果要实现无限动画呢，那就可以通过 <code>addStatusListener</code> 监听动画的状态来执行，修改代码，在 <code>initState</code> 增加如下代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">_animationController.addStatusListener((status) &#123;</span><br><span class="line">      <span class="keyword">if</span> (_animationController.status == AnimationStatus.completed)</span><br><span class="line">        _animationController.reverse();  <span class="comment">// 正向结束后开始反向</span></span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (_animationController.status == AnimationStatus.dismissed) </span><br><span class="line">        _animationController.forward(); <span class="comment">// 反向结束后开始正向</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    _animationController.forward(); <span class="comment">// 启动动画</span></span><br></pre></td></tr></table></figure>

<p>把 <code>Center</code> 的 <code>child</code> 替换成一个 <code>Icon</code>，因为上面已经启动了动画，所以不需要再用点击去启动了，运行后就会无限放大缩小循环跑了。</p>
<p>在这个例子中，通过设置 <code>AnimationController</code> 的 <code>lowerBound</code> 和 <code>upperBound</code> 实现了动画的变化范围，接下来，将通过 <code>Tween</code> 来实现动画的变化范围。先看下 <code>Tween</code> 的一些介绍。</p>
<h4 id="Tween"><a href="#Tween" class="headerlink" title="Tween"></a>Tween</h4><blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">A linear interpolation between a beginning and ending value.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[Tween] is useful if you want to interpolate across a range.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">To use a [Tween] object with an animation, call the [Tween] object&#x27;s</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[animate] method and pass it the [Animation] object that you want to</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">modify.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">You can chain [Tween] objects together using the [chain] method, so that a</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">single [Animation] object is configured by multiple [Tween] objects called</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">in succession. This is different than calling the [animate] method twice,</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">which results in two separate [Animation] objects, each configured with a</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">single [Tween].</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>Tween</code> 是一个线性插值(如果要修改运动的插值，可以通过 <code>CurveTween</code> 来修改)，所以在线性变化的时候很有用</p>
<p>通过调用 <code>Tween</code> 的 <code>animate</code> 方法生成一个 <code>Animation</code>(<code>animate</code> 一般传入 <code>AnimationController</code>)</p>
<p>还可以通过 <code>chain</code> 方法将多个 <code>Tween</code> 结合到一起，这样就不需要多次去调用 <code>Tween</code> 的 <code>animate</code> 方法来生成动画了，多次调用 <code>animate</code> 相当于使用了两个分开的动画来完成效果，但是 <code>chain</code> 结合到一起就是一个动画过程</p>
<p>那么对前面的动画进行一些修改，通过 <code>Tween</code> 来控制值的变化</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AnimationDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">AnimationDemoPage</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController _animationController;</span><br><span class="line">  Animation _scaleAnimation; <span class="comment">// 动画实例，用于修改值的大小</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _animationController = AnimationController(vsync: <span class="keyword">this</span>, duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>)); <span class="comment">// 不通过 `lowerBound` 和 `upperBound` 设置范围，改用 `Tween`</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当动画值发生变化的时候，重绘下 icon</span></span><br><span class="line">    _animationController.addListener(() &#123;</span><br><span class="line">      setState(() &#123;&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    _animationController.addStatusListener((status) &#123;</span><br><span class="line">      <span class="keyword">if</span> (_animationController.status == AnimationStatus.completed)</span><br><span class="line">        _animationController.reverse();</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (_animationController.status == AnimationStatus.dismissed)</span><br><span class="line">        _animationController.forward();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过 `Tween` 的 `animate` 生成一个 Animation</span></span><br><span class="line">    <span class="comment">// 再通过  Animation.value 进行值的修改</span></span><br><span class="line">    _scaleAnimation = Tween(begin: <span class="number">28.0</span>, end: <span class="number">50.0</span>).animate(_animationController);</span><br><span class="line">    _animationController.forward();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// 一定要释放资源</span></span><br><span class="line">    _animationController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Animation Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        <span class="comment">// 通过动画返回的值，修改图标的大小</span></span><br><span class="line">        child: Icon(Icons.favorite, color: Colors.red, size: _scaleAnimation.value),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再次运行，还是能过达到之前的效果，那么很多小伙伴肯定会问了，「**，加了那么多代码，效果还是和以前的一样，还不如不加…」好吧，我无法反驳，但是如果要实现多个动画呢，那么使用 <code>Tween</code> 就有优势了，比如我们让图标大小变化的同时，颜色和位置也发生变化，只通过 <code>AnimationController</code> 要怎么实现? 又比如说，运动的方式要先加速后减速，那只通过 <code>AnimationController</code> 要如何实现？这些问题通过 <code>Tween</code> 就会非常方便解决，直接上代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AnimationDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">AnimationDemoPage</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController _animationController;</span><br><span class="line">  Animation _scaleAnimation; <span class="comment">// 用于控制图标大小</span></span><br><span class="line">  Animation&lt;Color&gt; _colorAnimation; <span class="comment">// 控制图标颜色</span></span><br><span class="line">  Animation&lt;Offset&gt; _positionAnimation; <span class="comment">// 控制图标位置</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _animationController = AnimationController(vsync: <span class="keyword">this</span>, duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">2000</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当动画值发生变化的时候，重绘下 icon</span></span><br><span class="line">    _animationController.addListener(() &#123;</span><br><span class="line">      setState(() &#123;&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    _animationController.addStatusListener((status) &#123;</span><br><span class="line">      <span class="keyword">if</span> (_animationController.status == AnimationStatus.completed)</span><br><span class="line">        _animationController.reverse();</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (_animationController.status == AnimationStatus.dismissed) _animationController.forward();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 通过 `chain` 结合 `CurveTween` 修改动画的运动方式，曲线类型可自行替换</span></span><br><span class="line">    _scaleAnimation =</span><br><span class="line">        Tween(begin: <span class="number">28.0</span>, end: <span class="number">50.0</span>).chain(CurveTween(curve: Curves.decelerate)).animate(_animationController);</span><br><span class="line"></span><br><span class="line">    _colorAnimation = ColorTween(begin: Colors.red[<span class="number">200</span>], end: Colors.red[<span class="number">900</span>])</span><br><span class="line">        .chain(CurveTween(curve: Curves.easeIn))</span><br><span class="line">        .animate(_animationController);</span><br><span class="line"></span><br><span class="line">    _positionAnimation = Tween(begin: Offset(<span class="number">100</span>, <span class="number">100</span>), end: Offset(<span class="number">300</span>, <span class="number">300</span>))</span><br><span class="line">        .chain(CurveTween(curve: Curves.bounceInOut))</span><br><span class="line">        .animate(_animationController);</span><br><span class="line"></span><br><span class="line">    _animationController.forward(); <span class="comment">// 启动动画</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _animationController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Animation Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Stack(</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          Positioned(</span><br><span class="line">            child: Icon(Icons.favorite, color: _colorAnimation.value, size: _scaleAnimation.value),</span><br><span class="line">            left: _positionAnimation.value.dx,</span><br><span class="line">            top: _positionAnimation.value.dy,</span><br><span class="line">          )</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么最后的效果图</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-977e7de1b224aa58.gif?imageMogr2/auto-orient/strip|imageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>当然，<code>Flutter</code> 中已经实现的 <code>Tween</code> 还有很多，包括 <code>BorderTween</code>、<code>TextStyleTween</code>、<code>ThemeDataTween</code> ..等等，实现的方式都是类似的，小伙伴们可以自己慢慢看。</p>
<h4 id="AnimationWidget"><a href="#AnimationWidget" class="headerlink" title="AnimationWidget"></a>AnimationWidget</h4><p>在上面的例子中，都是通过 <code>addListener</code> 监听动画值变化，然后通过 <code>setState</code> 方法来实现刷新效果。那么 <code>Flutter</code> 也提供了一个部件 <code>AnimationWidget</code> 来实现动画部件，就不需要一直监听了，还是实现上面的例子</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RunningHeart</span> <span class="keyword">extends</span> <span class="title">AnimatedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Animation&gt; animations; <span class="comment">// 传入动画列表</span></span><br><span class="line">  <span class="keyword">final</span> AnimationController animationController; <span class="comment">// 控制动画</span></span><br><span class="line"></span><br><span class="line">  RunningHeart(&#123;<span class="keyword">this</span>.animations, <span class="keyword">this</span>.animationController&#125;)</span><br><span class="line">      <span class="comment">// 对传入的参数进行限制(当然你也可以不做限制)</span></span><br><span class="line">      : <span class="keyword">assert</span>(animations.length == <span class="number">3</span>),</span><br><span class="line">        <span class="keyword">assert</span>(animations[<span class="number">0</span>] <span class="keyword">is</span> Animation&lt;Color&gt;),</span><br><span class="line">        <span class="keyword">assert</span>(animations[<span class="number">1</span>] <span class="keyword">is</span> Animation&lt;<span class="built_in">double</span>&gt;),</span><br><span class="line">        <span class="keyword">assert</span>(animations[<span class="number">2</span>] <span class="keyword">is</span> Animation&lt;Offset&gt;),</span><br><span class="line">        <span class="keyword">super</span>(listenable: animationController);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Stack(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Positioned(</span><br><span class="line">          <span class="comment">// 之前的 animation 都通过 animations 参数传入到 `AnimationWidget`</span></span><br><span class="line">          child: Icon(Icons.favorite, color: animations[<span class="number">0</span>].value, size: animations[<span class="number">1</span>].value),</span><br><span class="line">          left: animations[<span class="number">2</span>].value.dx,</span><br><span class="line">          top: animations[<span class="number">2</span>].value.dy,</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实内部返回的部件和前面的是一样的</p>
<p>接着对 <code>_AnimationDemoPageState</code> 类进行修改，注释 <code>initState</code> 中的 <code>_animationController.addListener</code> 所有内容，然后将 <code>body</code> 属性替换成新建的 <code>RunningHeart</code> 部件，记得传入的动画列表的顺序</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body: RunningHeart(</span><br><span class="line">        animations: [_colorAnimation, _scaleAnimation, _positionAnimation],</span><br><span class="line">        animationController: _animationController,</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>

<p>这样就实现了刚才一样的效果，并且没有一直调用 <code>setState</code> 来刷新。</p>
<p><em>该部分代码查看 <code>animation_main.dart</code> 文件</em></p>
<h4 id="StaggeredAnimations"><a href="#StaggeredAnimations" class="headerlink" title="StaggeredAnimations"></a>StaggeredAnimations</h4><p><code>Flutter</code> 还提供了交错动画，听名字就可以知道，是按照时间轴，进行不同的动画，并且由同个<code>AnimationController</code> 进行控制。因为没有找到好的例子，原谅我直接搬官方的例子来讲，<a target="_blank" rel="noopener" href="https://flutterchina.club/animations/staggered-animations/#complete-staggered-animation">官方交错动画 demo</a></p>
<p>在继续看之前，先了解下 <code>Interval</code></p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">An [Interval] can be used to delay an animation. For example, a six second</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">animation that uses an [Interval] with its [begin] set to 0.5 and its [end]</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">set to 1.0 will essentially become a three-second animation that starts</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">three seconds later.</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>Interval</code> 用来延迟动画，例如一个时长 6s 的动画，通过 <code>Interval</code> 设置其 <code>begin</code> 参数为 0.5，<code>end</code> 参数设置为 1.0，那么这个动画就会变成 3s 的动画，并且开始的时间延迟了 3s。</p>
<p>了解 <code>Interval</code> 功能后，就可以看下实例了，当然我们不和官方的 demo 一样，中间加个旋转动画</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StaggeredAnim</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> AnimationController controller;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;<span class="built_in">double</span>&gt; opacity;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;<span class="built_in">double</span>&gt; width;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;<span class="built_in">double</span>&gt; height;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;EdgeInsets&gt; padding;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;BorderRadius&gt; border;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;Color&gt; color;</span><br><span class="line">  <span class="keyword">final</span> Animation&lt;<span class="built_in">double</span>&gt; rotate;</span><br><span class="line"></span><br><span class="line">  StaggeredAnim(&#123;Key key, <span class="keyword">this</span>.controller&#125;):</span><br><span class="line">        <span class="comment">// widget 透明度</span></span><br><span class="line">        opacity = Tween(begin: <span class="number">0.0</span>, end: <span class="number">1.0</span>)</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.0</span>, <span class="number">0.1</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="comment">// widget 宽</span></span><br><span class="line">        width = Tween(begin: <span class="number">50.0</span>, end: <span class="number">150.0</span>)</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.1</span>, <span class="number">0.250</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="comment">// widget 高</span></span><br><span class="line">        height = Tween(begin: <span class="number">50.0</span>, end: <span class="number">150.0</span>)</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.25</span>, <span class="number">0.375</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="comment">// widget 底部距离</span></span><br><span class="line">        padding = EdgeInsetsTween(begin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">150.0</span>), end: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">.0</span>))</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.25</span>, <span class="number">0.375</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="comment">// widget 旋转</span></span><br><span class="line">        rotate = Tween(begin: <span class="number">0.0</span>, end: <span class="number">0.25</span>)</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.375</span>, <span class="number">0.5</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="comment">// widget 外形</span></span><br><span class="line">        border = BorderRadiusTween(begin: BorderRadius.circular(<span class="number">5.0</span>), end: BorderRadius.circular(<span class="number">75.0</span>))</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.5</span>, <span class="number">0.75</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="comment">// widget 颜色</span></span><br><span class="line">        color = ColorTween(begin: Colors.blue, end: Colors.orange)</span><br><span class="line">            .animate(CurvedAnimation(parent: controller, curve: Interval(<span class="number">0.75</span>, <span class="number">1.0</span>, curve: Curves.ease))),</span><br><span class="line">        <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  Widget _buildAnimWidget(BuildContext context, Widget child) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      padding: padding.value,</span><br><span class="line">      alignment: Alignment.center,</span><br><span class="line">      <span class="comment">// 旋转变化</span></span><br><span class="line">      child: RotationTransition(</span><br><span class="line">        turns: rotate, <span class="comment">// turns 表示当前动画的值 * 360° 角度</span></span><br><span class="line">        child: Opacity(</span><br><span class="line">          opacity: opacity.value, <span class="comment">// 透明度变化</span></span><br><span class="line">          child: Container(</span><br><span class="line">            width: width.value, <span class="comment">// 宽度变化</span></span><br><span class="line">            height: height.value, <span class="comment">// 高度变化</span></span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">                color: color.value, <span class="comment">// 颜色变化</span></span><br><span class="line">                border: Border.all(color: Colors.indigo[<span class="number">300</span>], width: <span class="number">3.0</span>),</span><br><span class="line">                borderRadius: border.value), <span class="comment">// 外形变化</span></span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// AnimatedBuilder 继承 AnimationWidget，用来快速构建动画部件</span></span><br><span class="line">    <span class="keyword">return</span> AnimatedBuilder(animation: controller, builder: _buildAnimWidget);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后修改 <code>body</code> 的参数，设置成我们的动画，当点击的时候就会启动动画</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GestureDetector(</span><br><span class="line">       behavior: HitTestBehavior.opaque,</span><br><span class="line">       onTap: _playAnim,</span><br><span class="line">       child: Center(</span><br><span class="line">         <span class="comment">// 定义一个外层圈，能够使动画显眼点</span></span><br><span class="line">         child: Container(</span><br><span class="line">           width: <span class="number">300</span>,</span><br><span class="line">           height: <span class="number">300</span>,</span><br><span class="line">           decoration: BoxDecoration(</span><br><span class="line">               color: Colors.black.withOpacity(<span class="number">0.1</span>), border: Border.all(color: Colors.black.withOpacity(<span class="number">0.5</span>))),</span><br><span class="line">           child: StaggeredAnim(controller: _controller),</span><br><span class="line">         ),</span><br><span class="line">       ),</span><br><span class="line">     )</span><br></pre></td></tr></table></figure>

<p>看下最后的效果吧</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-329d48585eee04b4.gif?imageMogr2/auto-orient/strip|imageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p><em>该部分代码查看 <code>staggered_animation_main.dart</code> 文件</em></p>
<p>结束前，我们再讲一种比较简单的 <code>Hreo</code> 动画，用来过渡用。</p>
<h4 id="Hero"><a href="#Hero" class="headerlink" title="Hero"></a>Hero</h4><p>通过指定 <code>Hero</code> 中的 <code>tag</code>，在切换的时候 <code>Hero</code> 会寻找相同的 <code>tag</code>，并实现动画，具体的实现逻辑，这里可以推荐一篇文章 <a target="_blank" rel="noopener" href="https://blog.csdn.net/yumi0629/article/details/83176911">谈一谈Flutter中的共享元素动画Hero</a>，里面写的很详细，就不造车轮了。当然这边还是得提供个简单的 demo 的，替换前面的 <code>body</code> 参数</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">body: Container(</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        child: InkWell(</span><br><span class="line">          child: Hero(</span><br><span class="line">            tag: <span class="string">&#x27;hero_tag&#x27;</span>, <span class="comment">// 这里指定 tag</span></span><br><span class="line">            child: Image.asset(<span class="string">&#x27;images/ali.jpg&#x27;</span>, width: <span class="number">100.0</span>, height: <span class="number">100.0</span>),</span><br><span class="line">          ),</span><br><span class="line">          onTap: () =&gt; Navigator.push(context, MaterialPageRoute(builder: (_) =&gt; HeroPage())),</span><br><span class="line">        ),</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>

<p>然后创建 <code>HeroPage</code> 界面，当然也可以是个 <code>Dialog</code>，只要通过路由实现即可</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeroPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: Container(</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        child: InkWell(</span><br><span class="line">          child: Hero(tag: <span class="string">&#x27;hero_tag&#x27;</span>, child: Image.asset(<span class="string">&#x27;images/ali.jpg&#x27;</span>, width: <span class="number">200.0</span>, height: <span class="number">200.0</span>)),</span><br><span class="line">          onTap: () =&gt; Navigator.pop(context),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看下最后的效果图：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-b20a401615f8acde.gif?imageMogr2/auto-orient/strip|imageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p><em>该部分代码查看 <code>animation_main.dart</code> 文件</em></p>
<p>这一部分讲的比较多，小伙伴可以慢慢消化，下节我会尽量填下之前留下的状态管理的坑。</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/28/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-10/" data-id="cl0ukmc2p000xpn1g51x8g14x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-09" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/24/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-09/" class="article-date">
  <time datetime="2019-03-24T13:03:33.000Z" itemprop="datePublished">2019-03-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/24/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-09/">Flutter Guide(09) -- 了解 Flutter 的友好提示</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前面的小节把常用的一些部件都介绍了，这节介绍下 <code>Flutter</code> 中的一些操作提示。<code>Flutter</code> 中的操作提示主要有这么几种 <code>SnackBar</code>、<code>BottomSheet</code>、<code>Dialog</code>，因为 <code>Dialog</code> 样式比较多，放最后讲好了</p>
<h4 id="SnackBar"><a href="#SnackBar" class="headerlink" title="SnackBar"></a>SnackBar</h4><p><code>SnackBar</code> 的源码相对简单</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SnackBar(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.content, <span class="comment">// 提示信息</span></span><br><span class="line">    <span class="keyword">this</span>.backgroundColor, <span class="comment">// 背景色</span></span><br><span class="line">    <span class="keyword">this</span>.action, <span class="comment">// SnackBar 尾部的按钮，用于一些回退操作等</span></span><br><span class="line">    <span class="keyword">this</span>.duration = _kSnackBarDisplayDuration, <span class="comment">// 停留的时长，默认 4000ms</span></span><br><span class="line">    <span class="keyword">this</span>.animation, <span class="comment">// 进出动画</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>例如我们需要实现一个功能，修改某个值，修改后给用户一个提示，同时给用户一个撤销该操作的按钮，那么就可以通过 <code>SnackBar</code> 来简单实现。还有就是 <code>SnackBar</code> 可以和 <code>floatingActionButton</code> 完美的配合，弹出的时候不会遮挡住 <code>fab</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_PromptDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">PromptDemoPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自增操作</span></span><br><span class="line">  increase() &#123;</span><br><span class="line">    setState(() =&gt; count++);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自减操作</span></span><br><span class="line">  decrease() &#123;</span><br><span class="line">    setState(() =&gt; count--);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _changeValue(BuildContext context) &#123;</span><br><span class="line">    increase();</span><br><span class="line">    Scaffold.of(context).showSnackBar(SnackBar(</span><br><span class="line">        content: Text(<span class="string">&#x27;当前值已修改&#x27;</span>),</span><br><span class="line">        action: SnackBarAction(label: <span class="string">&#x27;撤销&#x27;</span>, onPressed: decrease),</span><br><span class="line">        duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">2000</span>)));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Prompt Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Column(children: &lt;Widget&gt;[</span><br><span class="line">        Text(<span class="string">&#x27;当前值：<span class="subst">$count</span>&#x27;</span>, style: TextStyle(fontSize: <span class="number">20.0</span>)),</span><br><span class="line">        Expanded(</span><br><span class="line">            <span class="comment">// 为了方便拓展，我这边提取了 `snackBar` 的方法，并把按钮放在列表</span></span><br><span class="line">            child: ListView(padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">12.0</span>, vertical: <span class="number">8.0</span>), children: &lt;Widget&gt;[</span><br><span class="line">          <span class="comment">// SnackBar 需要提供一个包含 context，但是 context 不能是 Scaffold 节点下的 context，所以需要通过 Builder 包裹一层</span></span><br><span class="line">          Builder(builder: (context) =&gt; RaisedButton(onPressed: () =&gt; _changeValue(context), child: Text(<span class="string">&#x27;修改当前值&#x27;</span>))),</span><br><span class="line">        ]))</span><br><span class="line">      ]),</span><br><span class="line">      <span class="comment">// 当 SnackBar 弹出时，fab 会上移一段距离</span></span><br><span class="line">      floatingActionButton: Builder(</span><br><span class="line">          builder: (context) =&gt; FloatingActionButton(onPressed: () =&gt; _changeValue(context), child: Icon(Icons.send))),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看下最后的效果图，请注意看 <code>fab</code> 和值的变化：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-da29f7ede96f2215.gif?imageMogr2/auto-orient/strip|imageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<h4 id="BottomSheet"><a href="#BottomSheet" class="headerlink" title="BottomSheet"></a>BottomSheet</h4><p><code>BottomSheet</code> 看命名就知道是从底部弹出的菜单，展示 <code>BottomSheet</code> 有两种方式，分别是 <code>showBottomSheet</code> 和 <code>showModalBottomSheet</code>，两种方式只有在展示类型上的差别，方法调用无差，而且 <code>showBottomSheet</code> 和 <code>fab</code> 有组合动画，<code>showModalBottomSheet</code> 则没有，看下实际的例子吧。在 <code>ListView</code> 中增加一个 <code>BottomSheet</code> 的按钮，因为 <code>BottomSheet</code> 需要的 <code>context</code> 也不能是 <code>Scaffold</code> 下的 <code>context</code>，所以需要通过 <code>Builder</code> 进行包裹一层，然后增加 <code>_showBottomSheet</code> 的方法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">_showBottomSheet(BuildContext context) &#123;</span><br><span class="line">   showBottomSheet(</span><br><span class="line">     context: context,</span><br><span class="line">     builder: (context) =&gt; ListView(</span><br><span class="line">             <span class="comment">// 生成一个列表选择器</span></span><br><span class="line">             children: <span class="built_in">List</span>.generate(</span><br><span class="line">           <span class="number">20</span>,</span><br><span class="line">           (index) =&gt; InkWell(</span><br><span class="line">               child: Container(alignment: Alignment.center, height: <span class="number">60.0</span>, child: Text(<span class="string">&#x27;Item <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>&#x27;</span>)),</span><br><span class="line">               onTap: () &#123;</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">&#x27;tapped item <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>&#x27;</span>);</span><br><span class="line">                 Navigator.pop(context);</span><br><span class="line">               &#125;),</span><br><span class="line">         )),</span><br><span class="line">   );</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>把 <code>showBottomSheet</code> 替换成 <code>showModalBottomSheet</code> 就是另外一种展示方式了，内部不需要做任何改变，我们看下两种的运行效果：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-70e344e56f98f683.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>可以看到 <code>showBottomSheet</code> 会充满整个屏幕，然后 <code>fab</code> 会跟随一起到 <code>AppBar</code> 的底部位置，而 <code>showModalBottomSheet</code> 展示的高度不会超过半个屏幕的高度，但是 <code>fab</code> 被其遮挡了。假如我们只需要展示 2-3 个 <code>item</code>，但是按照刚才的方式 <code>showModalBottomSheet</code> 的高度太高了，那我们可以在 <code>ListView</code> 外层包裹一层 <code>Container</code>，然后指定 <code>height</code> 即可</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_showModalBottomSheet(BuildContext context) &#123;</span><br><span class="line">    showModalBottomSheet(</span><br><span class="line">      context: context,</span><br><span class="line">      builder: (context) =&gt; Container(</span><br><span class="line">            child: ListView(</span><br><span class="line">                children: <span class="built_in">List</span>.generate(</span><br><span class="line">              <span class="number">2</span>,</span><br><span class="line">              (index) =&gt; InkWell(</span><br><span class="line">                  child: Container(alignment: Alignment.center, height: <span class="number">60.0</span>, child: Text(<span class="string">&#x27;Item <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>&#x27;</span>)),</span><br><span class="line">                  onTap: () &#123;</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;tapped item <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>&#x27;</span>);</span><br><span class="line">                    Navigator.pop(context);</span><br><span class="line">                  &#125;),</span><br><span class="line">            )),</span><br><span class="line">            height: <span class="number">120</span>,</span><br><span class="line">          ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>修改高度后的效果：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-51e8092d6a0e879b.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<h4 id="Dialog"><a href="#Dialog" class="headerlink" title="Dialog"></a>Dialog</h4><p>相对于 <code>SnackBar</code> 和 <code>BottomSheet</code>，<code>Dialog</code> 的使用场景相对会更多，在 <code>MaterialDesign</code> 下，<code>Dialog</code> 主要有 3 种：<code>AlertDialog</code>，<code>SimpleDialog</code> 和 <code>AboutDialog</code>，当然在 <code>Cupertino</code> 风格下也有相应的 <code>Dialog</code>，因为这个系列以 <code>MaterialDesign</code> 风格为主，所以 <code>Cupertiono</code> 等下次有时间再写吧。</p>
<h5 id="AlertDialog"><a href="#AlertDialog" class="headerlink" title="AlertDialog"></a>AlertDialog</h5><p>在 <code>ListView</code> 中增加一个 <code>AlertDialog</code> 的按钮，用于点击显示 <code>AlertDialog</code> 用，然后加入显示 <code>AlertDilaog</code> 的方法，并将按钮的 <code>onPressed</code> 指向该方法，<code>Dialog</code> 的 <code>context</code> 可以是 <code>Scaffold</code> 下的 <code>context</code>，所以不需要用 <code>Builder</code> 来包裹一层。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">_showAlertDialog() &#123;</span><br><span class="line">    showDialog(</span><br><span class="line">        <span class="comment">// 设置点击 dialog 外部不取消 dialog，默认能够取消</span></span><br><span class="line">        barrierDismissible: <span class="keyword">false</span>,</span><br><span class="line">        context: context,</span><br><span class="line">        builder: (context) =&gt; AlertDialog(</span><br><span class="line">              title: Text(<span class="string">&#x27;我是个标题...嗯，标题..&#x27;</span>),</span><br><span class="line">              titleTextStyle: TextStyle(color: Colors.purple), <span class="comment">// 标题文字样式</span></span><br><span class="line">              content: Text(<span class="string">r&#x27;我是内容\(^o^)/~, 我是内容\(^o^)/~, 我是内容\(^o^)/~&#x27;</span>),</span><br><span class="line">              contentTextStyle: TextStyle(color: Colors.green), <span class="comment">// 内容文字样式</span></span><br><span class="line">              backgroundColor: CupertinoColors.white,</span><br><span class="line">              elevation: <span class="number">8.0</span>, <span class="comment">// 投影的阴影高度</span></span><br><span class="line">              semanticLabel: <span class="string">&#x27;Label&#x27;</span>, <span class="comment">// 这个用于无障碍下弹出 dialog 的提示</span></span><br><span class="line">              shape: Border.all(),</span><br><span class="line">              <span class="comment">// dialog 的操作按钮，actions 的个数尽量控制不要过多，否则会溢出 `Overflow`</span></span><br><span class="line">              actions: &lt;Widget&gt;[</span><br><span class="line">                <span class="comment">// 点击增加显示的值</span></span><br><span class="line">                FlatButton(onPressed: increase, child: Text(<span class="string">&#x27;点我增加&#x27;</span>)),</span><br><span class="line">                <span class="comment">// 点击减少显示的值</span></span><br><span class="line">                FlatButton(onPressed: decrease, child: Text(<span class="string">&#x27;点我减少&#x27;</span>)),</span><br><span class="line">                <span class="comment">// 点击关闭 dialog，需要通过 Navigator 进行操作</span></span><br><span class="line">                FlatButton(onPressed: () =&gt; Navigator.pop(context), </span><br><span class="line">                           child: Text(<span class="string">&#x27;你点我试试.&#x27;</span>)),</span><br><span class="line">              ],</span><br><span class="line">            ));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>最后看下效果：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-dd8dc81b43e02e44.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<h5 id="SimpleDialog"><a href="#SimpleDialog" class="headerlink" title="SimpleDialog"></a>SimpleDialog</h5><p><code>SimpleDialog</code> 相比于 <code>AlertDialog</code> 少了 <code>content</code> 和 <code>action</code> 参数，多了 <code>children</code> 属性，需要传入 <code>Widget</code> 列表，那就可以自定义全部内容了。那我们这里就实现一个性别选择的 <code>Dialog</code>，选择后通过 <code>Taost</code> 提示选择的内容，<code>Taost</code> 就是之前导入的第三方插件，先看下效果图吧</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-a9dd6de23478249e.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>只要实现 <code>children</code> 是个列表选择器就可以了，比较简单，直接上代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_showSimpleDialog() &#123;</span><br><span class="line">    showDialog(</span><br><span class="line">        barrierDismissible: <span class="keyword">false</span>,</span><br><span class="line">        context: context,</span><br><span class="line">        builder: (context) =&gt; SimpleDialog(</span><br><span class="line">              title: Text(<span class="string">&#x27;我是个比较正经的标题...\n选择你的性别&#x27;</span>),</span><br><span class="line">              <span class="comment">// 这里传入一个选择器列表即可</span></span><br><span class="line">              children: _genders</span><br><span class="line">                  .map((gender) =&gt; InkWell(</span><br><span class="line">                        child: Container(height: <span class="number">40.0</span>, child: Text(gender), alignment: Alignment.center),</span><br><span class="line">                        onTap: () &#123;</span><br><span class="line">                          Navigator.pop(context);</span><br><span class="line">                          Fluttertoast.showToast(msg: <span class="string">&#x27;你选择的性别是 <span class="subst">$gender</span>&#x27;</span>);</span><br><span class="line">                        &#125;,</span><br><span class="line">                      ))</span><br><span class="line">                  .toList(),</span><br><span class="line">            ));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h5 id="AboutDialog"><a href="#AboutDialog" class="headerlink" title="AboutDialog"></a>AboutDialog</h5><p><code>AboutDialog</code> 主要是用于展示你的 <code>App</code> 或者别的相关东西的内容信息的，平时用的比较少，显示 <code>AboutDialog</code> 有两种方式可以展示，一种是前面一样的 <code>showDialog</code> 方法，传入一个 <code>AboutDialog</code> 实例，还有中方法是直接调用 <code>showAboutDialog</code> 方法。我们还是一样在列表加个按钮，并指向显示 <code>AboutDialog</code> 的事件。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">_showAboutDialog() &#123;</span><br><span class="line">    showDialog(</span><br><span class="line">        barrierDismissible: <span class="keyword">false</span>,</span><br><span class="line">        context: context,</span><br><span class="line">        builder: (context) =&gt; AboutDialog(</span><br><span class="line">              <span class="comment">// App 的名字</span></span><br><span class="line">              applicationName: <span class="string">&#x27;Flutter 入门指北&#x27;</span>,</span><br><span class="line">              <span class="comment">// App 的版本号</span></span><br><span class="line">              applicationVersion: <span class="string">&#x27;0.1.1&#x27;</span>,</span><br><span class="line">              <span class="comment">// App 基本信息下面会显示一行小字，主要用来显示版权信息</span></span><br><span class="line">              applicationLegalese: <span class="string">&#x27;Copyright: this is a copyright notice topically&#x27;</span>,</span><br><span class="line">              <span class="comment">// App 的图标</span></span><br><span class="line">              applicationIcon: Icon(Icons.android, size: <span class="number">28.0</span>, color: CupertinoColors.activeBlue),</span><br><span class="line">              <span class="comment">// 任何你想展示的</span></span><br><span class="line">              children: &lt;Widget&gt;[Text(<span class="string">&#x27;我是个比较正经的对话框内容...你可以随便把我替换成任何部件，只要你喜欢(*^▽^*)&#x27;</span>)],</span><br><span class="line">            ));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>也可以通过 <code>showAboutDialog</code> 实现同样的效果</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_showAboutDialog() &#123;</span><br><span class="line">  showAboutDialog(</span><br><span class="line">    context: context,</span><br><span class="line">    applicationName: <span class="string">&#x27;Flutter 入门指北&#x27;</span>,</span><br><span class="line">    applicationVersion: <span class="string">&#x27;0.1.1&#x27;</span>,</span><br><span class="line">    applicationLegalese: <span class="string">&#x27;Copyright: this is a copyright notice topically&#x27;</span>,</span><br><span class="line">    applicationIcon: Image.asset(<span class="string">&#x27;images/app_icon.png&#x27;</span>, width: <span class="number">40.0</span>, height: <span class="number">40.0</span>),</span><br><span class="line">    children: &lt;Widget&gt;[Text(<span class="string">&#x27;我是个比较正经的对话框内容...你可以随便把我替换成任何部件，只要你喜欢(*^▽^*)&#x27;</span>)],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后的效果：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-692a6d8b1b1b2ad1.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p><code>AboutDialog</code> 会自带两个按钮 <code>VIEW LICENSES</code> 和 <code>CLOSE</code>，<code>VIEW LICENSES</code> 会跳转一个 <code>Flutter Licenses</code> 的网页，<code>CLOSE</code> 会关闭，至于为什么是英文的，是因为我们没有设置语言的原因，这个涉及到多语言，这边推荐几篇之前看的文章，如果下次有时间的话会单独拿出来讲下</p>
<p><a target="_blank" rel="noopener" href="https://www.didierboelens.com/2018/04/internationalization---make-an-flutter-application-multi-lingual/">英文原版多语言设置，介绍两种方式实现</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yumi0629/article/details/81873141">国人翻译版，未持续更新第二种方式</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5c701379f265da2d9b5e196a">使用插件 in18 版</a></p>
<p>这边为了支持中文，我们做下如下的修改，首先打开 <code>pubspec.ymal</code> 文件加入如下支持</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-d8d87f53f23ef081.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/609/format/webp" width="300" height="300" align="center"/>

<p><code>get package</code> 后给 <code>MaterialApp</code> 加入如下属性，这样就会支持中文了，这里需要导入包 <code>package:flutter_localizations/flutter_localizations.dart</code>，再次运行，就会发现之前的英文变成中文了，当然你也可以设置成别的语言。</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-6fe46f000ccd7336.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/453/format/webp" width="300" height="250" align="center"/>

<h4 id="Dialog-状态保持"><a href="#Dialog-状态保持" class="headerlink" title="Dialog 状态保持"></a>Dialog 状态保持</h4><p>假如有个需求，需要在弹出的 <code>Dialog</code> 显示当前被改变的值，然后通过按钮可以修改这个值 ，该如何实现。相信很多小伙伴都会这么认为，通过 <code>setState</code> 来修改不就行了吗，没错，我一开始的确这么去实现的，我们先看下代码好了，增加一个 <code>DialogState</code> 按钮，然后指向对应的点击事件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">_showStateDialog() &#123;</span><br><span class="line">    showDialog(</span><br><span class="line">        context: context,</span><br><span class="line">        barrierDismissible: <span class="keyword">false</span>,</span><br><span class="line">        builder: (context) =&gt; SimpleDialog(</span><br><span class="line">              title: Text(<span class="string">&#x27;我这边能实时修改状态值&#x27;</span>),</span><br><span class="line">              contentPadding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">12.0</span>, vertical: <span class="number">8.0</span>),</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                Text(<span class="string">&#x27;当前的值是： <span class="subst">$_count</span>&#x27;</span>, style: TextStyle(fontSize: <span class="number">18.0</span>)),</span><br><span class="line">                Padding(</span><br><span class="line">                  padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">12.0</span>),</span><br><span class="line">                  child: Row(mainAxisAlignment: MainAxisAlignment.spaceAround, children: &lt;Widget&gt;[</span><br><span class="line">                    RaisedButton(</span><br><span class="line">                      onPressed: increase,</span><br><span class="line">                      child: Text(<span class="string">&#x27;点我自增&#x27;</span>),</span><br><span class="line">                    ),</span><br><span class="line">                    RaisedButton(</span><br><span class="line">                      onPressed: decrease,</span><br><span class="line">                      child: Text(<span class="string">&#x27;点我自减&#x27;</span>),</span><br><span class="line">                    ),</span><br><span class="line">                    RaisedButton(</span><br><span class="line">                      onPressed: () =&gt; Navigator.pop(context),</span><br><span class="line">                      child: Text(<span class="string">&#x27;点我关闭&#x27;</span>),</span><br><span class="line">                    )</span><br><span class="line">                  ]),</span><br><span class="line">                )</span><br><span class="line">              ],</span><br><span class="line">            ));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>然后我们运行看下</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-b90b21ff3cca2241.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>诶诶诶，怎么 <code>Dialog</code> 的值不改变呢，明明界面上的已经修改了啊。所以说图样图森破咯，看下官方对 <code>showDialog</code> 方法的解释吧</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">This function takes a <span class="code">`builder`</span> which typically builds a [Dialog] widget.</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">Content below the dialog is dimmed with a [ModalBarrier]. The widget</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">returned by the <span class="code">`builder`</span> does not share a context with the location that</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown"><span class="code">`showDialog`</span> is originally called from. Use a [StatefulBuilder] or a</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">custom [StatefulWidget] if the dialog needs to update dynamically.</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>糟糕透的翻译又来了：该方法通过 <code>builder</code> 参数来传入一个 <code>Dialog</code> 部件，<code>dialog</code> 下的内容被一个「模态障碍」阻隔，<code>builder</code> 的 <code>context</code> 和调用 <code>showDialog</code> 时候的 <code>context</code> 不是共享的，如果需要动态修改 <code>dialog</code> 的状态值，需要通过 <code>StatefulBuilder</code> 或者自定义 <code>dialog</code> 继承于 <code>StatefulWidget</code> 来实现</p>
<p>所以解决的方法很明确，对上面的代码进行修改，在外层嵌套一个 <code>StatefulBuilder</code> 部件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">_showStateDialog() &#123;</span><br><span class="line">   showDialog(</span><br><span class="line">       context: context,</span><br><span class="line">       barrierDismissible: <span class="keyword">false</span>,</span><br><span class="line">       <span class="comment">// 通过 StatefulBuilder 来保存 dialog 状态</span></span><br><span class="line">       <span class="comment">// builder 需要传入一个 BuildContext 和 StateSetter 类型参数</span></span><br><span class="line">       <span class="comment">// StateSetter 有一个 VoidCallback，修改状态的方法在这写</span></span><br><span class="line">       builder: (context) =&gt; StatefulBuilder(</span><br><span class="line">           builder: (context, dialogStateState) =&gt; SimpleDialog(</span><br><span class="line">                 title: Text(<span class="string">&#x27;我这边能实时修改状态值&#x27;</span>),</span><br><span class="line">                 contentPadding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">12.0</span>, vertical: <span class="number">8.0</span>),</span><br><span class="line">                 children: &lt;Widget&gt;[</span><br><span class="line">                   Text(<span class="string">&#x27;当前的值是： <span class="subst">$_count</span>&#x27;</span>, style: TextStyle(fontSize: <span class="number">18.0</span>)),</span><br><span class="line">                   Padding(</span><br><span class="line">                     padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">12.0</span>),</span><br><span class="line">                     child: Row(mainAxisAlignment: MainAxisAlignment.spaceAround, children: &lt;Widget&gt;[</span><br><span class="line">                       RaisedButton(</span><br><span class="line">                         <span class="comment">// 通过 StatefulBuilder 的 StateSetter 来修改值</span></span><br><span class="line">                         onPressed: () =&gt; dialogStateState(() =&gt; increase()),</span><br><span class="line">                         child: Text(<span class="string">&#x27;点我自增&#x27;</span>),</span><br><span class="line">                       ),</span><br><span class="line">                       RaisedButton(</span><br><span class="line">                         onPressed: () =&gt; dialogStateState(() =&gt; decrease()),</span><br><span class="line">                         child: Text(<span class="string">&#x27;点我自减&#x27;</span>),</span><br><span class="line">                       ),</span><br><span class="line">                       RaisedButton(</span><br><span class="line">                         onPressed: () =&gt; Navigator.pop(context),</span><br><span class="line">                         child: Text(<span class="string">&#x27;点我关闭&#x27;</span>),</span><br><span class="line">                       )</span><br><span class="line">                     ]),</span><br><span class="line">                   )</span><br><span class="line">                 ],</span><br><span class="line">               )));</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>然后再运行下，可以看到 <code>dialog</code> 和界面的值保持一致了</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-fe488a85d5276b4c.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p><em>以上部分代码查看 <code>prompt_main.dart</code> 文件</em></p>
<p>差不多常用弹窗和操作提示就在这了，好好消化吧~</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/24/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-09/" data-id="cl0ukmc2q0013pn1g3nod90l1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-08" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/21/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-08/" class="article-date">
  <time datetime="2019-03-21T12:40:28.000Z" itemprop="datePublished">2019-03-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/21/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-08/">Flutter Guide(08) -- 认识 Flutter 的 Sliver 家族</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上节最后留了个坑到这节来解决，因为涉及部件比较多，所以留到这边来继续讲，不然写太多了怕小伙伴看不下去</p>
<p>在上节最后，给小伙伴们展示了 <code>SliveGrid</code> 和 <code>SliverFixedExtentList</code> 的用法，基本上和 <code>GridView</code> 和 <code>ListView</code> 的用法差不多，所以这边就不多讲这两个部件了。</p>
<h4 id="SliverAppBar"><a href="#SliverAppBar" class="headerlink" title="SliverAppBar"></a>SliverAppBar</h4><p>相信很多 <code>Android</code> 开发的小伙伴会用到 <code>MaterialDesign</code> 的 <code>CollapsingToolbarLayout</code> 来实现折叠头部，既然 <code>Android</code> 有的，那么 <code>Flutter</code> 也不会少，毕竟 <code>Flutter</code> 主打的也是 <code>MaterialDesign</code> 啊。首先看下 <code>SliverAppBar</code> 的源码吧，其实和 <code>AppBar</code> 的参数差不多，只是多了一些比较特殊的属性</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SliverAppBar(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.leading,</span><br><span class="line">    <span class="keyword">this</span>.automaticallyImplyLeading = <span class="keyword">true</span>,</span><br><span class="line">    <span class="keyword">this</span>.title,</span><br><span class="line">    <span class="keyword">this</span>.actions,</span><br><span class="line">    <span class="keyword">this</span>.flexibleSpace, <span class="comment">// 通过这个来设置背景</span></span><br><span class="line">    <span class="keyword">this</span>.bottom,</span><br><span class="line">    <span class="keyword">this</span>.elevation,</span><br><span class="line">    <span class="keyword">this</span>.forceElevated = <span class="keyword">false</span>, <span class="comment">// 是否显示层次感</span></span><br><span class="line">    <span class="keyword">this</span>.backgroundColor,</span><br><span class="line">    <span class="keyword">this</span>.brightness,</span><br><span class="line">    <span class="keyword">this</span>.iconTheme,</span><br><span class="line">    <span class="keyword">this</span>.textTheme,</span><br><span class="line">    <span class="keyword">this</span>.primary = <span class="keyword">true</span>,</span><br><span class="line">    <span class="keyword">this</span>.centerTitle,</span><br><span class="line">    <span class="keyword">this</span>.titleSpacing = NavigationToolbar.kMiddleSpacing,</span><br><span class="line">    <span class="keyword">this</span>.expandedHeight, <span class="comment">// 展开的高度</span></span><br><span class="line">    <span class="comment">// 以下三个等例子再讲</span></span><br><span class="line">    <span class="keyword">this</span>.floating = <span class="keyword">false</span>, </span><br><span class="line">    <span class="keyword">this</span>.pinned = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.snap = <span class="keyword">false</span>,</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>别的参数应该不陌生吧，都是 <code>AppBar</code> 的，那么直接来看个例子吧，还是通过上节说的 <code>CustomScrollView</code> 来包裹 <code>Sliver</code> 部件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SliverDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">        body: CustomScrollView(slivers: &lt;Widget&gt;[</span><br><span class="line">      SliverAppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Sliver Demo&#x27;</span>),</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">        <span class="comment">// 展开的高度</span></span><br><span class="line">        expandedHeight: <span class="number">300.0</span>,</span><br><span class="line">        <span class="comment">// 强制显示阴影</span></span><br><span class="line">        forceElevated: <span class="keyword">true</span>,</span><br><span class="line">        <span class="comment">// 设置该属性，当有下滑手势的时候，就会显示 AppBar</span></span><br><span class="line"><span class="comment">//        floating: true,</span></span><br><span class="line">        <span class="comment">// 该属性只有在 floating 为 true 的情况下使用，不然会报错</span></span><br><span class="line">        <span class="comment">// 当上滑到一定的比例，会自动把 AppBar 收缩（不知道是不是 bug，当 AppBar 下面的部件没有被 AppBar 覆盖的时候，不会自动收缩）</span></span><br><span class="line">        <span class="comment">// 当下滑到一定比例，会自动把 AppBar 展开</span></span><br><span class="line"><span class="comment">//        snap: true,</span></span><br><span class="line">        <span class="comment">// 设置该属性使 Appbar 折叠后不消失</span></span><br><span class="line"><span class="comment">//        pinned: true,</span></span><br><span class="line">        <span class="comment">// 通过这个属性设置 AppBar 的背景</span></span><br><span class="line">        flexibleSpace: FlexibleSpaceBar(</span><br><span class="line"><span class="comment">//          title: Text(&#x27;Expanded Title&#x27;),</span></span><br><span class="line">          <span class="comment">// 背景折叠动画</span></span><br><span class="line">          collapseMode: CollapseMode.parallax,</span><br><span class="line">          background: Image.asset(<span class="string">&#x27;images/timg.jpg&#x27;</span>, fit: BoxFit.cover),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 这个部件一般用于最后填充用的，会占有一个屏幕的高度，</span></span><br><span class="line">      <span class="comment">// 可以在 child 属性加入需要展示的部件</span></span><br><span class="line">      SliverFillRemaining(</span><br><span class="line">        child: Center(child: Text(<span class="string">&#x27;FillRemaining&#x27;</span>, style: TextStyle(fontSize: <span class="number">30.0</span>))),</span><br><span class="line">      ),</span><br><span class="line">    ]));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里分别给出不同的动图来查看三个属性的影响</p>
<p>如果设置了 <code>floating</code> 属性，当有下拉动作时，会显示 <code>AppBar</code></p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-f444ffb5001f50dd.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>如果设置了 <code>snap</code> 属性，滑动距离达到一定值后，会根据滑动方向收缩或者展开</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-8e86360f3005b43d.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>如果设置了 <code>pinned</code> 属性，那么 <code>AppBar</code> 就会在界面上不会消失</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-9f97890198d77eff.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>以上的效果图把 <code>SliverFillRemaining</code> 换成列表 <code>SliverFixedExtentList</code> 效果可能会更加明显，这边给小伙伴自己替换测试吧。</p>
<h4 id="SliverFillViewport"><a href="#SliverFillViewport" class="headerlink" title="SliverFillViewport"></a>SliverFillViewport</h4><p>这边提到了 <code>SliverFillRemaining</code> 用来填充视图，那么顺带提下 <code>SliverFillViewport</code> 这个部件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SliverFillViewport(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> SliverChildDelegate delegate, <span class="comment">// 这个 delegate 同 SliverGrid </span></span><br><span class="line">    <span class="keyword">this</span>.viewportFraction = <span class="number">1.0</span>, <span class="comment">// 同屏幕的比例值，1.0 为一个屏幕大小</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>如果一个滑动列表，每个 <code>item</code> 需要占满一个屏幕或者更大，可以使用该部件生成列表，但是如果 <code>item</code> 的高度小于一个屏幕高度，那就不太推荐了，在首尾会用空白 <code>item</code> 来把未填满的补上，就是首尾都会留空白。我们使用 <code>SliverFillViewport</code> 对 <code>SliverFillRemaning</code> 进行替换</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SliverFillViewport(</span><br><span class="line">          viewportFraction: <span class="number">1.0</span>,</span><br><span class="line">          delegate: SliverChildBuilderDelegate(</span><br><span class="line">              (_, index) =&gt; Container(child: Text(<span class="string">&#x27;Item <span class="subst">$index</span>&#x27;</span>), alignment: Alignment.center, color: colors[index % <span class="number">4</span>]),</span><br><span class="line">              childCount: <span class="number">10</span>))</span><br></pre></td></tr></table></figure>

<p>效果就不展示了，可自行运行查看。</p>
<h4 id="SliverToBoxAdapter"><a href="#SliverToBoxAdapter" class="headerlink" title="SliverToBoxAdapter"></a>SliverToBoxAdapter</h4><p>还记得上节最后的代码中，有使用 <code>SliverToBoxAdapter</code> 这个部件吗，这个部件只需要传入一个 <code>child</code> 属性。因为在 <code>CustomScrollView</code> 中只允许传入 <code>Sliver</code> 部件，那么类似 <code>Container</code> 等普通部件就不可以使用了，那么这样就需要更多的 <code>Sliver</code> 组件才能完成视图，所以为了方便，直接通过 <code>SliverToBoxAdapter</code> 对普通部件进行包裹，这样就成为一个 <code>Sliver</code> 部件了。总结下 <code>SliverToBoxAdapter</code> 的功能就是 <strong>把一个普通部件包裹成为 <code>Sliver</code> 部件</strong>，例子就不举了，上节已经有了。</p>
<h4 id="SliverPadding"><a href="#SliverPadding" class="headerlink" title="SliverPadding"></a>SliverPadding</h4><p>那么在 <code>CustomScrollView</code> 中部件之间如何设置间距呢，可能你会想到用 <code>SliverToBoxAdapter</code> 包裹一个 <code>Padding</code> 来处理，当然没问题。不过 <code>Flutter</code> 也提供了专门的部件 <code>SliverPadding</code> 使用方式同 <code>Padding</code>，但是需要传入一个 <code>sliver</code> 作为子类。</p>
<h4 id="SliverPersistentHeader"><a href="#SliverPersistentHeader" class="headerlink" title="SliverPersistentHeader"></a>SliverPersistentHeader</h4><p><code>Flutter</code> 中，为我们提供了这么一个作为头部的部件 <code>SliverPersistentHeader</code>，这个部件可以根据滚动的距离缩小高度，有点类似 <code>SliverAppBar</code> 的背景效果。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SliverPersistentHeader(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.delegate, <span class="comment">// SliverPersistentHeaderDelegate，用来创建展示内容</span></span><br><span class="line">    <span class="keyword">this</span>.pinned = <span class="keyword">false</span>, <span class="comment">// 同 SliverAppBar 属性</span></span><br><span class="line">    <span class="keyword">this</span>.floating = <span class="keyword">false</span>,</span><br><span class="line">  &#125;) </span><br></pre></td></tr></table></figure>

<h5 id="SliverPersistentHeaderDelegate"><a href="#SliverPersistentHeaderDelegate" class="headerlink" title="SliverPersistentHeaderDelegate"></a>SliverPersistentHeaderDelegate</h5><p>这个代理比较特殊，是个抽象类，也就是需要我们自己进行继承后再实现方法。<code>SliverPersistentHeaderDelegate</code> 需要提供一个最大值，最小值，展示内容，以及更新部件条件</p>
<p>比如我们需要展示一个最大高度 300，最小高度 100，居中的文字，那么我们可以这么写这个代理类</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoHeader</span> <span class="keyword">extends</span> <span class="title">SliverPersistentHeaderDelegate</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context, <span class="built_in">double</span> shrinkOffset, <span class="built_in">bool</span> overlapsContent) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">        color: Colors.pink,</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        child: Text(<span class="string">&#x27;我是一个头部部件&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)));</span><br><span class="line">  &#125; <span class="comment">// 头部展示内容</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">double</span> <span class="keyword">get</span> maxExtent =&gt; <span class="number">300.0</span>; <span class="comment">// 最大高度</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">double</span> <span class="keyword">get</span> minExtent =&gt; <span class="number">100.0</span>; <span class="comment">// 最小高度</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> shouldRebuild(SliverPersistentHeaderDelegate oldDelegate) =&gt; <span class="keyword">false</span>; <span class="comment">// 因为所有的内容都是固定的，所以不需要更新</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 <code>SliverPersistentHeader</code> 代替 <code>SliverAppBar</code>，看下效果</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SliverDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Color&gt; colors = [Colors.red, Colors.green, Colors.blue, Colors.pink];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">        body: CustomScrollView(slivers: &lt;Widget&gt;[</span><br><span class="line">        SliverPersistentHeader(delegate: DemoHeader(), pinned: <span class="keyword">true</span>),</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 这个部件一般用于最后填充用的，会占有一个屏幕的高度，</span></span><br><span class="line">      <span class="comment">// 可以在 child 属性加入需要展示的部件</span></span><br><span class="line">          SliverFillRemaining(</span><br><span class="line">            child: Center(child: Text(<span class="string">&#x27;FillRemaining&#x27;</span>, style: TextStyle(fontSize: <span class="number">30.0</span>))),</span><br><span class="line">          ),</span><br><span class="line">    ]));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后的效果图</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-ea541a1a1b880d2e.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>当然，为了方便扩展，需要重新封装下 <code>Delegate</code> ，通过外部传入范围和展示内容</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义 SliverPersistentHeaderDelegate</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomSliverPersistentHeaderDelegate</span> <span class="keyword">extends</span> <span class="title">SliverPersistentHeaderDelegate</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> max; <span class="comment">// 最大高度</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> min; <span class="comment">// 最小高度</span></span><br><span class="line">  <span class="keyword">final</span> Widget child; <span class="comment">// 需要展示的内容</span></span><br><span class="line"></span><br><span class="line">  CustomSliverPersistentHeaderDelegate(&#123;<span class="meta">@required</span> <span class="keyword">this</span>.max, <span class="meta">@required</span> <span class="keyword">this</span>.min, <span class="meta">@required</span> <span class="keyword">this</span>.child&#125;)</span><br><span class="line">      <span class="comment">// 如果 assert 内部条件不成立，会报错</span></span><br><span class="line">      : <span class="keyword">assert</span>(max != <span class="keyword">null</span>),</span><br><span class="line">        <span class="keyword">assert</span>(min != <span class="keyword">null</span>),</span><br><span class="line">        <span class="keyword">assert</span>(child != <span class="keyword">null</span>),</span><br><span class="line">        <span class="keyword">assert</span>(min &lt;= max),</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回展示的内容，如果内容固定可以直接在这定义，如果需要可扩展，这边通过传入值来定义</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context, <span class="built_in">double</span> shrinkOffset, <span class="built_in">bool</span> overlapsContent) =&gt; child;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">double</span> <span class="keyword">get</span> maxExtent =&gt; max; <span class="comment">// 返回最大高度</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">double</span> <span class="keyword">get</span> minExtent =&gt; min; <span class="comment">// 返回最小高度</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> shouldRebuild(CustomSliverPersistentHeaderDelegate oldDelegate) &#123;</span><br><span class="line">    <span class="comment">// 是否需要更新，这里我们定义当高度范围和展示内容被替换的时候进行刷新界面</span></span><br><span class="line">    <span class="keyword">return</span> max != oldDelegate.max || min != oldDelegate.min || child != oldDelegate.child;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们就可以愉快的使用了，不需要每个 <code>Delegate</code> 都重新写一遍，例如替换下刚才写死的 <code>DemoHeader</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SliverPersistentHeader(</span><br><span class="line">        <span class="comment">// 属性同 SliverAppBar</span></span><br><span class="line">        pinned: <span class="keyword">true</span>,</span><br><span class="line">        floating: <span class="keyword">true</span>,</span><br><span class="line">        <span class="comment">// 因为 SliverPersistentHeaderDelegate 是一个抽象类，所以需要自定义</span></span><br><span class="line">        delegate: CustomSliverPersistentHeaderDelegate(</span><br><span class="line">            max: <span class="number">300.0</span>, min: <span class="number">100.0</span>, child: Text(<span class="string">&#x27;我是一个头部部件&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>))),</span><br><span class="line">      ),</span><br></pre></td></tr></table></figure>

<p>例如需要替换成一张图片，直接将 <code>Text</code> 修改成 <code>Image</code> 即可。</p>
<p><em>以上部分代码查看 <code>sliver_main.dart</code> 文件</em></p>
<h4 id="NestedScrollView"><a href="#NestedScrollView" class="headerlink" title="NestedScrollView"></a>NestedScrollView</h4><p>讲到这了，不得不提下 <code>Scrollable</code> 中比较重要的一员 <code>NestedScrollView</code>，先看下官方的解释</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">A scrolling view inside of which can be nested other scrolling views, with</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">their scroll positions being intrinsically linked.</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>糟透了的翻译 X 1：一个内部能够嵌套其他滚动部件，并使其滚动位置联结到一起的滚动部件</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">The most common use case for this widget is a scrollable view with a</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">flexible [SliverAppBar] containing a [TabBar] in the header (build by</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[headerSliverBuilder], and with a [TabBarView] in the [body], such that the</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">scrollable view&#x27;s contents vary based on which tab is visible.</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>糟透了的翻译 X 2：最常用的情况，就是在其 <code>headerSliverBuilder</code> 中使用携带 <code>TabBar</code> 的 <code>SliverAppBar</code>（就是使用 <code>SliverAppBar</code> 的 <code>bottom</code> 属性添加 <code>tab</code> 切换也），其 <code>body</code> 属性使用 <code>TabBarView</code> 来展示 <code>Tab</code> 页的内容，这样通过切换 <code>Tab</code> 页就能展示该页下的展示内容。</p>
<p>看下 <code>headerSliverBuilder</code> 的定义</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">Signature used by [NestedScrollView] for building its header.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">The <span class="code">`innerBoxIsScrolled`</span> argument is typically used to control the</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[SliverAppBar.forceElevated] property to ensure that the app bar shows a</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">shadow, since it would otherwise not necessarily be aware that it had</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">content ostensibly below it.</span></span></span><br><span class="line"><span class="keyword">typedef</span> NestedScrollViewHeaderSliversBuilder = <span class="built_in">List</span>&lt;Widget&gt; <span class="built_in">Function</span>(BuildContext context, <span class="built_in">bool</span> innerBoxIsScrolled);</span><br></pre></td></tr></table></figure>
</blockquote>
<p>糟透了的翻译 X 3：用于构建 <code>NestScrollView</code> 的头部部件，<code>innerBoxIsScrolled</code> 主要用来控制 <code>SliverAppBar</code> 的 <code>forceElevated</code> 属性，当内部内容滚动时，显示 <code>SliverAppbar</code> 的阴影，主要用来提醒内部的内容低于 <code>SliverAppBar</code> （相当于给人一种物理层次感，否则很容易被认为，头部和内容是连接在一起的）</p>
<p>接下来看下 <code>NestedScrollView</code> 内部个人觉得有点重要的一个方法 <code>sliverOverlapAbsorberHandleFor</code></p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">Returns the [SliverOverlapAbsorberHandle] of the nearest ancestor</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[NestedScrollView].</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">This is necessary to configure the [SliverOverlapAbsorber] and</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[SliverOverlapInjector] widgets.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">For sample code showing how to use this method, see the [NestedScrollView]</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">documentation.</span></span></span><br><span class="line"><span class="keyword">static</span> SliverOverlapAbsorberHandle sliverOverlapAbsorberHandleFor(BuildContext context) &#123;</span><br><span class="line"><span class="keyword">final</span> _InheritedNestedScrollView target = context.inheritFromWidgetOfExactType(_InheritedNestedScrollView);</span><br><span class="line"><span class="keyword">assert</span>(target != <span class="keyword">null</span>, <span class="string">&#x27;NestedScrollView.sliverOverlapAbsorberHandleFor must be called with a context that contains a NestedScrollView.&#x27;</span>);</span><br><span class="line"><span class="keyword">return</span> target.state._absorberHandle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>请注意到中间的注释</p>
<p>糟透了的翻译 X 4：这个方法返回的值对于 <code>SliverOverlapAbsorber</code> 和 <code>SliverOverlapInjector</code> 部件是非常重要的参数</p>
<p>接着请注意代码中的那段 <code>assert</code> 中的文字</p>
<p>糟透了的翻译 X 5：<code>sliverOverlapAbsorberHandleFor</code> 传入的参数 <code>context</code> 中必须包含 <code>NestedScrollView</code> </p>
<p>#####SliverOverlapAbsorber</p>
<p>这边又引入了两个部件 <code>SliverOverlapAbsorber</code> + <code>SliverOverlapInjector</code> 还是看源码的解释吧</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">Creates a sliver that absorbs overlap and reports it to a</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">[SliverOverlapAbsorberHandle].</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">The [handle] must not be null.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">The [child] must be a sliver.</span></span></span><br><span class="line"><span class="keyword">const</span> SliverOverlapAbsorber(&#123;</span><br><span class="line">Key key,</span><br><span class="line"><span class="meta">@required</span> <span class="keyword">this</span>.handle,</span><br><span class="line">Widget child,</span><br><span class="line">&#125;) </span><br></pre></td></tr></table></figure>
</blockquote>
<p>糟透了的翻译 X 6：一个 <code>sliver</code> 部件，用于把部件重叠的高度反馈给 <code>SliverOverlapAbsorberHandle</code>，而且指明了 <code>handle</code> 不能空，可以通过 <code>NestedScrollView</code> 的 <code>sliverOverlapAbsorberHandleFor</code> 方法来赋值，并且 <code>child</code> 必须是个 <code>sliver</code> 部件，也就是说我们的 <code>SliverAppBar</code> 需要放到 <code>SliverOverlapAbsorber</code> 里面。</p>
<p>#####SliverOverlapInjector</p>
<blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">Creates a sliver that is as tall as the value of the given [handle]&#x27;s</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">layout extent.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">The [handle] must not be null.</span></span></span><br><span class="line"><span class="keyword">const</span> SliverOverlapInjector(&#123;</span><br><span class="line">Key key,</span><br><span class="line"><span class="meta">@required</span> <span class="keyword">this</span>.handle,</span><br><span class="line">Widget child,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</blockquote>
<p>糟透了的翻译 X 7：创建一个和指定的 <code>handle</code> 一样高度的 <code>sliver</code> 部件，这个 <code>handle</code> 同 <code>SliverOverlapAbsorber</code> 的 <code>handle</code> 保持一致即可。</p>
<p>分析完源码后，例子的目标很明确，使用 <code>SliverAppBar</code> + <code>TabBar</code> + <code>TabBarView</code>，先看下最后的效果图吧</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-12bdb77ffa822d0c.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NestedScrollDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> _tabs = &lt;<span class="built_in">String</span>&gt;[<span class="string">&#x27;TabA&#x27;</span>, <span class="string">&#x27;TabB&#x27;</span>];</span><br><span class="line">  <span class="keyword">final</span> colors = &lt;Color&gt;[Colors.red, Colors.green, Colors.blue, Colors.pink, Colors.yellow, Colors.deepPurple];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: DefaultTabController(</span><br><span class="line">          length: _tabs.length,</span><br><span class="line">          child: NestedScrollView(</span><br><span class="line">              headerSliverBuilder: (context, innerScrolled) =&gt; &lt;Widget&gt;[</span><br><span class="line">                    SliverOverlapAbsorber(</span><br><span class="line">                      <span class="comment">// 传入 handle 值，直接通过 `sliverOverlapAbsorberHandleFor` 获取即可</span></span><br><span class="line">                      handle: NestedScrollView.sliverOverlapAbsorberHandleFor(context),</span><br><span class="line">                      child: SliverAppBar(</span><br><span class="line">                        pinned: <span class="keyword">true</span>,</span><br><span class="line">                        title: Text(<span class="string">&#x27;NestedScroll Demo&#x27;</span>),</span><br><span class="line">                        expandedHeight: <span class="number">200.0</span>,</span><br><span class="line">                        flexibleSpace: FlexibleSpaceBar(background: Image.asset(<span class="string">&#x27;images/timg.jpg&#x27;</span>, fit: BoxFit.cover)),</span><br><span class="line">                        bottom: TabBar(tabs: _tabs.map((tab) =&gt; Text(tab, style: TextStyle(fontSize: <span class="number">18.0</span>))).toList()),</span><br><span class="line">                        forceElevated: innerScrolled,</span><br><span class="line">                      ),</span><br><span class="line">                    )</span><br><span class="line">                  ],</span><br><span class="line">              body: TabBarView(</span><br><span class="line">                  children: _tabs</span><br><span class="line">                      <span class="comment">// 这边需要通过 Builder 来创建 TabBarView 的内容，否则会报错</span></span><br><span class="line">                      <span class="comment">// NestedScrollView.sliverOverlapAbsorberHandleFor must be called with a context that contains a NestedScrollView.</span></span><br><span class="line">                      .map((tab) =&gt; Builder(</span><br><span class="line">                            builder: (context) =&gt; CustomScrollView(</span><br><span class="line">                                  <span class="comment">// key 保证唯一性</span></span><br><span class="line">                                  key: PageStorageKey&lt;<span class="built_in">String</span>&gt;(tab),</span><br><span class="line">                                  slivers: &lt;Widget&gt;[</span><br><span class="line">                                    <span class="comment">// 将子部件同 `SliverAppBar` 重叠部分顶出来，否则会被遮挡</span></span><br><span class="line">                                    SliverOverlapInjector(</span><br><span class="line">                                        handle: NestedScrollView.sliverOverlapAbsorberHandleFor(context)),</span><br><span class="line">                                    SliverGrid(</span><br><span class="line">                                        delegate: SliverChildBuilderDelegate(</span><br><span class="line">                                            (_, index) =&gt; Image.asset(<span class="string">&#x27;images/ali.jpg&#x27;</span>),</span><br><span class="line">                                            childCount: <span class="number">8</span>),</span><br><span class="line">                                        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">                                            crossAxisCount: <span class="number">4</span>, mainAxisSpacing: <span class="number">10.0</span>, crossAxisSpacing: <span class="number">10.0</span>)),</span><br><span class="line">                                    SliverFixedExtentList(</span><br><span class="line">                                        delegate: SliverChildBuilderDelegate(</span><br><span class="line">                                            (_, index) =&gt; Container(</span><br><span class="line">                                                child: Text(<span class="string">&#x27;<span class="subst">$tab</span> - item<span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>&#x27;</span>,</span><br><span class="line">                                                    style: TextStyle(fontSize: <span class="number">20.0</span>, color: colors[index % <span class="number">6</span>])),</span><br><span class="line">                                                alignment: Alignment.center),</span><br><span class="line">                                            childCount: <span class="number">15</span>),</span><br><span class="line">                                        itemExtent: <span class="number">50.0</span>)</span><br><span class="line">                                  ],</span><br><span class="line">                                ),</span><br><span class="line">                          ))</span><br><span class="line">                      .toList()))),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用的部件和之前讲的没啥大区别，就是多了 <code>SliverOverlapAbsorber</code> 和 <code>SliverOverlapInjector</code> 没啥难度</p>
<p><em>以上部分代码查看 <code>nested_scroll_main.dart</code> 文件</em></p>
<p><code>sliver</code> 部件常用的也就那么多了，望小伙伴好好吸收，跟着例子撸撸代码，撸顺下思路</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/21/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-08/" data-id="cl0ukmc2o000mpn1ghsah9d8t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-07" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/19/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-07/" class="article-date">
  <time datetime="2019-03-19T13:25:24.000Z" itemprop="datePublished">2019-03-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/19/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-07/">Flutter Guide(07) -- 内容太多怎么办，列表来帮你</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前面的小节基本上讲完了常用的部件和容器部件，也可以完成很多的界面，但是又一个问题，假如我们要显示一段文字，比如将 <code>一段又臭又长的文字</code> 在界面上显示 1000 次，不难完成吧</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ..省略一些无关代码</span></span><br><span class="line">body: Text(<span class="string">&#x27;一段又臭又长的文字&#x27;</span> * <span class="number">1000</span>, softWrap: <span class="keyword">true</span>)</span><br></pre></td></tr></table></figure>

<p>很简单，运行到手机…「诶诶诶，**，怎么只显示了一部分，剩下的怎么画不下去」</p>
<p>日常开发中，会遇到很多这种情况，许多界面不是一页就能够显示完的。那么这里提下可滑动的容器部件</p>
<h4 id="SingleChildScrollView"><a href="#SingleChildScrollView" class="headerlink" title="SingleChildScrollView"></a>SingleChildScrollView</h4><p>这个部件非常简单，不贴源码了。最简单的使用方式只需要提供一个 <code>child</code> 即可。现在给前面写的 <code>Text</code> 包裹上一层 <code>SingleChildScrollView</code> 然后再运行，文字全部都展示出来了。</p>
<p>如果需要实现一个垂直的滚动列表，可以直接通过 <code>SingleChildScrollView</code> 包裹 <code>Column</code> 来实现，列表内容全部塞到 <code>Column</code> 即可</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingleChildScrollDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">/// <span class="language-markdown">letters 自由发挥吧...一定要大量，大量，大量</span></span></span><br><span class="line">    <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; letters = [......];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Single Child Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: SingleChildScrollView(</span><br><span class="line">          child: Center(</span><br><span class="line">        child: Column(</span><br><span class="line">          children: <span class="built_in">List</span>.generate(</span><br><span class="line">              letters.length,</span><br><span class="line">              (index) =&gt; Padding(</span><br><span class="line">                    padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">4.0</span>),</span><br><span class="line">                    child: Text(letters[index], style: TextStyle(fontSize: <span class="number">18.0</span>)),</span><br><span class="line">                  )),</span><br><span class="line">        ),</span><br><span class="line">      )),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果会根据你的 <code>letters</code> 不同而不同，这边就不贴效果图了，反正你可以看到一串列表…</p>
<p>那么如果需要实现横向滚动列表呢，稍稍做下修改就行了</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">body: SingleChildScrollView(</span><br><span class="line">    <span class="comment">// 设置滚动方向</span></span><br><span class="line">	scrollDirection: Axis.horizontal,</span><br><span class="line">    child: Center(</span><br><span class="line">      <span class="comment">// 修改为 `Row` 即可</span></span><br><span class="line">	  child: Row(</span><br><span class="line">        children: <span class="built_in">List</span>.generate(</span><br><span class="line">        	letters.length,</span><br><span class="line">            <span class="comment">// 如果你的 letters 数量比较少，推荐加个 `Container` 把宽度指定大点</span></span><br><span class="line">            (index) =&gt; Container(</span><br><span class="line">            	child: Padding(</span><br><span class="line">                	padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">4.0</span>, horizontal: <span class="number">6.0</span>),</span><br><span class="line">                    child: Text(letters[index], style: TextStyle(fontSize: <span class="number">18.0</span>)),</span><br><span class="line">                    ),</span><br><span class="line">                    width: <span class="number">30.0</span>)),</span><br><span class="line">      ),</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>

<p>效果图也不贴了，都比较简单。</p>
<p>该部分代码查看 <code>single_child_scroll_main.dart</code> 文件*</p>
<h4 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h4><p>平时开发 <code>Android</code> 的时候，如果有相同格式的列表要实现，一般会使用 <code>ListView</code> 或者 <code>RecyclerView</code> 来实现，<code>Flutter</code> 也提供了类似的部件 <code>ListView</code></p>
<p>实现 <code>ListView</code> 的方法主要有</p>
<ol>
<li>通过 <code>ListView</code> 设置 <code>children</code> 属性实现</li>
<li>通过 <code>ListView.custom</code> 实现</li>
<li>通过 <code>ListView.builder</code> 实现</li>
<li>通过 <code>ListView.separated</code> 实现带分割线列表</li>
</ol>
<h5 id="ListView-children"><a href="#ListView-children" class="headerlink" title="ListView children"></a>ListView children</h5><p>第一种方法实现列表，和通过 <code>SingleChildScrollView</code> + <code>Column</code> &#x2F; <code>Row</code> 的方法比较类似，不过可以直接通过指定 <code>ListView</code> 的 <code>scrollDirection</code> 就可以了。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">body: ListView(</span><br><span class="line">    <span class="comment">// 通过修改滑动方向设置水平或者垂直方向滚动</span></span><br><span class="line">    scrollDirection: Axis.vertical,</span><br><span class="line">    <span class="comment">// 通过 iterable.map().toList 和 List.generate 方法效果是一样的</span></span><br><span class="line">    children: letters</span><br><span class="line">    	.map((s) =&gt;</span><br><span class="line">        Padding(</span><br><span class="line">        	padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">8.0</span>),</span><br><span class="line">            child: Center(</span><br><span class="line">            	child: Text(s))))</span><br><span class="line">        .toList()),</span><br></pre></td></tr></table></figure>

<h5 id="ListView-custom"><a href="#ListView-custom" class="headerlink" title="ListView.custom"></a>ListView.custom</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">body: ListView.custom(</span><br><span class="line">    <span class="comment">// 指定 item 的高度，可以加快渲染的速度</span></span><br><span class="line">    itemExtent: <span class="number">40.0</span>,</span><br><span class="line">    <span class="comment">// item 代理</span></span><br><span class="line">    childrenDelegate: SliverChildBuilderDelegate(</span><br><span class="line">      <span class="comment">// IndexedWidgetBuilder，根据 index 设置 item 中需要变化的数据</span></span><br><span class="line">      (_, index) =&gt; Center(child: Text(letters[index], style: TextStyle(color: Colors.red))),</span><br><span class="line">      <span class="comment">// 指定 item 的数量</span></span><br><span class="line">      childCount: letters.length,</span><br><span class="line">    )),</span><br></pre></td></tr></table></figure>

<p>如果每个 <code>item</code> 的高度可以确定，那么推荐通过 <code>itemExtent</code> 来设置 <code>item</code> 的高度&#x2F;宽度，能够加快 <code>ListView</code> 的渲染速度。如果不指定高度&#x2F;宽度，<code>ListView</code> 需要根据每个 <code>item</code> 来计算 <code>ListView</code> 的高度，这个计算过程是需要消耗时间和资源的</p>
<h5 id="ListView-builder"><a href="#ListView-builder" class="headerlink" title="ListView.builder"></a>ListView.builder</h5><p>该方法同 <code>custom</code> 类似，<code>custom</code> 需要通过一个 <code>Delegate</code> 生成 <code>item</code>，该方法直接通过 <code>builder</code> 生成，同时也可以直接指定 <code>item</code> 的高度</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body: ListView.builder(</span><br><span class="line">    itemBuilder: (_, index) =&gt; Center(child: Text(letters[index], style: TextStyle(color: Colors.green))),</span><br><span class="line">    itemExtent: <span class="number">40.0</span>,</span><br><span class="line">    itemCount: letters.length),</span><br></pre></td></tr></table></figure>

<p>相对比较简单，代码也比较少…就冲这点，我也愿意用这个方法</p>
<h5 id="ListView-separated"><a href="#ListView-separated" class="headerlink" title="ListView.separated"></a>ListView.separated</h5><p>如果需要在每个 <code>item</code> 之间添加分割线，那么通过以上的方式实现就比较困难了，所以 <code>Flutter</code> 提供了 <code>separated</code> 方法用来快速构建带有分割线的 <code>ListView</code></p>
<p>加入我们的 <code>item</code> 之间的分割线需要如下样式：奇数位和偶数位之间用黑色分割线，偶数位和奇数位之间用红色分割线</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要分割线的时候才使用，不能指定 item 的高度</span></span><br><span class="line">body: ListView.separated(</span><br><span class="line">	itemBuilder: (_, index) =&gt; Padding(</span><br><span class="line">    	padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">20.0</span>),</span><br><span class="line">        child: Center(child: Text(letters[index], style: TextStyle(color: Colors.blue))),</span><br><span class="line">      ),</span><br><span class="line">    <span class="comment">// 这里用来定义分割线</span></span><br><span class="line">    separatorBuilder: (_, index) =&gt; Divider(height: <span class="number">1.0</span>, color: index % <span class="number">2</span> == <span class="number">0</span> ? Colors.black : Colors.red),</span><br><span class="line">    itemCount: letters.length),</span><br></pre></td></tr></table></figure>

<p>最终的效果如下</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-92530f99f0a374e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/341/format/webp" width="200" height="350" align="center"/>

<p><em>以上代码查看 <code>listview_main.dart</code> 文件</em></p>
<p>总结下：<strong>如果 <code>item</code> 的高度能够准确获取，一定要指定 <code>itemExtent</code> 的值，这样会更加高效</strong>，至于要通过哪种方式来生成，完全看个人喜好吧。</p>
<h4 id="ExpansionTile"><a href="#ExpansionTile" class="headerlink" title="ExpansionTile"></a>ExpansionTile</h4><p>既然讲到了 <code>ListView</code>，在日常开发中，折叠列表也是一个比较常用的，所以这边要提下 <code>ExpansionTile</code> 这个部件，因为相对比较简单，所以直接上代码了</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExpansionTilesDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;ExpansionTile Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: ExpansionTile(</span><br><span class="line">        <span class="comment">// 最前面的 widget</span></span><br><span class="line">        leading: Icon(Icons.phone_android),</span><br><span class="line">        <span class="comment">// 替换默认箭头</span></span><br><span class="line"><span class="comment">//        trailing: Icon(Icons.phone_iphone),</span></span><br><span class="line">        title: Text(<span class="string">&#x27;Parent&#x27;</span>),</span><br><span class="line">        <span class="comment">// 默认是否展开</span></span><br><span class="line">        initiallyExpanded: <span class="keyword">true</span>,</span><br><span class="line">        <span class="comment">// 展开时候的背景色</span></span><br><span class="line">        backgroundColor: Colors.yellow[<span class="number">100</span>],</span><br><span class="line">        <span class="comment">// 展开或者收缩的回调，true 表示展开</span></span><br><span class="line">        onExpansionChanged: (expanded) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;ExpansionTile is <span class="subst">$&#123;expanded ? <span class="string">&#x27;expanded&#x27;</span> : <span class="string">&#x27;collapsed&#x27;</span>&#125;</span>&#x27;</span>),</span><br><span class="line">        children: <span class="built_in">List</span>.generate(</span><br><span class="line">            <span class="number">10</span>,</span><br><span class="line">                (position) =&gt;</span><br><span class="line">                Container(</span><br><span class="line">                  padding: <span class="keyword">const</span> EdgeInsets.only(left: <span class="number">80.0</span>),</span><br><span class="line">                  child: Text(<span class="string">&#x27;Children <span class="subst">$&#123;position + <span class="number">1</span>&#125;</span>&#x27;</span>),</span><br><span class="line">                  height: <span class="number">50.0</span>,</span><br><span class="line">                  alignment: Alignment.centerLeft,</span><br><span class="line">                )),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就完成了一个折叠部件，看下最后的效果</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-7b1f3fc522369188.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>那么实现折叠列表也就是通过 <code>ListView</code> 创建一个 <code>ExpansionTile</code> 列表即可，先准备下模拟的数据</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> _keys = [<span class="string">&#x27;ParentA&#x27;</span>, <span class="string">&#x27;ParentB&#x27;</span>, <span class="string">&#x27;ParentC&#x27;</span>, <span class="string">&#x27;ParentD&#x27;</span>, <span class="string">&#x27;ParentE&#x27;</span>, <span class="string">&#x27;ParentF&#x27;</span>];</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;&gt; _data = &#123;</span><br><span class="line">    <span class="string">&#x27;ParentA&#x27;</span>: [<span class="string">&#x27;Child A0&#x27;</span>, <span class="string">&#x27;Child A1&#x27;</span>, <span class="string">&#x27;Child A2&#x27;</span>, <span class="string">&#x27;Child A3&#x27;</span>, <span class="string">&#x27;Child A4&#x27;</span>, <span class="string">&#x27;Child A5&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ParentB&#x27;</span>: [<span class="string">&#x27;Child B0&#x27;</span>, <span class="string">&#x27;Child B1&#x27;</span>, <span class="string">&#x27;Child B2&#x27;</span>, <span class="string">&#x27;Child B3&#x27;</span>, <span class="string">&#x27;Child B4&#x27;</span>, <span class="string">&#x27;Child B5&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ParentC&#x27;</span>: [<span class="string">&#x27;Child C0&#x27;</span>, <span class="string">&#x27;Child C1&#x27;</span>, <span class="string">&#x27;Child C2&#x27;</span>, <span class="string">&#x27;Child C3&#x27;</span>, <span class="string">&#x27;Child C4&#x27;</span>, <span class="string">&#x27;Child C5&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ParentD&#x27;</span>: [<span class="string">&#x27;Child D0&#x27;</span>, <span class="string">&#x27;Child D1&#x27;</span>, <span class="string">&#x27;Child D2&#x27;</span>, <span class="string">&#x27;Child D3&#x27;</span>, <span class="string">&#x27;Child D4&#x27;</span>, <span class="string">&#x27;Child D5&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ParentE&#x27;</span>: [<span class="string">&#x27;Child E0&#x27;</span>, <span class="string">&#x27;Child E1&#x27;</span>, <span class="string">&#x27;Child E2&#x27;</span>, <span class="string">&#x27;Child E3&#x27;</span>, <span class="string">&#x27;Child E4&#x27;</span>, <span class="string">&#x27;Child E5&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;ParentF&#x27;</span>: [<span class="string">&#x27;Child F0&#x27;</span>, <span class="string">&#x27;Child F1&#x27;</span>, <span class="string">&#x27;Child F2&#x27;</span>, <span class="string">&#x27;Child F3&#x27;</span>, <span class="string">&#x27;Child F4&#x27;</span>, <span class="string">&#x27;Child F5&#x27;</span>]</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

<p>在平时开发过程中，后台返回的数据应该是列表嵌套列表的形式比较多，我这边主要就是为了偷懒就随便弄了，接着修改下 <code>body</code> 的代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">body: ListView(</span><br><span class="line">          children: _keys</span><br><span class="line">              .map((key) =&gt; ExpansionTile(</span><br><span class="line">                    title: Text(key),</span><br><span class="line">                    children: _data[key]</span><br><span class="line">                        .map((value) =&gt; InkWell(</span><br><span class="line">                            child: Container(</span><br><span class="line">                              child: Text(value),</span><br><span class="line">                              padding: <span class="keyword">const</span> EdgeInsets.only(left: <span class="number">80.0</span>),</span><br><span class="line">                              height: <span class="number">50.0</span>,</span><br><span class="line">                              alignment: Alignment.centerLeft,</span><br><span class="line">                            ),</span><br><span class="line">                            onTap: () &#123;&#125;))</span><br><span class="line">                        .toList(),</span><br><span class="line">                  ))</span><br><span class="line">              .toList()),</span><br></pre></td></tr></table></figure>

<p>最终的效果就是个折叠列表了</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-c00e56d33cb9a1c9.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p><em>该部分代码查看 <code>expansion_tile_main.dart</code> 文件</em></p>
<p>当然了，只要数据到位，别说两层折叠，三层，四层甚至更多层都能够实现，源码中有实现四层的 <code>demo</code>，这边就不贴代码了，有需要的小伙伴可以查看源码</p>
<h4 id="GridView"><a href="#GridView" class="headerlink" title="GridView"></a>GridView</h4><p>生成列表可以通过 <code>ListView</code> 来实现，那么同样，实现网格列表 <code>Flutter</code> 也提供了 <code>GridView</code> 来实现，实现 <code>GridView</code> 的方法也很多…我数了下，大概有 10 种..对你没看错，就是那么多，*(诶诶诶，别走啊…虽然方法有点多，但是，大同小异)*</p>
<h5 id="GridView-1"><a href="#GridView-1" class="headerlink" title="GridView"></a>GridView</h5><p><code>GridView</code> 需要一个 <code>gridDelegate</code>，<code>gridDelegate</code> 目前有两种</p>
<ol>
<li><code>SliverGridDelegateWithFixedCrossAxisCount</code> 看命名就知道，值固定数量的，这个数量是只单排的数量</li>
<li><code>SliverGridDelegateWithMaxCrossAxisExtent</code> 这个是设置最大宽度&#x2F;高度，在这个值范围内取最大值，比如一排能给你排下 6 个，但是远不到设置的最大值，它绝不给你排 6 个</li>
</ol>
<p>那么接下来的使用就比较简单了</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GridViewDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 自行设置</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; letters = [ ..... ];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于区分网格单元</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Color&gt; colors = [Colors.red, Colors.green, Colors.blue, Colors.pink];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;GridView Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">        body: GridView(</span><br><span class="line">        gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">            crossAxisCount: <span class="number">5</span>, <span class="comment">// 单行的个数</span></span><br><span class="line">            mainAxisSpacing: <span class="number">10.0</span>, <span class="comment">// 同 scrollDirection 挂钩，item 之间在主轴方向的间隔</span></span><br><span class="line">            crossAxisSpacing: <span class="number">10.0</span>, <span class="comment">// item 之间在副轴方法的间隔</span></span><br><span class="line">            childAspectRatio: <span class="number">1.0</span> <span class="comment">// item 的宽高比</span></span><br><span class="line">            ),</span><br><span class="line">        <span class="comment">// 需要根据 index 设置不同背景色，所以使用 List.generate，如果不设置背景色，也可用 iterable.map().toList</span></span><br><span class="line">        children: <span class="built_in">List</span>.generate(</span><br><span class="line">            letters.length,</span><br><span class="line">            (index) =&gt; Container(</span><br><span class="line">                  alignment: Alignment.center,</span><br><span class="line">                  child: Text(letters[index]),</span><br><span class="line">                  color: colors[index % <span class="number">4</span>],</span><br><span class="line">                )),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关键地方已经添加了注释，跑下运行效果</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-4fcbc01a60f02eb2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/345/format/webp" width="200" height="350" align="center"/>

<p>接下来换一种 <code>delegate</code> 试试效果，当然这个最大值可以根据个人喜好来设置</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">body: GridView(</span><br><span class="line">       <span class="comment">// 通过设置 `maxCrossAxisExtent` 来指定最大的宽度，在这个值范围内，会选取相对较大的值</span></span><br><span class="line">       gridDelegate: SliverGridDelegateWithMaxCrossAxisExtent(</span><br><span class="line">           maxCrossAxisExtent: <span class="number">60.0</span>, crossAxisSpacing: <span class="number">10.0</span>, mainAxisSpacing: <span class="number">10.0</span>, childAspectRatio: <span class="number">1.0</span>),</span><br><span class="line">       children: <span class="built_in">List</span>.generate(</span><br><span class="line">           letters.length,</span><br><span class="line">           (index) =&gt; Container(</span><br><span class="line">                 alignment: Alignment.center,</span><br><span class="line">                 child: Text(letters[index]),</span><br><span class="line">                 color: colors[index % <span class="number">4</span>],</span><br><span class="line">               )),</span><br><span class="line">     )</span><br></pre></td></tr></table></figure>

<p>最后效果：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-70145635ae27bf9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/344/format/webp" width="200" height="350" align="center"/>

<p>为了方便写法呢，<code>Flutter</code> 对以上的两种方式进行了封装，省略了 <code>delegate</code></p>
<h5 id="GridView-count-x2F-GridView-extent"><a href="#GridView-count-x2F-GridView-extent" class="headerlink" title="GridView.count&#x2F;GridView.extent"></a>GridView.count&#x2F;GridView.extent</h5><p>直接看下如何修改</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这种情况简化了 `GridView` 使用 `SliverGridDelegateWithFixedCrossAxisCount` 代理的方法</span></span><br><span class="line">body: GridView.count(</span><br><span class="line">         crossAxisSpacing: <span class="number">10.0</span>,</span><br><span class="line">         mainAxisSpacing: <span class="number">10.0</span>,</span><br><span class="line">         childAspectRatio: <span class="number">1.0</span>,</span><br><span class="line">         crossAxisCount: <span class="number">5</span>,</span><br><span class="line">         childAspectRatio: <span class="number">2.0</span>,</span><br><span class="line">         children: <span class="built_in">List</span>.generate(</span><br><span class="line">             letters.length,</span><br><span class="line">             (index) =&gt; Container(</span><br><span class="line">                   alignment: Alignment.center,</span><br><span class="line">                   color: colors[index % <span class="number">4</span>],</span><br><span class="line">                   child: Text(letters[index]),</span><br><span class="line">                 ))),</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这种情况简化了 `GridView` 使用 `SliverGridDelegateWithMaxCrossAxisExtent` 代理的方法</span></span><br><span class="line">   body: GridView.extent(</span><br><span class="line">       crossAxisSpacing: <span class="number">10.0</span>,</span><br><span class="line">       mainAxisSpacing: <span class="number">10.0</span>,</span><br><span class="line">       childAspectRatio: <span class="number">1.0</span>,</span><br><span class="line">       maxCrossAxisExtent: <span class="number">60.0</span>,</span><br><span class="line">       children: <span class="built_in">List</span>.generate(</span><br><span class="line">           letters.length,</span><br><span class="line">               (index) =&gt;</span><br><span class="line">               Container(</span><br><span class="line">                 alignment: Alignment.center,</span><br><span class="line">                 color: colors[index % <span class="number">4</span>],</span><br><span class="line">                 child: Text(letters[index]),</span><br><span class="line">               ))),</span><br></pre></td></tr></table></figure>

<p>运行的效果入和前面的相同</p>
<h5 id="GridView-custom"><a href="#GridView-custom" class="headerlink" title="GridView.custom"></a>GridView.custom</h5><p>这种生成方式，比 <code>GridView</code> 多了一个 <code>childrenDelegate</code>，<code>childrenDelegate</code> 主要分为两种，一种是通过 <code>IndexedWidgetBuilder</code> 来构建 <code>item</code> 的 <code>SliverChildBuilderDelegate</code>，还有一种是通过 <code>List</code> 来构建 <code>item</code> 的 <code>SliverChildListDelegate</code>，所以…这边直接有 4 中生成方式，当然，我们只需要了解 <code>childrenDelegate</code> 如何使用即可</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">body: GridView.custom(</span><br><span class="line">         gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">             crossAxisCount: <span class="number">5</span>, mainAxisSpacing: <span class="number">10.0</span>, </span><br><span class="line">             crossAxisSpacing: <span class="number">10.0</span>, childAspectRatio: <span class="number">1.0</span>),</span><br><span class="line">         <span class="comment">// item 通过 delegate 来生成，内部实现还是 `IndexedWidgetBuilder`</span></span><br><span class="line">         childrenDelegate: SliverChildBuilderDelegate(</span><br><span class="line">             (_, index) =&gt; Container(</span><br><span class="line">                   alignment: Alignment.center,</span><br><span class="line">                   color: colors[index % <span class="number">4</span>],</span><br><span class="line">                   child: Text(letters[index]),</span><br><span class="line">                 ),</span><br><span class="line">             childCount: letters.length)),</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">body: GridView.custom(</span><br><span class="line">         gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">             crossAxisCount: <span class="number">5</span>, mainAxisSpacing: <span class="number">10.0</span>, </span><br><span class="line">             crossAxisSpacing: <span class="number">10.0</span>, childAspectRatio: <span class="number">1.0</span>),</span><br><span class="line">         <span class="comment">// 内部通过返回控件列表实现</span></span><br><span class="line">         childrenDelegate: SliverChildListDelegate(</span><br><span class="line">           <span class="built_in">List</span>.generate(</span><br><span class="line">               letters.length,</span><br><span class="line">               (index) =&gt; Container(</span><br><span class="line">                     child: Text(letters[index]),</span><br><span class="line">                     alignment: Alignment.center,</span><br><span class="line">                     color: colors[index % <span class="number">4</span>],</span><br><span class="line">                   )),</span><br><span class="line">         )),</span><br></pre></td></tr></table></figure>

<p>运行效果也同上面，不多帖了。</p>
<h5 id="GridView-builder"><a href="#GridView-builder" class="headerlink" title="GridView.builder"></a>GridView.builder</h5><p>前面介绍的方法中，生成 <code>item</code> 的方式基本上是通过 <code>List</code> 进行转换的，在 <code>custom</code> 提到了 <code>IndexWidgetBuilder</code> 的生成方式，当然，在 <code>ListView</code> 的时候也用到了这种生成方式，当然 <code>GridView</code> 也有啊，要「雨露均沾」你说是吧</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过 `IndexedWidgetBuilder` 来构建 item，别的参数同上</span></span><br><span class="line">      body: GridView.builder(</span><br><span class="line">          <span class="comment">// 这里又需要分两种 `gridDelegate`</span></span><br><span class="line">          gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">              crossAxisCount: <span class="number">5</span>, crossAxisSpacing: <span class="number">10.0</span>, mainAxisSpacing: <span class="number">10.0</span>, childAspectRatio: <span class="number">1.0</span>),</span><br><span class="line">          itemCount: letters.length,</span><br><span class="line">          itemBuilder: (_, index) =&gt;</span><br><span class="line">              Container(color: colors[index % <span class="number">4</span>], child: Text(letters[index]), alignment: Alignment.center)),</span><br></pre></td></tr></table></figure>

<p>到这 10 种方式就说完了。终于可以歇一口气了。</p>
<p><em>该部分代码查看 <code>gridview_main.dart</code> 文件</em></p>
<h4 id="CustomScrollView"><a href="#CustomScrollView" class="headerlink" title="CustomScrollView"></a>CustomScrollView</h4><p>在平时的开发中，应该会遇到这么种情况，头部是一个 <code>GridView</code> 接下来拼接一些别的部件，然后再拼接一个列表，例如下图</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-2522ab8b726c0bb9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/344/format/webp" width="200" height="350" align="center"/>

<p>因为 <code>GridView</code>  和 <code>ListView</code> 亮着都是可滑动的部件，直接拼接肯定会有「滑动冲突」，所以 <code>Flutter</code> 就提供了一个粘合剂，<code>CustomScrollView</code>，那么 <code>Flutter</code> 如何实现呢，因为会涉及到 <code>Sliver</code> 系列部件，所以这边先看下大概的代码，下节会补充 <code>Sliver</code> 系列部件的内容</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomScrollDemoPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 这边用的 A-Z 字母</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; letters = [ ..... ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Color&gt; colors = [Colors.red, Colors.green, Colors.blue, Colors.pink, Colors.yellow, Colors.deepPurple];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;CustomScrollDemo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: CustomScrollView(</span><br><span class="line">        <span class="comment">// 这里需要传入 `Sliver` 部件，下节课填坑</span></span><br><span class="line">        slivers: &lt;Widget&gt;[</span><br><span class="line">          <span class="comment">// SliverGrid 实现同 GridView 实现方式一样</span></span><br><span class="line">          <span class="comment">// 同样 SliverGrid 有提供 `count`, `entent` 方法便于快速生成 SliverGrid</span></span><br><span class="line">          SliverGrid(</span><br><span class="line">              delegate: SliverChildBuilderDelegate(</span><br><span class="line">                  (_, index) =&gt; InkWell(</span><br><span class="line">                        child: Image.asset(<span class="string">&#x27;images/ali.jpg&#x27;</span>),</span><br><span class="line">                        onTap: () &#123;&#125;,</span><br><span class="line">                      ),</span><br><span class="line">                  childCount: <span class="number">8</span>),</span><br><span class="line">              gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">                  crossAxisCount: <span class="number">4</span>, mainAxisSpacing: <span class="number">10.0</span>, crossAxisSpacing: <span class="number">10.0</span>)),</span><br><span class="line">          <span class="comment">// 这里下节讲</span></span><br><span class="line">          SliverToBoxAdapter(</span><br><span class="line">              child: Container(</span><br><span class="line">                  color: Colors.black12,</span><br><span class="line">                  margin: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">10.0</span>),</span><br><span class="line">                  child: Column(children: &lt;Widget&gt;[</span><br><span class="line">                    Divider(height: <span class="number">2.0</span>, color: Colors.black54),</span><br><span class="line">                    Stack(</span><br><span class="line">                      alignment: Alignment.center,</span><br><span class="line">                      children: &lt;Widget&gt;[</span><br><span class="line">                        Image.asset(<span class="string">&#x27;images/app_bar_hor.jpg&#x27;</span>, fit: BoxFit.cover),</span><br><span class="line">                        Text(<span class="string">&#x27;我是一些别的东西..例如广告&#x27;</span>, textScaleFactor: <span class="number">1.5</span>, style: TextStyle(color: Colors.red))</span><br><span class="line">                      ],</span><br><span class="line">                    ),</span><br><span class="line">                    Divider(height: <span class="number">2.0</span>, color: Colors.black54),</span><br><span class="line">                  ], mainAxisAlignment: MainAxisAlignment.spaceBetween),</span><br><span class="line">                  alignment: Alignment.center)),</span><br><span class="line">          <span class="comment">// SliverFixedExtentList 实现同 List.custom 实现类似</span></span><br><span class="line">          SliverFixedExtentList(</span><br><span class="line">              delegate: SliverChildBuilderDelegate(</span><br><span class="line">                  (_, index) =&gt; InkWell(</span><br><span class="line">                        child: Container(</span><br><span class="line">                          child: Text(letters[index] * <span class="number">10</span>,</span><br><span class="line">                              style: TextStyle(color: colors[index % colors.length], letterSpacing: <span class="number">2.0</span>),</span><br><span class="line">                              textScaleFactor: <span class="number">1.5</span>),</span><br><span class="line">                          alignment: Alignment.center,</span><br><span class="line">                        ),</span><br><span class="line">                        onTap: () &#123;&#125;,</span><br><span class="line">                      ),</span><br><span class="line">                  childCount: letters.length),</span><br><span class="line">              itemExtent: <span class="number">60.0</span>)</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>该部分代码查看 <code>custom_scroll_main.dart</code> 文件</em></p>
<p>滑动部件其实还有好几个，但是以上介绍的在平时开发过程中够用了，如果后期发现还需要别的部件，我会继续补上。在结束前，我们再说下如何通过 <code>ScrollController</code> 来控制 <code>Scrollable</code> 的滚动位置。例如我们需要实现，当滚动的距离大于一定距离的时候显示一个回到顶部的按钮，有了 <code>ScrollController</code> 就能够非常方便的实现</p>
<h4 id="ScrollController"><a href="#ScrollController" class="headerlink" title="ScrollController"></a>ScrollController</h4><p>因为需要根据滑动的距离显示回到顶部按钮，那么就需要通过一个状态位来控制按钮显隐</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScrollControllerDemoPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _ScrollControllerDemoPageState createState() =&gt; _ScrollControllerDemoPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_ScrollControllerDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">ScrollControllerDemoPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> _scrollController = ScrollController();</span><br><span class="line">  <span class="keyword">var</span> _showBackTop = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对 scrollController 进行监听</span></span><br><span class="line">    _scrollController.addListener(() &#123;</span><br><span class="line">      <span class="comment">// _scrollController.position.pixels 获取当前滚动部件滚动的距离</span></span><br><span class="line">      <span class="comment">// window.physicalSize.height 获取屏幕高度</span></span><br><span class="line">      <span class="comment">// 当滚动距离大于 800 后，显示回到顶部按钮</span></span><br><span class="line">      setState(() =&gt; _showBackTop = _scrollController.position.pixels &gt;= <span class="number">800</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// 记得销毁对象</span></span><br><span class="line">    _scrollController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;ScrollController Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: ListView(</span><br><span class="line">        controller: _scrollController,</span><br><span class="line">        children: <span class="built_in">List</span>.generate(</span><br><span class="line">            <span class="number">20</span>, (index) =&gt; Container(height: <span class="number">50.0</span>, alignment: Alignment.center, child: Text(<span class="string">&#x27;Item <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>&#x27;</span>))),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: _showBackTop <span class="comment">// 当需要显示的时候展示按钮，不需要的时候隐藏，设置 null</span></span><br><span class="line">          ? FloatingActionButton(</span><br><span class="line">              onPressed: () &#123;</span><br><span class="line">                <span class="comment">// scrollController 通过 animateTo 方法滚动到某个具体高度</span></span><br><span class="line">                <span class="comment">// duration 表示动画的时长，curve 表示动画的运行方式，flutter 在 Curves 提供了许多方式</span></span><br><span class="line">                _scrollController.animateTo(<span class="number">0.0</span>, duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">500</span>), curve: Curves.decelerate);</span><br><span class="line">              &#125;,</span><br><span class="line">              child: Icon(Icons.vertical_align_top),</span><br><span class="line">            )</span><br><span class="line">          : <span class="keyword">null</span>,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后的效果图</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-3752cd0adad5ac5a.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p>好啦，这节就到这，下节继续填这节课留下的坑。</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/19/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-07/" data-id="cl0ukmc2n000gpn1g0xeldfxp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-06" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/17/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-06/" class="article-date">
  <time datetime="2019-03-17T12:11:20.000Z" itemprop="datePublished">2019-03-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/17/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-06/">Flutter Guide(06) -- 了解 Flutter 的界面交互</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上一节撸了个界面，虽然比较简单，但是把前面讲的知识串联了下，但是界面之间的跳转一直没说，这节就讲下 <code>Flutter</code> 中的「路由」来管理界面。</p>
<h4 id="Navigator"><a href="#Navigator" class="headerlink" title="Navigator"></a>Navigator</h4><p><code>Flutter</code> 通过 <code>Navigator</code>  来进行页面之间的跳转，分为 <code>push</code> 系列和 <code>pop</code> 系列操作，带 <code>push</code> 方法为入栈操作，带 <code>pop</code> 方法为出栈操作。<code>Navigator</code> 的 <code>push</code> 方法分两类，一类是带 <code>Name</code> 的，需要在 <code>MaterialApp</code> 下将 <code>routers</code> 属性进行注册，否则将会找不到该路由，还有一个是不带 <code>Name</code> 的，可以通过 <code>Router</code> 直接跳转。</p>
<p>说那么多相信还不如直接上代码和图来的更直接。因为需要展示所有的跳转至少需要 3 个页面，所以我们创建最简单的三个界面，通过文字来区别不同的页面，因为需要调用带有 <code>Name</code> 的方法，所以需要先在 <code>MaterialApp</code> 对路由进行注册。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">&#x27;Flutter Learning Demo&#x27;</span>,</span><br><span class="line">      <span class="comment">// 在这里注册路由，关联 name 和界面</span></span><br><span class="line">      <span class="comment">// &#x27;/&#x27; 表示根页面，也就是 home 所对应的页面，这边就不需要配置 home 属性了</span></span><br><span class="line">      routes: &#123;<span class="string">&#x27;/&#x27;</span>: (_) =&gt; APage(), <span class="string">&#x27;/page_b&#x27;</span>: (_) =&gt; BPage(), <span class="string">&#x27;/page_c&#x27;</span>: (_) =&gt; CPage()&#125;,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="language-markdown">Page A，Button 的跳转事件等会进行修改，目前先空着</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">APage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Page A&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(child: RaisedButton(onPressed: () &#123;&#125;, child: Text(<span class="string">&#x27;To Page B&#x27;</span>))),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="language-markdown">Page B</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Page B&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">          child: Column(mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[</span><br><span class="line">        RaisedButton(onPressed: () &#123;&#125;, child: Text(<span class="string">&#x27;To Page C&#x27;</span>)),</span><br><span class="line">        RaisedButton(onPressed: () &#123;&#125;, child: Text(<span class="string">&#x27;Back Page A&#x27;</span>))</span><br><span class="line">      ])),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="language-markdown">Page C</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Page C&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">          child: Column(</span><br><span class="line">              mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">              children: &lt;Widget&gt;[RaisedButton(onPressed: () &#123;&#125;, child: Text(<span class="string">&#x27;Back Last Page&#x27;</span>))])),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="push-x2F-pushNamed-方式跳转"><a href="#push-x2F-pushNamed-方式跳转" class="headerlink" title="push &#x2F; pushNamed 方式跳转"></a>push &#x2F; pushNamed 方式跳转</h5><p>我们在 <code>APage</code> 的 <code>RaiseButton</code> 的 <code>onPressed</code> 方法加入如下代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.push(context, MaterialPageRoute(builder: (_) =&gt; BPage()));</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushNamed(context, <span class="string">&#x27;/page_b&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>效果相同。跳转后，可以发现，在 <code>BPage</code> 的 <code>AppBar</code> 上有个返回按钮，点击可以返回 <code>APage</code> ，那么也就是说通过 <code>push</code> 或者 <code>pushNamed</code> 方式跳转的时候，界面堆栈的变化是直接在原来的堆栈上添加一个新的 <code>page</code> </p>
<p><strong>为了凸显堆栈的变化，所以绘制的图中，会比使用的实际页面多一个，下图同</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/2888797-e8fe3476c02639fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/611/format/webp" alt="Navigator_push.png"></p>
<h5 id="pushReplacement-x2F-pushReplacementNamed-x2F-popAndPushNamed"><a href="#pushReplacement-x2F-pushReplacementNamed-x2F-popAndPushNamed" class="headerlink" title="pushReplacement &#x2F; pushReplacementNamed &#x2F; popAndPushNamed"></a>pushReplacement &#x2F; pushReplacementNamed &#x2F; popAndPushNamed</h5><p>将 <code>APage</code> 中的跳转方式进行替换</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushReplacement(context, MaterialPageRoute(builder: (_) =&gt; BPage()));</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushReplacementNamed(context, <span class="string">&#x27;/page_b&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果是第一个界面跳转到下个界面，勿用，`BPage` 会显示返回按钮，但是点击后，界面会变黑</span></span><br><span class="line"><span class="comment">// 因为 `APage` 已经不在堆栈中了，点击后堆栈就没有 `Page` 了，所以界面变黑</span></span><br><span class="line">Navigator.popAndPushNamed(context, <span class="string">&#x27;/page_b&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>效果相同，跳转后，可以发现 <code>BPage</code> 的返回按钮消失了，消失了，消失了，我们可以试下点击返回按键，发现 <code>App</code> 直接退出了，也就是说，<code>BPage</code> 替代了 <code>APage</code> 在堆栈中的位置。那么堆栈的变化图就是这样的</p>
<p><img src="https://upload-images.jianshu.io/upload_images/2888797-5129c0873f1330af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/589/format/webp" alt="Navigator_pushReplacement.png"></p>
<h5 id="pushAndRemoveUntil-x2F-pushNamedAndRemoveUntil"><a href="#pushAndRemoveUntil-x2F-pushNamedAndRemoveUntil" class="headerlink" title="pushAndRemoveUntil &#x2F; pushNamedAndRemoveUntil"></a>pushAndRemoveUntil &#x2F; pushNamedAndRemoveUntil</h5><h6 id="CASE-1"><a href="#CASE-1" class="headerlink" title="CASE 1"></a>CASE 1</h6><p>这个跳转方式需要通过 <code>CPage</code> 来协助完成，将 <code>APage</code> 的跳转方式修改为 <code>push</code> 方式，然后在 <code>BPage</code> 的第一个按钮加入如下代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushAndRemoveUntil(context, </span><br><span class="line">                   MaterialPageRoute(builder: (_) =&gt; CPage()), (Route router) =&gt; <span class="keyword">false</span>);</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushNamedAndRemoveUntil(context, <span class="string">&#x27;/page_c&#x27;</span>, (Route router) =&gt; <span class="keyword">false</span>);</span><br></pre></td></tr></table></figure>

<p>效果相同，点击 <code>BPage</code> 的跳转 <code>CPage</code> 按钮后，界面来到 <code>CPage</code>，然后发现还是没有返回按钮，没有返回按钮，没有返回按钮，点击下返回按键，然后发现 <code>App</code> 直接退出了，退出了，退出了，那么堆栈变化如图</p>
<p><img src="https://upload-images.jianshu.io/upload_images/2888797-3e649f0af78d75bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/599/format/webp" alt="Navigator_pushAndRemoveUnit1.png"></p>
<h6 id="CASE-2"><a href="#CASE-2" class="headerlink" title="CASE 2"></a>CASE 2</h6><p>你以为这两个方法只是为了把堆栈都清空吗，那就太图样图森破了，这边展示另一种。修改跳转的代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushAndRemoveUntil(context, </span><br><span class="line">				MaterialPageRoute(builder: (_) =&gt; CPage()), ModalRoute.withName(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushNamedAndRemoveUntil(context, <span class="string">&#x27;/page_c&#x27;</span>, ModalRoute.withName(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>点击跳转 <code>CPage</code> 以后，发现返回按钮又回来了…就这么回来了…只是修改了一个参数，点击返回按钮，又回到了 <code>APage</code>，你可以在 <code>APage</code> 跳转 <code>BPage</code> 中加入<code>DPage</code> <code>EPage</code> 等等更多的界面，只要保证 <code>BPage</code> 跳转 <code>CPage</code> 的方式不变，点击 <code>CPage</code> 的返回按钮，又回到 <code>APage</code> 了，所以…堆栈的变化图如下</p>
<p><img src="https://upload-images.jianshu.io/upload_images/2888797-d32890e60fa05ac0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/602/format/webp" alt="Navigator_pushAndRemoveUnit2.png"></p>
<h6 id="SUMMARY"><a href="#SUMMARY" class="headerlink" title="SUMMARY"></a>SUMMARY</h6><p>为什么会这样变化呢，还记得在 <code>MaterialApp</code> 中注册的 <code>router</code> 么，<code>APage</code> 的 <code>name</code> 对应的为 <code>&#39;/&#39;</code>，也就是说，该方法会把堆栈中在 <code>ModalRoute.withName</code> 所对应的 page 上的所有都 pop 出堆栈，如果把参数换成 <code>/page_b</code>，然后在跳转 <code>CPage</code> 之前加入更多的界面，点击 <code>CPage</code> 的返回按钮，就会回到 <code>BPage</code></p>
<h6 id="QUESTION"><a href="#QUESTION" class="headerlink" title="QUESTION"></a>QUESTION</h6><p>这边再提个小问题，有页面 A，B，C，D，其路由的 name 分别为 ‘&#x2F;‘，’page_b’，’page_c’，’page_d’，启动顺序为 A -&gt; B -&gt; C -&gt; C -&gt; D，那么在 D 页面使用 </p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pushNamedAndRemoveUntil(context, <span class="string">&#x27;/page_c&#x27;</span>, ModalRoute.withName(<span class="string">&#x27;/page_c&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>那么堆栈最后剩下的页面是 <code>ABCC</code> 还是<code>ABC</code> 呢？答案会在最后公布，小伙伴可以先自己尝试着实现。 </p>
<h5 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h5><p>在 <code>BPage</code> 的第二个按钮中加入 <code>pop</code> 操作</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.pop(context);</span><br></pre></td></tr></table></figure>

<p>跳转到 <code>BPage</code> 后点击该按钮，界面回到 <code>APage</code>，那么堆栈的变化很明显了，如图</p>
<p><img src="https://upload-images.jianshu.io/upload_images/2888797-f57b9e4e8f220cd5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/573/format/webp" alt="Navigator_pop.png"></p>
<h5 id="popUntil"><a href="#popUntil" class="headerlink" title="popUntil"></a>popUntil</h5><p>这个方法还需要借助 <code>CPage</code> ，在 <code>CPage</code> 的按钮中加入</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.popUntil(context, ModalRoute.withName(<span class="string">&#x27;/&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>点击返回按钮，界面跳过 <code>BPage</code> 回到了 <code>APage</code>，解释同 <code>pushAndRemoveUntil</code> 那么堆栈的变化也显而易见咯</p>
<p><img src="https://upload-images.jianshu.io/upload_images/2888797-0f8a0cf16871e5b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/589/format/webp" alt="Navigator_popUntil.png"></p>
<h4 id="Navigator-传值"><a href="#Navigator-传值" class="headerlink" title="Navigator 传值"></a>Navigator 传值</h4><h6 id="CASE-1-传值给下个界面"><a href="#CASE-1-传值给下个界面" class="headerlink" title="CASE 1 传值给下个界面"></a>CASE 1 传值给下个界面</h6><p>修改下 <code>BPage</code> 和 <code>APage</code> 的按钮点击事件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> message;</span><br><span class="line"></span><br><span class="line">  BPage(&#123;Key key, <span class="meta">@required</span> <span class="keyword">this</span>.message&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;passed value: <span class="subst">$message</span>&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      <span class="comment">// 省略相同代码</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// APage 跳转事件</span></span><br><span class="line">Navigator.push(context, MaterialPageRoute(builder: </span><br><span class="line">                                          (_) =&gt; BPage(message: <span class="string">&#x27;Message From Page A&#x27;</span>)));</span><br></pre></td></tr></table></figure>

<p>点击 <code>APage</code> 可以查看控制台有输出 </p>
<p><code>2019-03-17 00:04:06.854 12868-12888/com.kuky.demo.flutterartsdemosapp I/flutter: passed value: Message From Page A</code> </p>
<p>也就是成功把值传递过来了。<strong>但是，需要传递参数的话，之前在 <code>MaterialApp</code> 下注册的路由就需要去除了</strong>。</p>
<h6 id="CASE-2-传值给上个界面"><a href="#CASE-2-传值给上个界面" class="headerlink" title="CASE 2 传值给上个界面"></a>CASE 2 传值给上个界面</h6><p>这边可以查看下 <code>pop</code> 方法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@optionalTypeArgs</span></span><br><span class="line">  <span class="comment">// pop 可以传入一个可选参数 result，这个 result 也就是回传给上个页面的参数值了</span></span><br><span class="line">  <span class="keyword">static</span> <span class="built_in">bool</span> pop&lt;T <span class="keyword">extends</span> <span class="built_in">Object</span>&gt;(BuildContext context, [ T result ]) &#123;</span><br><span class="line">    <span class="keyword">return</span> Navigator.of(context).pop&lt;T&gt;(result);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>既然知道 <code>pop</code> 如何传递值给上个界面，那么如何在上个界面接收这个参数呢，还是看下 <code>push</code> 方法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@optionalTypeArgs</span></span><br><span class="line">  <span class="keyword">static</span> Future&lt;T&gt; push&lt;T <span class="keyword">extends</span> <span class="built_in">Object</span>&gt;(BuildContext context, Route&lt;T&gt; route) &#123;</span><br><span class="line">    <span class="keyword">return</span> Navigator.of(context).push(route);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="meta">@optionalTypeArgs</span></span><br><span class="line">  Future&lt;T&gt; push&lt;T <span class="keyword">extends</span> <span class="built_in">Object</span>&gt;(Route&lt;T&gt; route) &#123;</span><br><span class="line">    <span class="comment">// ...省略无关代码</span></span><br><span class="line">    <span class="comment">// 这边返回一个 Future 值，`pop` 所传递的值会在这边返回</span></span><br><span class="line">    <span class="keyword">return</span> route.popped;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="language-markdown">The future completes with the value given to [Navigator.pop], if any.</span></span></span><br><span class="line">Future&lt;T&gt; <span class="keyword">get</span> popped =&gt; _popCompleter.future;</span><br></pre></td></tr></table></figure>

<p>官方的注释非常明白的指出，会在 <code>Future</code> 中携带 <code>pop</code> 传递的参数，那么我们对 <code>APage</code> 跳转 <code>BPage</code> 以及 <code>BPage</code> 返回 <code>APage</code> 的逻辑进行修改</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">APage</span></span></span><br><span class="line">Navigator.push(context, MaterialPageRoute(builder: (_) </span><br><span class="line">                                          =&gt; BPage(message: <span class="string">&#x27;Message From Page A&#x27;</span>)))</span><br><span class="line">                    .then((value) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;BACK MESSAGE =&gt; <span class="subst">$value</span>&#x27;</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">BPage</span></span></span><br><span class="line">Navigator.pop(context, <span class="string">&#x27;Message back to PageA From BPage&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>点击返回后，能够在控制台发现有如下输入</p>
<p><code>2019-03-17 16:35:53.820 13417-13442/com.kuky.demo.flutterartsdemosapp I/flutter: BACK MESSAGE =&gt; Message back to PageA From BPage</code></p>
<p>上个页面成功接收到下个页面回传的数据。</p>
<h6 id="CASE-3-通过系统返回按钮传值"><a href="#CASE-3-通过系统返回按钮传值" class="headerlink" title="CASE 3 通过系统返回按钮传值"></a>CASE 3 通过系统返回按钮传值</h6><p>在 <code>CASE 2</code> 情况下，通过按钮对返回事件进行监听，那加入我们需求没有这个按钮，只能通过系统默认的返回按钮，或者物理返回按键，那该如何传值呢，这里就需要用 <code>WillpopScope</code> 对系统的返回按钮进行监听。我们对 <code>CPage</code> 做下修改，在 <code>Scaffold</code> 外面包裹一个 <code>WillpopScope</code> </p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> WillPopScope(</span><br><span class="line">        child: Scaffold(</span><br><span class="line">          appBar: AppBar(</span><br><span class="line">            title: Text(<span class="string">&#x27;Page C&#x27;</span>),</span><br><span class="line">          ),</span><br><span class="line">          body: Center(</span><br><span class="line">              child: Column(mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[</span><br><span class="line">            RaisedButton(</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line">                  Navigator.popUntil(context, ModalRoute.withName(<span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">                &#125;,</span><br><span class="line">                child: Text(<span class="string">&#x27;Back Last Page&#x27;</span>))</span><br><span class="line">          ])),</span><br><span class="line">        ),</span><br><span class="line">        <span class="comment">// 这里对系统返回按钮做监听..</span></span><br><span class="line">        <span class="comment">// 如果返回的是 `true` 则相当于 `pop` 操作，返回 `false` 则只执行上一步的 `pop` 操作</span></span><br><span class="line">        <span class="comment">// 例如双击返回退出，也是通过 `WillpopScope` 来进行监听</span></span><br><span class="line">        onWillPop: () <span class="keyword">async</span> &#123;</span><br><span class="line">          Navigator.pop(context, <span class="string">&#x27;Hello~&#x27;</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过返回按钮，<code>BPage</code> 会成功收到从 <code>CPage</code> 返回的 <code>Hello~</code> 值</p>
<p><em>以上代码查看 <code>router_main.dart</code> 文件</em></p>
<h4 id="路由切换动画"><a href="#路由切换动画" class="headerlink" title="路由切换动画"></a>路由切换动画</h4><p>假如说我们不想用系统自带的切换动画，需要弄一些比较酷炫的效果该怎么办，那就需要用到自定义路由切换动画了。直接修改 <code>BPage</code> 跳转 <code>CPage</code> 的代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Navigator.push(</span><br><span class="line">    context,</span><br><span class="line">    PageRouteBuilder(</span><br><span class="line">    	<span class="comment">// 返回目标页面</span></span><br><span class="line">        pageBuilder: (context, anim, _) =&gt; CPage(),</span><br><span class="line">        <span class="comment">// 切换动画的切换时长</span></span><br><span class="line">        transitionDuration: <span class="built_in">Duration</span>(milliseconds: <span class="number">500</span>),</span><br><span class="line">        <span class="comment">// 切换动画的切换效果，系统自带的常用 Transition</span></span><br><span class="line">        <span class="comment">// ScaleTransition: 缩放  SlideTransition: 滑动</span></span><br><span class="line">        <span class="comment">// RotationTransition: 旋转  FadeTransition: 透明度</span></span><br><span class="line">        transitionsBuilder: (context, anim, _, child) =&gt; ScaleTransition(</span><br><span class="line">        	  <span class="comment">// Tween 是 flutter 的补间动画，等讲到动画的时候再提吧，这边先记住这么使用</span></span><br><span class="line">              scale: Tween(begin: <span class="number">0.0</span>, end: <span class="number">1.0</span>).animate(anim),</span><br><span class="line">              <span class="comment">// 这个值必须记得要传，否则会不显示界面</span></span><br><span class="line">              child: child,</span><br><span class="line">            )));</span><br></pre></td></tr></table></figure>

<p>当再次点击跳转的时候，切换的动画就有开始自带的平滑效果变成缩放效果了。那如果要实现多个动画呢，例如边缩放，边改变透明度，也很容易实现，只需要将 <code>child</code> 替换成 <code>Transition</code> 即可</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Navigator.push(</span><br><span class="line">    context,</span><br><span class="line">    PageRouteBuilder(</span><br><span class="line">        pageBuilder: (context, anim, _) =&gt; CPage(),</span><br><span class="line">        transitionDuration: <span class="built_in">Duration</span>(milliseconds: <span class="number">500</span>),</span><br><span class="line">        transitionsBuilder: (context, anim, _, child) =&gt; ScaleTransition(</span><br><span class="line">              scale: Tween(begin: <span class="number">0.0</span>, end: <span class="number">1.0</span>).animate(anim),</span><br><span class="line">              <span class="comment">// 替换即可，如果要加入更多的动画，替换 `child` 属性就可以了</span></span><br><span class="line">              child: FadeTransition(</span><br><span class="line">                opacity: Tween(begin: <span class="number">0.0</span>, end: <span class="number">1.0</span>).animate(anim),</span><br><span class="line">                child: child,</span><br><span class="line">              ),</span><br><span class="line">            )));</span><br></pre></td></tr></table></figure>

<p>当然，为了方便重复利用，需要进行封装，例如我们要封装上面的缩放动画效果</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScalePageRoute</span> <span class="keyword">extends</span> <span class="title">PageRouteBuilder</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> Widget widget;</span><br><span class="line"></span><br><span class="line">  ScalePageRoute(<span class="keyword">this</span>.widget)</span><br><span class="line">      : <span class="keyword">super</span>(</span><br><span class="line">            transitionDuration: <span class="built_in">Duration</span>(milliseconds: <span class="number">500</span>),</span><br><span class="line">            pageBuilder: (context, anim, _) =&gt; widget,</span><br><span class="line">            transitionsBuilder: (context, anim, _, child) =&gt; ScaleTransition(</span><br><span class="line">                  scale: Tween(begin: <span class="number">0.0</span>, end: <span class="number">1.0</span>).animate(anim),</span><br><span class="line">                  child: child,</span><br><span class="line">                ));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后直接在 <code>Navigator</code> 跳转的时候调用该 <code>Route</code> 就可以了</p>
<p><em>该部分代码查看 <code>custom_routes.dart</code> 文件</em></p>
<p>还记得我们之前写的 <code>demo</code> 都是单个文件写一个入口的吗，现在我们就可以写一个统一管理的页面，对这些界面进行管理了，这个工作就交给大家伙自己了，当然我也在源码做了修改，可以查看 <code>main.dart</code> 文件 </p>
<p>在前面有提出一个问题，这边公布下答案：堆栈中的页面应该为 <code>ABCC</code>。你答对没有呢~</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/17/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-06/" data-id="cl0ukmc2o000qpn1g4aaf3pb2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-05" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/16/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-05/" class="article-date">
  <time datetime="2019-03-16T11:55:07.000Z" itemprop="datePublished">2019-03-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/16/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-05/">Flutter Guide(05) -- 动手「撸」一个登录，注册界面</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前面提到基础部件的时候，忘了提输入内容处理部件，这里补上，然后顺带撸个实际的界面吧</p>
<h4 id="TextField"><a href="#TextField" class="headerlink" title="TextField"></a>TextField</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> TextField(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.controller, <span class="comment">// 定义一个 `TextEditingController` 实例，用来获取输入框内容等操作</span></span><br><span class="line">    <span class="keyword">this</span>.focusNode, <span class="comment">// 定义一个 `FocusNode` 实例，判断当前输入框是否获取到焦点等操作</span></span><br><span class="line">    <span class="keyword">this</span>.decoration = <span class="keyword">const</span> InputDecoration(), <span class="comment">// 输入框样式，包括提醒字样，hint 等等</span></span><br><span class="line">    TextInputType keyboardType, <span class="comment">// 输入文本类型，例如 数字，email 等等</span></span><br><span class="line">    <span class="keyword">this</span>.textInputAction, <span class="comment">// 键盘确认按钮的事件类型</span></span><br><span class="line">    <span class="keyword">this</span>.textCapitalization = TextCapitalization.none,</span><br><span class="line">    <span class="keyword">this</span>.style, <span class="comment">// 文字样式</span></span><br><span class="line">    <span class="keyword">this</span>.textAlign = TextAlign.start, <span class="comment">// 对齐方式</span></span><br><span class="line">    <span class="keyword">this</span>.textDirection, <span class="comment">// 文字方向</span></span><br><span class="line">    <span class="keyword">this</span>.autofocus = <span class="keyword">false</span>, <span class="comment">// 是否自动获取焦点</span></span><br><span class="line">    <span class="keyword">this</span>.obscureText = <span class="keyword">false</span>, <span class="comment">// 文字是否隐藏，多用于密码</span></span><br><span class="line">    <span class="keyword">this</span>.autocorrect = <span class="keyword">true</span>, </span><br><span class="line">    <span class="keyword">this</span>.maxLines = <span class="number">1</span>, <span class="comment">//</span></span><br><span class="line">    <span class="keyword">this</span>.maxLength, <span class="comment">// 最大长度</span></span><br><span class="line">    <span class="keyword">this</span>.maxLengthEnforced = <span class="keyword">true</span>, <span class="comment">// 设置最大长度后，输入内容超出后是否强制不给输入</span></span><br><span class="line">    <span class="keyword">this</span>.onChanged, <span class="comment">// 输入内容发生变化时候的回调</span></span><br><span class="line">    <span class="keyword">this</span>.onEditingComplete, <span class="comment">// 输入完毕的回调</span></span><br><span class="line">    <span class="keyword">this</span>.onSubmitted, <span class="comment">// 提交内容的回调</span></span><br><span class="line">    <span class="keyword">this</span>.inputFormatters, <span class="comment">// </span></span><br><span class="line">    <span class="keyword">this</span>.enabled, <span class="comment">// 是否可输入，false 不可输入</span></span><br><span class="line">    <span class="keyword">this</span>.cursorWidth = <span class="number">2.0</span>, <span class="comment">// 游标宽度</span></span><br><span class="line">    <span class="keyword">this</span>.cursorRadius, <span class="comment">// 游标半径</span></span><br><span class="line">    <span class="keyword">this</span>.cursorColor, <span class="comment">// 游标颜色</span></span><br><span class="line">    <span class="keyword">this</span>.keyboardAppearance, <span class="comment">// 该属性只在 iOS 设备有效</span></span><br><span class="line">    <span class="keyword">this</span>.scrollPadding = <span class="keyword">const</span> EdgeInsets.all(<span class="number">20.0</span>),</span><br><span class="line">    <span class="keyword">this</span>.enableInteractiveSelection,</span><br><span class="line">    <span class="keyword">this</span>.onTap, <span class="comment">// 点击事件</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>那么，简单的来个输入框示例吧，然后通过 <code>Text</code> 展示结果</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _HomePageState createState() =&gt; _HomePageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_HomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">HomePage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 可以传入初始值</span></span><br><span class="line">  TextEditingController _editController = TextEditingController();</span><br><span class="line">  FocusNode _editNode = FocusNode();</span><br><span class="line">  <span class="comment">// 保存按钮点击后的输入内容值</span></span><br><span class="line">  <span class="built_in">String</span> _content = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="comment">// 监听输入内容变化的内容值</span></span><br><span class="line">  <span class="built_in">String</span> _spyContent = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">// 当输入框获取到焦点或者失去焦点的时候回调用</span></span><br><span class="line">    _editNode.addListener(() &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&#x27;edit has focus? =&gt; <span class="subst">$&#123;_editNode.hasFocus&#125;</span>&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// 记得销毁，防止内存溢出</span></span><br><span class="line">    _editController.dispose();</span><br><span class="line">    _editNode.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Input Content&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Container(</span><br><span class="line">          padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">12.0</span>),</span><br><span class="line">          child: Column(</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              TextField(</span><br><span class="line">                controller: _editController,</span><br><span class="line">                focusNode: _editNode,</span><br><span class="line">                decoration: InputDecoration(</span><br><span class="line">                    icon: Icon(Icons.phone_iphone, color: Theme.of(context).primaryColor),</span><br><span class="line">                    labelText: <span class="string">&#x27;请输入手机号&#x27;</span>,</span><br><span class="line">                    helperText: <span class="string">&#x27;手机号&#x27;</span>,</span><br><span class="line">                    hintText: <span class="string">&#x27;手机号...在这儿输入呢&#x27;</span>),</span><br><span class="line">                keyboardType: TextInputType.number,</span><br><span class="line">                <span class="comment">// 输入类型为数字类型</span></span><br><span class="line">                textInputAction: TextInputAction.done,</span><br><span class="line">                style: TextStyle(color: Colors.redAccent, fontSize: <span class="number">18.0</span>),</span><br><span class="line">                textDirection: TextDirection.ltr,</span><br><span class="line">                maxLength: <span class="number">11</span>, <span class="comment">// 最大长度为 11</span></span><br><span class="line">                maxLengthEnforced: <span class="keyword">true</span>, <span class="comment">// 超过长度的不显示</span></span><br><span class="line">                onChanged: (v) &#123; <span class="comment">// 输入的内容发生改变会调用</span></span><br><span class="line">                  setState(() =&gt; _spyContent = v);</span><br><span class="line">                &#125;,</span><br><span class="line">                onSubmitted: (s) &#123; <span class="comment">// 点击确定按钮时候会调用</span></span><br><span class="line">                  setState(() =&gt; _spyContent = _editController.value.text);</span><br><span class="line">                &#125;,</span><br><span class="line">              ),</span><br><span class="line">              Padding(</span><br><span class="line">                  padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">8.0</span>),</span><br><span class="line">                  child: RaisedButton(</span><br><span class="line">                      onPressed: () &#123; </span><br><span class="line">                        <span class="comment">// 获取输入的内容</span></span><br><span class="line">                        setState(() =&gt; _content = _editController.value.text);</span><br><span class="line">                        <span class="comment">// 清理输入内容</span></span><br><span class="line">                        _editController.clear();</span><br><span class="line">                        setState(() =&gt; _spyContent = <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                      &#125;,</span><br><span class="line">                      child: Text(<span class="string">&#x27;获取输入内容&#x27;</span>))),</span><br><span class="line">              <span class="comment">// 展示输入的内容，点击按钮会显示</span></span><br><span class="line">              Text(_content.isNotEmpty ? <span class="string">&#x27;获取到输入内容: <span class="subst">$_content</span>&#x27;</span> : <span class="string">&#x27;还未获取到任何内容...&#x27;</span>),</span><br><span class="line">              Padding(</span><br><span class="line">                padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">8.0</span>),</span><br><span class="line">                <span class="comment">// 监听输入内容的变化，会跟随输入的内容进行改变</span></span><br><span class="line">                child: Text(<span class="string">&#x27;我是文字内容监听：<span class="subst">$_spyContent</span>&#x27;</span>),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          )),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这边需要提下的是 <code>setState</code> 方法，该方法只有 <code>StatefulWidget</code> 才有，当需要修改某个值的内容的时候，通过该方法进行修改，最后的效果图如下，当输入框文字发生变化的时候，监听的 <code>Text</code> 内容会随之改变，获取内容的 <code>Text</code> 当点击按钮了才发生变化</p>
<div align="center">
    <img src="https://upload-images.jianshu.io/upload_images/2888797-8958fcac51959736.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/344/format/webp" width="200" height="350"/>
    <img src="https://upload-images.jianshu.io/upload_images/2888797-639d3ed4ab16bb68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/345/format/webp" width="200" height="350"/>
</div>

<p><em>该部分代码查看 <code>text_field_main.dart</code> 文件</em></p>
<p>那么如果有个需求，在点击按钮的时候需要对输入的内容的合理性进行检测，当然可以通过 <code>TextEditingController</code> 的结果进行检测，但是还有个更加方便的方法，可以直接使用部件 <code>TextFormField</code> 来实现，不过需要我们在外层加一个 <code>Form</code> 部件，接下来，就要准备通过 <code>TextFormField</code> 来撸一个登录界面，但是这之前，前面有个坑需要先解决下</p>
<h4 id="导入自定义的图标"><a href="#导入自定义的图标" class="headerlink" title="导入自定义的图标"></a>导入自定义的图标</h4><p>在这之前，涉及到 <code>Icon</code> 部件，都是使用的系统自带的图标，那么如何导入第三方自定义图标呢，马上为你揭晓答案，首先我们需要打开「阿里妈妈」也就是 <a target="_blank" rel="noopener" href="https://www.iconfont.cn/">iconfont</a>，不知道的小伙伴通过链接打开，然后需要注册个账户，也可以直接通过 <code>Github</code> 等三方登录，然后就可以搜索我们需要的图标了，接下来需要撸一个登录，那我们就找一个 <em>用户</em>  和 <em>密码</em> 的图标吧，选择喜欢的图标，然后鼠标放到图标会出现三个按钮，直接点击 <strong>购物车</strong> 那个按钮，然后就可以通过顶部的 <strong>购物车</strong> 按钮查看添加的图标，点击下载代码，把资源文件下载到本地。</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-b3dd5a7cb7dd0535.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" width="400" height="200" align="center"/>

<p>解压后，需要用到的文件有两个，别的可以忽略 </p>
<ol>
<li><code>demo_index.html</code> 这边用来查看图标的 <code>unicode</code></li>
<li><code>iconfont.ttf</code> 这边就是图标资源文件了</li>
</ol>
<p>回到项目，创建一个文件夹 <code>fonts</code> ，和 <code>images</code> 同级，将 <code>iconfont.ttf</code> 文件放到该文件夹下，然后打开 <code>pubspec.ymal</code> 文件，注册下导入的资源，可以自己命名 <code>iconfont.ttf</code> 文件名，便于自己发现就行，例如我命名为 <code>third_part_icon.ttf</code>，在注册图片下面继续添加</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">fonts:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">family:</span> <span class="string">ThirdPartIcons</span></span><br><span class="line">    <span class="attr">fonts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">asset:</span> <span class="string">fonts/third_part_icon.ttf</span></span><br></pre></td></tr></table></figure>

<p>注册完了记得点击 <code>Package get</code>，否则会找不到资源。接着新建个 <code>third_icons.dart</code> 文件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThirdIcons</span> </span>&#123;</span><br><span class="line">  <span class="comment">// codePoint 值通过打开 `demo_index.html` 获取</span></span><br><span class="line">  <span class="comment">// 会在相应 icon 下带有相应的 code，把 `&amp;#` 替换成 `0`，然后去掉最后的 `;` 即可</span></span><br><span class="line">  <span class="comment">// 例如 &amp;#xe672; 对应我们需要的图标就是 0xe672</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> IconData username = ThirdIconData(<span class="number">0xe672</span>);</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> IconData password = ThirdIconData(<span class="number">0xe62f</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThirdIconData</span> <span class="keyword">extends</span> <span class="title">IconData</span> </span>&#123;</span><br><span class="line">  <span class="comment">// fontFamily 就是我们在 `pubspec.yaml` 中注册的 family 值</span></span><br><span class="line">  <span class="keyword">const</span> ThirdIconData(<span class="built_in">int</span> codePoint) : <span class="keyword">super</span>(codePoint, fontFamily: <span class="string">&#x27;ThirdPartIcons&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来就可以通过该类导入需要的第三方图标了。</p>
<h4 id="导入第三方插件"><a href="#导入第三方插件" class="headerlink" title="导入第三方插件"></a>导入第三方插件</h4><p>其实 <code>Flutter</code> 中缺少很多功能，需要通过导入第三方插件来实现功能，插件就是 <code>Flutter</code> 和原生交互的桥梁，也就是说，要写 <code>Flutter</code> 的插件，需要写 <code>Android</code> 和 <code>iOS</code> 两端代码才可，否则只有在其中一个端能够实现功能。好在有很多现成的插件已经开源，可以通过 <a target="_blank" rel="noopener" href="https://pub.dartlang.org/flutter/">FlutterPackage</a> 搜索到，例如等会我们会需要用到 <code>FlutterToast</code> 这个插件，用来做提醒用，在 <code>FlutterPackage</code> 中搜索到插件后，打开项目中的 <code>pubspec.ymal</code> 文件，在 <code>dependencies</code> 类目下将 <code>fluttertoast</code> 插件引入，如图：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-b73891a6a80b7751.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/606/format/webp" width="400" height="350" align="center"/>

<p>然后点击 <code>Package get</code> 让其导入即可，别的插件也是这样导入。做好准备工作，我们就可以撸一个登录界面了~</p>
<h4 id="撸一个登录界面"><a href="#撸一个登录界面" class="headerlink" title="撸一个登录界面"></a>撸一个登录界面</h4><p>在开撸之前，我们先看下最终的效果图吧，虽然是比较常用的界面(因为图都是自己搞的，比较丑请不要介意)</p>
<div align="center">
    <img src="https://upload-images.jianshu.io/upload_images/2888797-33d93773fbbb94f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/346/format/webp" width="200" height="350"/>
    <img src="https://upload-images.jianshu.io/upload_images/2888797-33d93773fbbb94f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/346/format/webp" width="200" height="350"/>
</div>

<p>因为两个界面比较相似，所以这边只贴外层的代码和登录的代码，具体的代码，可以查看源码，已经推到 <code>Github</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(LoginApp());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (Platform.isAndroid) &#123;</span><br><span class="line">    <span class="keyword">var</span> style = SystemUiOverlayStyle(statusBarColor: Colors.transparent);</span><br><span class="line">    SystemChrome.setSystemUIOverlayStyle(style);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="language-markdown">外层界面，包裹登录界面和注册界面，使用的都是前面讲过的，忘记可以查看之前的章节</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">&#x27;Login Demo&#x27;</span>,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">      theme: ThemeData(primarySwatch: Colors.lightBlue),</span><br><span class="line">      home: LoginHomePage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginHomePage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _LoginHomePageState createState() =&gt; _LoginHomePageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_LoginHomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">LoginHomePage</span>&gt; <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  TabController _tabController;</span><br><span class="line">  <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _pageIndicators = [<span class="string">&#x27;登录&#x27;</span>, <span class="string">&#x27;注册&#x27;</span>];</span><br><span class="line">  <span class="built_in">List</span>&lt;Widget&gt; _pages = [];</span><br><span class="line">  <span class="built_in">int</span> _position = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _tabController = TabController(length: _pageIndicators.length, vsync: <span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// 将登录界面和注册界面添加到列表，用于放到 IndexStack 的 children 属性</span></span><br><span class="line">    _pages..add(LoginPage())..add(RegisterPage());</span><br><span class="line"></span><br><span class="line">    _tabController.addListener(() &#123;</span><br><span class="line">      <span class="comment">// 当 tab 切换的时候，联动 IndexStack 的 child 页面也进行修改，通过 setState 来修改值</span></span><br><span class="line">      <span class="keyword">if</span> (_tabController.indexIsChanging) setState(() =&gt; _position = _tabController.index);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// 先忽略...</span></span><br><span class="line">    <span class="keyword">return</span> Theme(</span><br><span class="line">        data: ThemeData(primarySwatch: Colors.pink, iconTheme: IconThemeData(color: Colors.pink)),</span><br><span class="line">        child: Scaffold(</span><br><span class="line">          body: Container(</span><br><span class="line">            padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">20.0</span>),</span><br><span class="line">            alignment: Alignment.center,</span><br><span class="line">            decoration:</span><br><span class="line">                BoxDecoration(image: DecorationImage(image: AssetImage(<span class="string">&#x27;images/login_bg.png&#x27;</span>), fit: BoxFit.cover)),</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 先忽略...下面会讲，主要是解决软键盘弹出的时候，界面内容会溢出的问题</span></span><br><span class="line">            child: SingleChildScrollView(</span><br><span class="line">              child: SafeArea(</span><br><span class="line">                  child: Column(mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[</span><br><span class="line">                <span class="comment">// 顶部页面切换指示器，代码可以参考 `app_bar_main.dart` 文件</span></span><br><span class="line">                TabBar(</span><br><span class="line">                    indicatorSize: TabBarIndicatorSize.label,</span><br><span class="line">                    controller: _tabController,</span><br><span class="line">                    indicatorWeight: <span class="number">4.0</span>,</span><br><span class="line">                    indicatorColor: Colors.white,</span><br><span class="line">                    <span class="comment">// 返回 tab 列表</span></span><br><span class="line">                    tabs: _pageIndicators</span><br><span class="line">                        .map((v) =&gt; Text(v, style: TextStyle(color: Colors.white, fontSize: <span class="number">24.0</span>)))</span><br><span class="line">                        .toList()),</span><br><span class="line">                Padding(</span><br><span class="line">                    padding: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">30.0</span>),</span><br><span class="line">                    child: SizedBox(</span><br><span class="line">                        <span class="comment">// 切换界面列表</span></span><br><span class="line">                        child: IndexedStack(children: _pages, index: _position),</span><br><span class="line">                        <span class="comment">// 指定高度</span></span><br><span class="line">                        height: MediaQuery.of(context).size.height / <span class="number">2</span>))</span><br><span class="line">              ])),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">登录界面</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _LoginPageState createState() =&gt; _LoginPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_LoginPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">LoginPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 用于后面判断表单内容是否有效</span></span><br><span class="line">  GlobalKey&lt;FormState&gt; _formKey = GlobalKey();</span><br><span class="line">  <span class="comment">// 用于获取输入框的内容</span></span><br><span class="line">  TextEditingController _usernameController = TextEditingController();</span><br><span class="line">  TextEditingController _passwordController = TextEditingController();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// 防止内存溢出，记得销毁..销毁..销毁</span></span><br><span class="line">    _usernameController.dispose();</span><br><span class="line">    _passwordController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _login() &#123;</span><br><span class="line">    <span class="comment">// 取消焦点</span></span><br><span class="line">    FocusScope.of(context).requestFocus(FocusNode());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断表单是否有效</span></span><br><span class="line">    <span class="keyword">if</span> (_formKey.currentState.validate()) &#123;</span><br><span class="line">      <span class="comment">// 获取输入框内容</span></span><br><span class="line">      <span class="keyword">var</span> username = _usernameController.value.text;</span><br><span class="line">      <span class="keyword">var</span> password = _passwordController.value.text;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 判断登录条件</span></span><br><span class="line">      <span class="keyword">if</span> (username == <span class="string">&#x27;kuky&#x27;</span> &amp;&amp; password == <span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">        <span class="comment">// 引入的三方插件方法，`Flutter` 没有自带的 `Taost`</span></span><br><span class="line">        Fluttertoast.showToast(msg: <span class="string">&#x27;登录成功&#x27;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        Fluttertoast.showToast(msg: <span class="string">&#x27;登录失败&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Form(</span><br><span class="line">        <span class="comment">// 将 key 设置给表单，用于判断表单是否有效</span></span><br><span class="line">        key: _formKey,</span><br><span class="line">        child: Column(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Padding(</span><br><span class="line">              padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">4.0</span>),</span><br><span class="line">              <span class="comment">// 表单输入框，参数同 TextField 基本类似</span></span><br><span class="line">              child: TextFormField(</span><br><span class="line">                controller: _usernameController,</span><br><span class="line">                style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>),</span><br><span class="line">                decoration: InputDecoration(</span><br><span class="line">                    icon: Icon(ThirdIcons.username, size: <span class="number">24.0</span>, color: Colors.white),</span><br><span class="line">                    labelText: <span class="string">&#x27;请输入用户名&#x27;</span>,</span><br><span class="line">                    labelStyle: TextStyle(color: Colors.white),</span><br><span class="line">                    helperStyle: TextStyle(color: Colors.white)),</span><br><span class="line">                <span class="comment">// 有效条件(为空不通过，返回提示语，通过返回 null)</span></span><br><span class="line">                validator: (value) =&gt; value.trim().isEmpty ? <span class="string">&#x27;用户名不能为空&#x27;</span> : <span class="keyword">null</span>,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            Padding(</span><br><span class="line">              padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">4.0</span>),</span><br><span class="line">              child: TextFormField(</span><br><span class="line">                obscureText: <span class="keyword">true</span>,</span><br><span class="line">                controller: _passwordController,</span><br><span class="line">                style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>),</span><br><span class="line">                decoration: InputDecoration(</span><br><span class="line">                    icon: Icon(ThirdIcons.password, size: <span class="number">24.0</span>, color: Colors.white),</span><br><span class="line">                    labelText: <span class="string">&#x27;请输入密码&#x27;</span>,</span><br><span class="line">                    labelStyle: TextStyle(color: Colors.white),</span><br><span class="line">                    helperStyle: TextStyle(color: Colors.white)),</span><br><span class="line">                validator: (value) =&gt; value.trim().length &lt; <span class="number">6</span> ? <span class="string">&#x27;密码长度不能小于6位&#x27;</span> : <span class="keyword">null</span>,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            Padding(</span><br><span class="line">              padding: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">20.0</span>),</span><br><span class="line">              child: SizedBox(</span><br><span class="line">                <span class="comment">// 主要用于使 RaisedButton 和上层容器同宽</span></span><br><span class="line">                width: MediaQuery.of(context).size.width,</span><br><span class="line">                child: RaisedButton(</span><br><span class="line">                    color: Colors.pink,</span><br><span class="line">                    shape: RoundedRectangleBorder(borderRadius: BorderRadius.all(Radius.circular(<span class="number">4.0</span>))),</span><br><span class="line">                    onPressed: _login,</span><br><span class="line">                    child: Text(</span><br><span class="line">                      <span class="string">&#x27;登录&#x27;</span>,</span><br><span class="line">                      style: TextStyle(color: Colors.white, fontSize: <span class="number">20.0</span>),</span><br><span class="line">                    )),</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>撸完界面后，可以试下登录效果，如果输入框的内容，和 <code>TextFormField</code> 的 <code>validator</code> 的条件不符合，则会显示错误文字的提示</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-5cb0e15f241334bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/342/format/webp" width="200" height="350" align="center"/>

<p>如果按照条件用户名为 <code>kuky</code> 密码为 <code>123456</code> (条件可以根据自己进行修改)则会显示登录成功的逻辑</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-5cb0e15f241334bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/342/format/webp" width="200" height="350" align="center"/>

<p><em>以上代码查看 <code>login_home_page.dart</code> 文件</em></p>
<p>注册界面的逻辑和登录界面的逻辑几乎一样，算是第一次实战了，望小伙伴能够好好的写一遍</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/16/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-05/" data-id="cl0ukmc2n000lpn1gec8abr77" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-04" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/12/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-04/" class="article-date">
  <time datetime="2019-03-12T14:59:02.000Z" itemprop="datePublished">2019-03-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/12/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-04/">Flutter Guide(04) -- 接触 Flutter 常用布局</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上节填完了 <code>Scaffold</code> 留下的坑，这节继续填坑，之前留下关于 <code>Layout</code> 的坑，又是一堆部件袭来</p>
<h4 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h4><p>为了让我们的界面更容易被扩展，通常会在最外层包裹一层 <code>Container</code>，其构造函数也不是很难理解</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Container(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.alignment, <span class="comment">// child 的对齐方式，包括左对齐，居中，右对齐，左上对齐..等等</span></span><br><span class="line">    <span class="keyword">this</span>.padding, <span class="comment">// child 和 Container 的边距</span></span><br><span class="line">    Color color, <span class="comment">// Container 的背景色</span></span><br><span class="line">    Decoration decoration, <span class="comment">// 样式，可以设置背景图，圆角等属性</span></span><br><span class="line">    <span class="keyword">this</span>.foregroundDecoration, <span class="comment">// child 的样式</span></span><br><span class="line">    <span class="built_in">double</span> width, <span class="comment">// 宽度</span></span><br><span class="line">    <span class="built_in">double</span> height, <span class="comment">// 高度</span></span><br><span class="line">    BoxConstraints constraints, <span class="comment">// 默认使用 BoxConstraints.tightFor，可以手动传入</span></span><br><span class="line">    <span class="keyword">this</span>.margin, <span class="comment">// Container 同上层容器的边距</span></span><br><span class="line">    <span class="keyword">this</span>.transform, <span class="comment">// 是个 Matrix4 矩阵，(嗯..这个参数基本很少用，没怎么了解 /捂脸)</span></span><br><span class="line">    <span class="keyword">this</span>.child, <span class="comment">// 需要展示的内容</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> BoxConstraints.tightFor(&#123;</span><br><span class="line">    <span class="built_in">double</span> width,</span><br><span class="line">    <span class="built_in">double</span> height</span><br><span class="line">  &#125;): minWidth = width != <span class="keyword">null</span> ? width : <span class="number">0.0</span>,</span><br><span class="line">      maxWidth = width != <span class="keyword">null</span> ? width : <span class="built_in">double</span>.infinity,</span><br><span class="line">      minHeight = height != <span class="keyword">null</span> ? height : <span class="number">0.0</span>,</span><br><span class="line">      maxHeight = height != <span class="keyword">null</span> ? height : <span class="built_in">double</span>.infinity;</span><br></pre></td></tr></table></figure>

<p>让我们写个圆角矩形的外层，内层值显示白色文字</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: SafeArea(</span><br><span class="line">          child: Container(</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        <span class="comment">// 宽，高度同上层容器相同</span></span><br><span class="line">        width: MediaQuery.of(context).size.width,</span><br><span class="line">        height: MediaQuery.of(context).size.height,</span><br><span class="line">        margin: <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">20.0</span>),</span><br><span class="line">        <span class="comment">// Container 的样式</span></span><br><span class="line">        decoration: BoxDecoration(</span><br><span class="line">            borderRadius: BorderRadius.circular(<span class="number">20.0</span>),</span><br><span class="line">            color: Colors.red,</span><br><span class="line"><span class="comment">//            shape: BoxShape.circle, // 该属性不可同 borderRadius 一起使用</span></span><br><span class="line">            backgroundBlendMode: BlendMode.colorDodge, <span class="comment">// 背景图片和颜色混合模式</span></span><br><span class="line">            image: DecorationImage(image: AssetImage(<span class="string">&#x27;images/ali.jpg&#x27;</span>), fit: BoxFit.cover)),</span><br><span class="line">        child: Text(<span class="string">&#x27;Container Text&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line"><span class="comment">//        color: Theme.of(context).primaryColor, // 该属性不可和 decoration 一起使用</span></span><br><span class="line">      )),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果图如下：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-12843e7d40e059cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/426/format/webp" width="200" height="350" align="center"/>

<p><em>该部分代码查看 <code>column_main.dart</code> 文件</em></p>
<p>看到这，应该很多小伙伴注意到 <code>margin</code> 和 <code>padding</code> 属性用来和别的部件保持间距，那…那我就是不用 <code>Container</code> 呢(专门来挑事的…)，当然没问题，有个专门用来设置间距的部件 <code>Padding</code>，看名字就可以看出来作用了，修改下 <code>child</code> 部分代码，这边先提前用下接下来会讲的部件</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">child: Column(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Text(<span class="string">&#x27;Container Text&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">            Padding(</span><br><span class="line">                <span class="comment">// 需要传入一个间隔值，`Flutter` 提供了很多 EdgeInsets 来设置间隔，</span></span><br><span class="line">                <span class="comment">// 参数也很明确，可以一一尝试</span></span><br><span class="line">                padding: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">12.0</span>),</span><br><span class="line">                <span class="comment">// 传入需要间隔的部件</span></span><br><span class="line">                child: Text(<span class="string">&#x27;Container Text&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)))</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br></pre></td></tr></table></figure>

<p>效果就不展示了，接下来就要开始我的填坑之旅了….</p>
<h4 id="Flex，Row，Column"><a href="#Flex，Row，Column" class="headerlink" title="Flex，Row，Column"></a>Flex，Row，Column</h4><p>写 <code>Android</code> 的小伙伴应该比较常用 <code>LinearLayout</code>，在 <code>Flutter</code> 中用两个部件，<code>Row</code> <code>Column</code>来代替 <code>Android</code> 中的 <code>LinearLayout</code>，其中 <code>Row</code> 是横向布局，<code>Column</code> 是垂直布局，因为 <code>Row</code> 和 <code>Column</code> 都是继承于 <code>Flex</code> 部件，<code>Flex</code> 比他们多了 <code>direction</code> 属性用来指定方向，所以主要拿 <code>Column</code> 来讲解，<code>Flex</code> 、<code>Row</code> 用法相同</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Column(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="comment">// 对齐方式，对于 `Column` start 为顶部，对于 `Row` 需要分语言，和语言同向</span></span><br><span class="line">    <span class="comment">// 3 种比较特殊的对齐方式，前端的小伙伴会了解，</span></span><br><span class="line">    <span class="comment">// spaceAround 两个部件之间的间隔是部件和上层容器间隔的两倍</span></span><br><span class="line">    <span class="comment">// spaceBetween 两侧部件同上层容器间隔为 0，部件之间的间隔相等</span></span><br><span class="line">    <span class="comment">// spaceEvenly 部件之间的间隔同两侧部件与上层容器间隔</span></span><br><span class="line">    MainAxisAlignment mainAxisAlignment = MainAxisAlignment.start, </span><br><span class="line">    MainAxisSize mainAxisSize = MainAxisSize.max, <span class="comment">// 主轴的大小</span></span><br><span class="line">    CrossAxisAlignment crossAxisAlignment = CrossAxisAlignment.center, <span class="comment">// 副轴对齐方式</span></span><br><span class="line">    TextDirection textDirection, <span class="comment">// 文字方向，决定 start</span></span><br><span class="line">    VerticalDirection verticalDirection = VerticalDirection.down, <span class="comment">// 垂直方向</span></span><br><span class="line">    TextBaseline textBaseline,</span><br><span class="line">    <span class="built_in">List</span>&lt;Widget&gt; children = <span class="keyword">const</span> &lt;Widget&gt;[], <span class="comment">// 内部子部件</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p><code>Row</code> 和 <code>Column</code> 都有主轴和副轴，如何区分呢，<strong>布局平行方向为主轴，垂直方向为副轴</strong>，我们把 <code>Container</code> 的 <code>child</code> 修改成 <code>Column</code>，然后把 <code>Text</code> 放到 <code>Column</code> 中，多放几个，然后自己设置 <code>mainAxisAlignment</code> 属性，查看布局的变化</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ... 省略相同代码</span></span><br><span class="line">child: Column(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.spaceAround,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Text(<span class="string">&#x27;Container Text 1&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;Container Text 2&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;Container Text 3&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;Container Text 4&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;Container Text 5&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">          ],</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>最后的效果图如下：</p>
<p>&lt;img src&#x3D;<a target="_blank" rel="noopener" href="https://upload-images.jianshu.io/upload_images/2888797-1d5479ff284835f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/427/format/webp&quot;">https://upload-images.jianshu.io/upload_images/2888797-1d5479ff284835f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/427/format/webp&quot;</a> width&#x3D;”200” height&#x3D;”350” align&#x3D;”center”&#x2F;&gt;</p>
<p>这边 <code>Column</code> 内部的子部件因为高度相同，如果不同还需要等分空间的话，就不可以通过设置 <code>mainAxisAlignment</code> 属性来实现了，这里介绍一个等分的部件 <code>Expanded</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Expanded(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="built_in">int</span> flex = <span class="number">1</span>, <span class="comment">// 所占比例</span></span><br><span class="line">    <span class="meta">@required</span> Widget child, <span class="comment">// 子部件</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>直接给 <code>Text</code> 外层加一个 <code>Expanded</code> 即可实现效果，当然可以按照需求来设置 <code>flex</code> 来修改比例值。</p>
<p>当然，在使用过程中也会遇到那么些坑，我们修改下代码，把 <code>child</code> 的代码修改成如下</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">child: Row(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Text(<span class="string">&#x27;ABC&#x27;</span> * <span class="number">5</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;ABC&#x27;</span> * <span class="number">5</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;ABC&#x27;</span> * <span class="number">5</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;ABC&#x27;</span> * <span class="number">5</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>)),</span><br><span class="line">            Text(<span class="string">&#x27;ABC&#x27;</span> * <span class="number">5</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">16.0</span>))</span><br><span class="line">          ],</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>然后运行下，你的屏幕就提示你 <code>RIGHT OVERFLOWED BY XXX PIXELS</code> 「**,  *****」我猜你内心肯定这样的，冷静冷静</p>
<p>既然遇到问题，当然要解决，不然和产品去撕逼吗..？这边，我们把 <code>Row</code> 换成另一个布局 <code>Wrap</code> 然后再运行，Prefect，<code>Wrap</code> 和 <code>Row</code> 的参数基本类似</p>
<h4 id="Wrap"><a href="#Wrap" class="headerlink" title="Wrap"></a>Wrap</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Wrap(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.direction = Axis.horizontal,</span><br><span class="line">    <span class="keyword">this</span>.alignment = WrapAlignment.start,</span><br><span class="line">    <span class="keyword">this</span>.spacing = <span class="number">0.0</span>, <span class="comment">// 两个子部件之间的间隔，默认 0.0，如果值过大，可能导致原来同行的两个部件分行</span></span><br><span class="line">    <span class="keyword">this</span>.runAlignment = WrapAlignment.start, </span><br><span class="line">    <span class="keyword">this</span>.runSpacing = <span class="number">0.0</span>, <span class="comment">// 排布方向上 两个子部件的间隔</span></span><br><span class="line">    <span class="keyword">this</span>.crossAxisAlignment = WrapCrossAlignment.start,</span><br><span class="line">    <span class="keyword">this</span>.textDirection,</span><br><span class="line">    <span class="keyword">this</span>.verticalDirection = VerticalDirection.down,</span><br><span class="line">    <span class="built_in">List</span>&lt;Widget&gt; children = <span class="keyword">const</span> &lt;Widget&gt;[],</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>当然，很多时候只有以上的布局是不行的，比如我们需要实现一个<em>圆形头像，然后一段文字在其上面</em> ，例如下面的效果</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-e76f9e446c3c33d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/343/format/webp" width="200" height="350" align="center"/>

<p>接下来介绍一个堆叠的部件 <code>Stack</code>，源码比较简单，就不贴了，直接上效果代码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: Center(</span><br><span class="line">          child: Stack(</span><br><span class="line">        <span class="comment">// 内部子部件的对齐方式</span></span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          <span class="comment">// 圆形头像，指定半径，指定背景图为头像即可</span></span><br><span class="line">          CircleAvatar(backgroundImage: AssetImage(<span class="string">&#x27;images/ali.jpg&#x27;</span>), radius: <span class="number">100.0</span>),</span><br><span class="line">          Text(</span><br><span class="line">            <span class="string">&#x27;Kuky&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">34.0</span>)),</span><br><span class="line">        ],</span><br><span class="line">      )),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们需要第三个部件，底部距离圆形头像10px，那么只靠 <code>alignment</code> 是不可能实现了</p>
<p>所以，另外一个灰常流弊的部件就出来了 <code>Positioned</code>，其源码也比较简单，我还是不贴了吧~，还是直接上代码，直接修改</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: Center(</span><br><span class="line">          child: Stack(</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          CircleAvatar(backgroundImage: AssetImage(<span class="string">&#x27;images/ali.jpg&#x27;</span>), radius: <span class="number">100.0</span>),</span><br><span class="line">          Text(</span><br><span class="line">            <span class="string">&#x27;Kuky&#x27;</span>,</span><br><span class="line">            style: TextStyle(color: Colors.white, fontSize: <span class="number">34.0</span>),</span><br><span class="line">          ),</span><br><span class="line">          Positioned(child: Text(<span class="string">&#x27;另外一段文字&#x27;</span>, style: TextStyle(color: Colors.white, fontSize: <span class="number">20.0</span>)), bottom: <span class="number">10.0</span>), <span class="comment">// left, right, top, bottom 分别表示和 stack 的间距</span></span><br><span class="line">        ],</span><br><span class="line">      )),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后的效果图如下：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-48f42623e06e7043.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/343/format/webp" width="200" height="350" align="center"/>

<p><em>此处代码查看 <code>stack_main.dart</code> 文件</em></p>
<p>当然，<code>Flutter</code> 还提供别的布局类的部件，例如 <code>Flow</code> 这个鬼，但是呢……这个鬼会用到「转换矩阵」来对子部件进行布局(一般听到需要用矩阵…emmmm，算…算你牛逼)，而且不能自适应子部件的大小等等一些问题，所以还是放弃吧，实际上，前面介绍的布局完全够用了，是在不够用了，再看 <code>Flow</code> 吧</p>
<p>很好，今天填了布局的这个大坑，而且讲的部件貌似还挺多的，虽然还是比较简单，剩下的就给小伙伴们慢慢消化今天的内容。</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/12/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-04/" data-id="cl0ukmc2m000epn1g00cn2r2m" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/11/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-03/" class="article-date">
  <time datetime="2019-03-11T11:05:57.000Z" itemprop="datePublished">2019-03-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/11/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-03/">Flutter Guide(03) -- 了解 Scaffold 和 AppBar</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上一篇讲完 <code>Flutter</code> 中的一些基本部件，这篇就先填完上篇留下的没写的 <code>AppBar</code> 的坑，以及 <code>Scaffold</code> 其他参数的使用，在开始前，先补一张缩略版的脑图</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-6717dd72371f6039.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" width="300" height="300" align="center"/>

<p>完整版放在网盘，小伙伴自己下载。 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1KIYWMMcu1okvQxD2vWAwKw">完整版脑图</a>，提取码：el9q，<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DMg0cyjUoHQaXkJzJyYFyw">xmind 文件</a> 提取码：1o5d </p>
<h4 id="AppBar（part2）"><a href="#AppBar（part2）" class="headerlink" title="AppBar（part2）"></a>AppBar（part2）</h4><p>这一部分，我们只关注 <code>Scaffold</code> 中的 <code>AppBar</code> 剩下的还是埋坑【坑4】(&#x2F;内牛满面，居然已经埋了那么多坑了，坑虽多，代码还是要继续的)，因为稍后会用到 <code>StatefulWidget</code> 的属性，所以就直接先使用了，和 <code>StatelessWidget</code> 区别用法可以这么记 **需要数据更新的界面用 <code>StatefulWidget</code>**，当然也不是绝对的，就是之前留的【坑1】所说的状态管理</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _HomePageState createState() =&gt; _HomePageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_HomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">HomePage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _abs = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;S&#x27;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        centerTitle: <span class="keyword">true</span>, <span class="comment">// 标题内容居中</span></span><br><span class="line">        automaticallyImplyLeading: <span class="keyword">false</span>, <span class="comment">// 不使用默认</span></span><br><span class="line">        leading: Icon(Icons.menu, color: Colors.red, size: <span class="number">30.0</span>), <span class="comment">// 左侧按钮</span></span><br><span class="line">        flexibleSpace: Image.asset(<span class="string">&#x27;images/app_bar_hor.jpg&#x27;</span>, fit: BoxFit.cover), <span class="comment">// 背景</span></span><br><span class="line">        title: Text(<span class="string">&#x27;AppBar Demo&#x27;</span>, style: TextStyle(color: Colors.red)), <span class="comment">// 标题内容</span></span><br><span class="line">        <span class="comment">// 末尾的操作按钮列表</span></span><br><span class="line">        actions: &lt;Widget&gt;[</span><br><span class="line">          PopupMenuButton(</span><br><span class="line">              onSelected: (val) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;Selected item is <span class="subst">$val</span>&#x27;</span>),</span><br><span class="line">              icon: Icon(Icons.more_vert, color: Colors.red),</span><br><span class="line">              itemBuilder: (context) =&gt;</span><br><span class="line">                  <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; PopupMenuItem(value: _abs[index], child: Text(_abs[index]))))</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后的效果图，未点击右侧按钮如左侧所示，点击右侧按钮会弹出相应的 <code>mune</code></p>
<div align="center">
    <img src="https://upload-images.jianshu.io/upload_images/2888797-35316843ce6eedc0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/345/format/webp" width="200" height="350"/>
    <img src="https://upload-images.jianshu.io/upload_images/2888797-f2338385ce8d45f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/346/format/webp" width="200" height="350"/>
</div>

<p><em>该部分代码查看 <code>app_bar_main.dart</code> 文件</em></p>
<p>看到效果图，相信很多小伙伴会吐槽，「**，上面那层半透明的啥玩意，那么丑」，接下来我们来解决这个问题，修改 <code>void main</code> 方法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(DemoApp());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加如下代码，使状态栏透明</span></span><br><span class="line">  <span class="keyword">if</span> (Platform.isAndroid) &#123;</span><br><span class="line">    <span class="keyword">var</span> style = SystemUiOverlayStyle(statusBarColor: Colors.transparent);</span><br><span class="line">    SystemChrome.setSystemUIOverlayStyle(style);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关闭后重新运行，就可以看到那层丑丑的「半透明蒙层」没有了，接着介绍下 <code>PopupMenuButton</code> 这个部件，还是按照惯例看构造函数</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// itemBuilder</span></span><br><span class="line"><span class="keyword">typedef</span> PopupMenuItemBuilder&lt;T&gt; = <span class="built_in">List</span>&lt;PopupMenuEntry&lt;T&gt;&gt; <span class="built_in">Function</span>(BuildContext context);</span><br><span class="line"><span class="comment">// onSelected</span></span><br><span class="line"><span class="keyword">typedef</span> PopupMenuItemSelected&lt;T&gt; = <span class="keyword">void</span> <span class="built_in">Function</span>(T value);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PopupMenuButton(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.itemBuilder, <span class="comment">// 用于定义 menu 列表，需要传入 List&lt;PopupMenuEntry&lt;T&gt;&gt;</span></span><br><span class="line">    <span class="keyword">this</span>.initialValue, <span class="comment">// 初始值，是个泛型 T，也就是类型和你传入的值有关</span></span><br><span class="line">    <span class="keyword">this</span>.onSelected, <span class="comment">// 选中 item 的回调函数，返回 T value，例如选中 `s` 则返回 s</span></span><br><span class="line">    <span class="keyword">this</span>.onCanceled, <span class="comment">// 未选择任何 menu，直接点击外侧使 mune 列表关闭的回调</span></span><br><span class="line">    <span class="keyword">this</span>.tooltip, <span class="comment">// 长按时的提示</span></span><br><span class="line">    <span class="keyword">this</span>.elevation = <span class="number">8.0</span>,</span><br><span class="line">    <span class="keyword">this</span>.padding = <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">    <span class="keyword">this</span>.child, <span class="comment">// 用于自定义按钮的内容</span></span><br><span class="line">    <span class="keyword">this</span>.icon, <span class="comment">// 按钮的图标</span></span><br><span class="line">    <span class="keyword">this</span>.offset = Offset.zero, <span class="comment">// 展示时候的便宜，Offset 需要传入 x,y 轴偏移量，会根据传入值平移</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="AppBar-bottom"><a href="#AppBar-bottom" class="headerlink" title="AppBar - bottom"></a>AppBar - bottom</h4><p><code>AppBar</code> 还有个 <code>bottom</code> 属性没讲，因为 <code>bottom</code> 这个属性和图片背景一起使用会比较丑，所以就单独拎出来讲，我们直接在原来的代码上修改</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里需要用 with 引入 `SingleTickerProviderStateMixin` 这个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_HomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">HomePage</span>&gt; <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _abs = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;S&#x27;</span>];</span><br><span class="line">  TabController _tabController; <span class="comment">// TabBar 必须传入这个参数</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">// 引入 `SingleTickerProviderStateMixin` 类主要是因为 _tabController 需要传入 vsync 参数</span></span><br><span class="line">    _tabController = TabController(length: _abs.length, vsync: <span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// 需要在界面 dispose 之前把 _tabController dispose，防止内存泄漏</span></span><br><span class="line">    _tabController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">        automaticallyImplyLeading: <span class="keyword">false</span>,</span><br><span class="line">        leading: Icon(Icons.menu, color: Colors.red, size: <span class="number">30.0</span>),</span><br><span class="line"><span class="comment">//        flexibleSpace: Image.asset(&#x27;images/app_bar_hor.jpg&#x27;, fit: BoxFit.cover),</span></span><br><span class="line">        title: Text(<span class="string">&#x27;AppBar Demo&#x27;</span>, style: TextStyle(color: Colors.red)),</span><br><span class="line">        actions: &lt;Widget&gt;[</span><br><span class="line">          PopupMenuButton(</span><br><span class="line">              offset: Offset(<span class="number">50.0</span>, <span class="number">100.0</span>),</span><br><span class="line">              onSelected: (val) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;Selected item is <span class="subst">$val</span>&#x27;</span>),</span><br><span class="line">              icon: Icon(Icons.more_vert, color: Colors.red),</span><br><span class="line">              itemBuilder: (context) =&gt;</span><br><span class="line">                  <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; PopupMenuItem(value: _abs[index], child: Text(_abs[index]))))</span><br><span class="line">        ],</span><br><span class="line">        bottom: TabBar(</span><br><span class="line">            labelColor: Colors.red, <span class="comment">// 选中时的颜色</span></span><br><span class="line">            unselectedLabelColor: Colors.white, <span class="comment">// 未选中颜色</span></span><br><span class="line">            controller: _tabController,</span><br><span class="line">            isScrollable: <span class="keyword">false</span>, <span class="comment">// 是否固定，当超过一定数量的 tab 时，如果一行排不下，可设置 true</span></span><br><span class="line">            indicatorColor: Colors.yellow, <span class="comment">// 导航的颜色</span></span><br><span class="line">            indicatorSize: TabBarIndicatorSize.tab, <span class="comment">// 导航样式，还有个选项是 TabBarIndicatorSize.label tab 时候，导航和 tab 同宽，label 时候，导航和 icon 同宽</span></span><br><span class="line">            indicatorWeight: <span class="number">5.0</span>, <span class="comment">// 导航高度</span></span><br><span class="line">            tabs: <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; Tab(text: _abs[index], icon: Icon(Icons.android)))), <span class="comment">// 导航内容列表</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终的效果图如下：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-31b8b2489f56abb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/346/format/webp" width="200" height="350" align="center"/>

<h4 id="PageView-TabBar"><a href="#PageView-TabBar" class="headerlink" title="PageView + TabBar"></a>PageView + TabBar</h4><p>那么如何通过 <code>TabBar</code> 切换界面呢，这边我们需要用到 <code>PageView</code> 这个部件，当然还有别的部件，例如 <code>IndexStack</code> 等，小伙伴可以自己尝试使用别的，这边通过 <code>PageView</code> 和 <code>TabBar</code> 进行关联，带动页面切换，<code>PageViede</code> 的属性参数相对比较简单，这边就不贴啦。最终的效果我们目前只展示一个文字即可，我们先定义一个通用的切换界面</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TabChangePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 需要传入的参数</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> content;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TabChangePage(this.content); 不推荐这样写构造方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 推荐用这样的构造方法，key 可以作为唯一值查找</span></span><br><span class="line">  TabChangePage(&#123;Key key, <span class="keyword">this</span>.content&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// 仅展示传入的内容</span></span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">        alignment: Alignment.center, child: Text(content, style: TextStyle(color: Theme.of(context).primaryColor, fontSize: <span class="number">30.0</span>)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定义通用界面后，就可以作为 <code>PageView</code> 的子界面传入并展示</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _HomePageState createState() =&gt; _HomePageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_HomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">HomePage</span>&gt; <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _abs = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;S&#x27;</span>];</span><br><span class="line">  TabController _tabController;</span><br><span class="line">  <span class="comment">// 用于同 TabBar 进行联动</span></span><br><span class="line">  PageController _pageController;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _tabController = TabController(length: _abs.length, vsync: <span class="keyword">this</span>);</span><br><span class="line">    _pageController = PageController(initialPage: <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    _tabController.addListener(() &#123;</span><br><span class="line">      <span class="comment">// 判断 TabBar 是否切换位置了，如果切换了，则修改 PageView 的显示</span></span><br><span class="line">      <span class="keyword">if</span> (_tabController.indexIsChanging) &#123;</span><br><span class="line">        <span class="comment">// PageView 的切换通过 controller 进行滚动</span></span><br><span class="line">        <span class="comment">// duration 表示切换滚动的时长，curve 表示滚动动画的样式，</span></span><br><span class="line">        <span class="comment">// flutter 已经在 Curves 中定义许多样式，可以自行切换查看效果</span></span><br><span class="line">        _pageController.animateToPage(_tabController.index,</span><br><span class="line">            duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">300</span>), curve: Curves.decelerate);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _tabController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">        automaticallyImplyLeading: <span class="keyword">false</span>,</span><br><span class="line">        leading: Icon(Icons.menu, color: Colors.red, size: <span class="number">30.0</span>),</span><br><span class="line"><span class="comment">//        flexibleSpace: Image.asset(&#x27;images/app_bar_hor.jpg&#x27;, fit: BoxFit.cover),</span></span><br><span class="line">        title: Text(<span class="string">&#x27;AppBar Demo&#x27;</span>, style: TextStyle(color: Colors.red)),</span><br><span class="line">        actions: &lt;Widget&gt;[</span><br><span class="line">          PopupMenuButton(</span><br><span class="line">              offset: Offset(<span class="number">50.0</span>, <span class="number">100.0</span>),</span><br><span class="line">              onSelected: (val) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;Selected item is <span class="subst">$val</span>&#x27;</span>),</span><br><span class="line">              icon: Icon(Icons.more_vert, color: Colors.red),</span><br><span class="line">              itemBuilder: (context) =&gt;</span><br><span class="line">                  <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; PopupMenuItem(value: _abs[index], child: Text(_abs[index]))))</span><br><span class="line">        ],</span><br><span class="line">        bottom: TabBar(</span><br><span class="line">            labelColor: Colors.red,</span><br><span class="line">            unselectedLabelColor: Colors.white,</span><br><span class="line">            controller: _tabController,</span><br><span class="line">            isScrollable: <span class="keyword">false</span>,</span><br><span class="line">            indicatorColor: Colors.yellow,</span><br><span class="line">            indicatorSize: TabBarIndicatorSize.tab,</span><br><span class="line">            indicatorWeight: <span class="number">5.0</span>,</span><br><span class="line">            tabs: <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; Tab(text: _abs[index], icon: Icon(Icons.android)))),</span><br><span class="line">      ),</span><br><span class="line">      <span class="comment">// 通过 body 来展示内容，body 可以传入任何 Widget，里面就是你需要展示的界面内容</span></span><br><span class="line">      <span class="comment">// 所以前面留下 Scaffold 中 body 部分的坑就解决了</span></span><br><span class="line">      body: PageView(</span><br><span class="line">        controller: _pageController,</span><br><span class="line">        children:</span><br><span class="line">            _abs.map((str) =&gt; TabChangePage(content: str)).toList(), <span class="comment">// 通过 Map 转换后再通过 toList 转换成列表，效果同 List.generate</span></span><br><span class="line">        onPageChanged: (position) &#123;</span><br><span class="line">          <span class="comment">// PageView 切换的监听，这边切换 PageView 的页面后，TabBar 也需要随之改变</span></span><br><span class="line">          <span class="comment">// 通过 tabController 来改变 TabBar 的显示位置</span></span><br><span class="line">          _tabController.index = position;</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终的效果图就不贴了，可以发现滑动 <code>PageView</code> 或者点击切换 <code>TabBar</code> 的位置，界面显示的内容都会随之改变，同时，解决前面 <code>Scaffold</code> 留下 <code>body</code> 属性没讲的一个坑，就剩下 <code>drawer</code> 、 <code>bottomNavigationBar</code> 属性没讲了，在解决这两个坑之前，我们先处理下另一个问题</p>
<p><code>Scaffold</code> 能够使我们快速去搭建一个界面，但是，并不是所有的界面都需要 <code>AppBar</code> 这个标题，那么我们就不会传入 <code>appBar</code> 的属性，我们注释 <code>_HomePageState</code> 中 <code>Scaffold</code> 的 <code>appBar</code> 传入值，把 <code>body</code> 传入的 <code>PageView</code> 修改成单个 <code>TabChangePage</code> ，然后把 <code>TabChangePage</code> 这个类做下修改，把 <code>Container</code> 的 <code>aligment</code> 属性也注释了，这样显示的内容就会显示在左上角</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _HomePageState</span></span><br><span class="line"><span class="comment">// ..</span></span><br><span class="line"><span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(body: TabChangePage(content: <span class="string">&#x27;Content&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TabChangePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> content;</span><br><span class="line">    </span><br><span class="line">  TabChangePage(&#123;Key key, <span class="keyword">this</span>.content&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(child: Text(content, style: TextStyle(color: Theme.of(context).primaryColor, fontSize: <span class="number">30.0</span>)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后运行下，「**，文字怎么被状态栏给挡了…」</p>
<p>不要慌，静下心喝杯茶，眺望下远方，这里就需要用 <code>SafeArea</code> 来处理了，在 <code>TabChangePage</code> 的 <code>Container</code> 外层加一层 <code>SafeArea</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> SafeArea(</span><br><span class="line">        child:</span><br><span class="line">            Container(child: Text(content, style: TextStyle(color: Theme.of(context).primaryColor, fontSize: <span class="number">30.0</span>))));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>然后重新运行，一切正常，<code>SafeArea</code> 的用途可以看下源码的解释</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">A widget that insets its child by sufficient padding to avoid intrusions by</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">the operating system.</span></span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">For example, this will indent the child by enough to avoid the status bar at</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">the top of the screen.</span></span></span><br></pre></td></tr></table></figure>

<p>翻译过来大概就是「给子部件和系统点击无效区域留有足够空间，比如状态栏和系统导航栏」，<code>SafeArea</code> 可以很好解决刘海屏覆盖页面内容的问题，那么到目前为止，<code>AppBar</code> 的一些坑就说的差不多了，就要解决剩下的坑了</p>
<h5 id="Scaffold-Drawer"><a href="#Scaffold-Drawer" class="headerlink" title="Scaffold - Drawer"></a>Scaffold - Drawer</h5><p><code>drawer</code> 同 <code>endDrawer</code> 属性是一样的，除了滑动的方向，<code>Drawer</code> 这个组件也相对比较简单，只要传入一个 <code>child</code> 即可，在展示之前，先对 <code>appBar</code> 做下处理，设置 <code>leading</code> 为系统默认，点击 <code>leading</code> 的时候 <code>Drawer</code> 就可以滑出来了，当然手动滑也可以</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line"><span class="comment">//        automaticallyImplyLeading: false,</span></span><br><span class="line"><span class="comment">//        leading: Icon(Icons.menu, color: Colors.red, size: 30.0),</span></span><br><span class="line"><span class="comment">//        flexibleSpace: Image.asset(&#x27;images/app_bar_hor.jpg&#x27;, fit: BoxFit.cover),</span></span><br><span class="line">        title: Text(<span class="string">&#x27;AppBar Demo&#x27;</span>, style: TextStyle(color: Colors.red)),</span><br><span class="line">        actions: &lt;Widget&gt;[</span><br><span class="line">          PopupMenuButton(</span><br><span class="line">              offset: Offset(<span class="number">50.0</span>, <span class="number">100.0</span>),</span><br><span class="line">              onSelected: (val) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;Selected item is <span class="subst">$val</span>&#x27;</span>),</span><br><span class="line">              icon: Icon(Icons.more_vert, color: Colors.red),</span><br><span class="line">              itemBuilder: (context) =&gt;</span><br><span class="line">                  <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; PopupMenuItem(value: _abs[index], child: Text(_abs[index]))))</span><br><span class="line">        ],</span><br><span class="line">        bottom: TabBar(</span><br><span class="line">            labelColor: Colors.red,</span><br><span class="line">            unselectedLabelColor: Colors.white,</span><br><span class="line">            controller: _tabController,</span><br><span class="line">            isScrollable: <span class="keyword">false</span>,</span><br><span class="line">            indicatorColor: Colors.yellow,</span><br><span class="line">            indicatorSize: TabBarIndicatorSize.tab,</span><br><span class="line">            indicatorWeight: <span class="number">5.0</span>,</span><br><span class="line">            tabs: <span class="built_in">List</span>.generate(_abs.length, (index) =&gt; Tab(text: _abs[index], icon: Icon(Icons.android)))),</span><br><span class="line">      ),</span><br><span class="line">      <span class="comment">// body ....</span></span><br><span class="line">      drawer: Drawer(</span><br><span class="line">        <span class="comment">// 记得要先添加 `SafeArea` 防止视图顶到状态栏下面</span></span><br><span class="line">        child: SafeArea(</span><br><span class="line">            child: Container(</span><br><span class="line">          child: Text(<span class="string">&#x27;Drawer&#x27;</span>, style: TextStyle(color: Theme.of(context).primaryColor, fontSize: <span class="number">30.0</span>)),</span><br><span class="line">        )),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    return Scaffold(body: TabChangePage(content: &#x27;Content&#x27;));</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>最终的效果图也不贴了，当手势从左侧滑出或者点击 <code>leading</code> 图标，抽屉就出来了</p>
<h4 id="AppBar-bottomNavigationBar"><a href="#AppBar-bottomNavigationBar" class="headerlink" title="AppBar - bottomNavigationBar"></a>AppBar - bottomNavigationBar</h4><p><code>bottomNavigarionBar</code> 可以传入一个 <code>BottomNavigationBar</code> 实例，<code>BottomNavigationBar</code> 需要传入 <code>BottomNavigationBarItem</code> 列表作为 <code>items</code> ，但是这边为了实现一个 <code>bottomNavigationBar</code> 和 <code>floatingActionButton</code> 一个特殊的组合效果，我们不使用 <code>BottomNavigationBar</code>，换做 <code>BottomAppBar</code>，直接上代码吧</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line"> Widget build(BuildContext context) &#123;</span><br><span class="line">   <span class="keyword">return</span> Scaffold(</span><br><span class="line">     <span class="comment">/// <span class="language-markdown">一样的代码省略....</span></span></span><br><span class="line">     bottomNavigationBar: BottomAppBar(</span><br><span class="line">       shape: CircularNotchedRectangle(),</span><br><span class="line">       child: Row(</span><br><span class="line">         mainAxisSize: MainAxisSize.max,</span><br><span class="line">         mainAxisAlignment: MainAxisAlignment.spaceAround,</span><br><span class="line">         children: &lt;Widget&gt;[</span><br><span class="line">           IconButton(icon: Icon(Icons.android, size: <span class="number">30.0</span>, color: Theme.of(context).primaryColor), onPressed: () &#123;&#125;),</span><br><span class="line">           IconButton(icon: Icon(Icons.people, size: <span class="number">30.0</span>, color: Theme.of(context).primaryColor), onPressed: () &#123;&#125;)</span><br><span class="line">         ],</span><br><span class="line">       ),</span><br><span class="line">     ),</span><br><span class="line">     floatingActionButton:</span><br><span class="line">         FloatingActionButton(onPressed: () =&gt; <span class="built_in">print</span>(<span class="string">&#x27;Add&#x27;</span>), child: Icon(Icons.add, color: Colors.white)),</span><br><span class="line">     <span class="comment">// FAB 的位置，一共有 7 中位置可以选择，centerDocked, endDocked, centerFloat, endFloat, endTop, startTop, miniStartTop，这边选择悬浮在 dock</span></span><br><span class="line">     floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked,</span><br><span class="line">   );</span><br></pre></td></tr></table></figure>

<p>最终的效果图：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-bd427586965c9a9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/343/format/webp" width="200" height="350" align="center"/>

<p>既然提到了 <code>StatefulWidget</code>，顺带提下两种比较简单的部件，也算是基础部件吧。<code>CheckBox</code>、<code>CheckboxListTile</code>，<code>Switch</code>、<code>SwitchListTile</code> 因为比较简单，就直接上代码了，里面都有完整的注释</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheckSwitchDemoPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _CheckSwitchDemoPageState createState() =&gt; _CheckSwitchDemoPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_CheckSwitchDemoPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">CheckSwitchDemoPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> _isChecked = <span class="keyword">false</span>;</span><br><span class="line">  <span class="keyword">var</span> _isTitleChecked = <span class="keyword">false</span>;</span><br><span class="line">  <span class="keyword">var</span> _isOn = <span class="keyword">false</span>;</span><br><span class="line">  <span class="keyword">var</span> _isTitleOn = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;Check Switch Demo&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Column(children: &lt;Widget&gt;[</span><br><span class="line">        Row(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Checkbox(</span><br><span class="line">              <span class="comment">// 是否开启三态</span></span><br><span class="line">              tristate: <span class="keyword">true</span>,</span><br><span class="line">              <span class="comment">// 控制当前 checkbox 的开启状态</span></span><br><span class="line">              value: _isChecked,</span><br><span class="line">              <span class="comment">// 不设置该方法，处于不可用状态</span></span><br><span class="line">              onChanged: (checked) &#123;</span><br><span class="line">                <span class="comment">// 管理状态值</span></span><br><span class="line">                setState(() =&gt; _isChecked = checked);</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="comment">// 选中时的颜色</span></span><br><span class="line">              activeColor: Colors.pink,</span><br><span class="line">              <span class="comment">// 这个值有 padded 和 shrinkWrap 两个值，</span></span><br><span class="line">              <span class="comment">// padded 时候所占有的空间比 shrinkWrap 大，别的原谅我没看出啥</span></span><br><span class="line">              materialTapTargetSize: MaterialTapTargetSize.shrinkWrap,</span><br><span class="line">            ),</span><br><span class="line"></span><br><span class="line">            <span class="comment">/// <span class="language-markdown">点击无响应</span></span></span><br><span class="line">            Checkbox(value: _isChecked, onChanged: <span class="keyword">null</span>, tristate: <span class="keyword">true</span>)</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Row(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Switch(</span><br><span class="line">                <span class="comment">// 开启时候，那个条的颜色</span></span><br><span class="line">                activeTrackColor: Colors.yellow,</span><br><span class="line">                <span class="comment">// 关闭时候，那个条的颜色</span></span><br><span class="line">                inactiveTrackColor: Colors.yellow[<span class="number">200</span>],</span><br><span class="line">                <span class="comment">// 设置指示器的图片，当然也有 color 可以设置</span></span><br><span class="line">                activeThumbImage: AssetImage(<span class="string">&#x27;images/ali.jpg&#x27;</span>),</span><br><span class="line">                inactiveThumbImage: AssetImage(<span class="string">&#x27;images/ali.jpg&#x27;</span>),</span><br><span class="line">                <span class="comment">// 开始时候的颜色，貌似会被 activeTrackColor 顶掉</span></span><br><span class="line">                activeColor: Colors.pink,</span><br><span class="line">                materialTapTargetSize: MaterialTapTargetSize.shrinkWrap,</span><br><span class="line">                value: _isOn,</span><br><span class="line">                onChanged: (onState) &#123;</span><br><span class="line">                  setState(() =&gt; _isOn = onState);</span><br><span class="line">                &#125;),</span><br><span class="line"></span><br><span class="line">            <span class="comment">/// <span class="language-markdown">点击无响应</span></span></span><br><span class="line">            Switch(value: _isOn, onChanged: <span class="keyword">null</span>)</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        CheckboxListTile(</span><br><span class="line">          <span class="comment">// 描述选项</span></span><br><span class="line">          title: Text(<span class="string">&#x27;Make this item checked&#x27;</span>),</span><br><span class="line">          <span class="comment">// 二级描述</span></span><br><span class="line">          subtitle: Text(<span class="string">&#x27;description...description...\ndescription...description...&#x27;</span>),</span><br><span class="line">          <span class="comment">// 和 checkbox 对立边的部件，例如 checkbox 在头部，则 secondary 在尾部</span></span><br><span class="line">          secondary: Image.asset(<span class="string">&#x27;images/ali.jpg&#x27;</span>, width: <span class="number">30.0</span>, height: <span class="number">30.0</span>),</span><br><span class="line">          value: _isTitleChecked,</span><br><span class="line">          <span class="comment">// title 和 subtitle 是否为垂直密集列表中一员，最明显就是部件会变小</span></span><br><span class="line">          dense: <span class="keyword">true</span>,</span><br><span class="line">          <span class="comment">// 是否需要使用 3 行的高度，该值为 true 时候，subtitle 不可为空</span></span><br><span class="line">          isThreeLine: <span class="keyword">true</span>,</span><br><span class="line">          <span class="comment">// 控制 checkbox 选择框是在前面还是后面</span></span><br><span class="line">          controlAffinity: ListTileControlAffinity.leading,</span><br><span class="line">          <span class="comment">// 是否将主题色应用到文字或者图标</span></span><br><span class="line">          selected: <span class="keyword">true</span>,</span><br><span class="line">          onChanged: (checked) &#123;</span><br><span class="line">            setState(() =&gt; _isTitleChecked = checked);</span><br><span class="line">          &#125;,</span><br><span class="line">        ),</span><br><span class="line">        SwitchListTile(</span><br><span class="line">            title: Text(<span class="string">&#x27;Turn On this item&#x27;</span>),</span><br><span class="line">            subtitle: Text(<span class="string">&#x27;description...description...\ndescription...description...&#x27;</span>),</span><br><span class="line">            secondary: Image.asset(<span class="string">&#x27;images/ali.jpg&#x27;</span>, width: <span class="number">30.0</span>, height: <span class="number">30.0</span>),</span><br><span class="line">            isThreeLine: <span class="keyword">true</span>,</span><br><span class="line">            value: _isTitleOn,</span><br><span class="line">            selected: <span class="keyword">true</span>,</span><br><span class="line">            onChanged: (onState) &#123;</span><br><span class="line">              setState(() =&gt; _isTitleOn = onState);</span><br><span class="line">            &#125;)</span><br><span class="line">      ]),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://upload-images.jianshu.io/upload_images/2888797-ff5f58911caf0007.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/338/format/webp" width="200" height="350" align="center"/>

<p><em>该部分代码查看 <code>checkbox_swicth_main.dart</code> 文件</em></p>
<p>终于这节把 <code>Scaffold</code> 留下的坑都填完了，然后又讲了两种基础部件，下节要填留下的别的坑了，目测还留了 2 个大坑，那就等以后继续解决吧~</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/11/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-03/" data-id="cl0ukmc2m000apn1gdhr24y8a" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/09/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-02/" class="article-date">
  <time datetime="2019-03-08T16:18:28.000Z" itemprop="datePublished">2019-03-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/09/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-02/">Flutter Guide(02) -- 认识 Flutter App</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上一节介绍了 <code>Dart</code> 的一些语法，以及配置环境的网址，这节我们就可以开始了解下 <code>Flutter</code> 了</p>
<p>主要包括 <code>MaterialApp</code>、<code>Scaffold</code>、<code>Text</code>、<code>Image</code>、<code>Icon</code>、<code>Button</code> 以及 <code>AppBar</code> 部分内容，准备出发~</p>
<h4 id="Flutter-runApp"><a href="#Flutter-runApp" class="headerlink" title="Flutter runApp"></a>Flutter runApp</h4><p>新建 flutter 项目后，可以看到 lib 下的 main.dart 中 <code>void main() =&gt; runApp(MyApp());</code> 这句就是程序的入口了。这里可以简单看下源码</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> runApp(Widget app) &#123;</span><br><span class="line">  WidgetsFlutterBinding.ensureInitialized()</span><br><span class="line">    ..attachRootWidget(app)</span><br><span class="line">    ..scheduleWarmUpFrame();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///<span class="language-markdown">....</span></span></span><br><span class="line"><span class="keyword">static</span> WidgetsBinding ensureInitialized() &#123;</span><br><span class="line">  <span class="keyword">if</span> (WidgetsBinding.instance == <span class="keyword">null</span>)</span><br><span class="line">    WidgetsFlutterBinding();</span><br><span class="line">  <span class="keyword">return</span> WidgetsBinding.instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///<span class="language-markdown">....</span></span></span><br><span class="line"><span class="keyword">void</span> attachRootWidget(Widget rootWidget) &#123;</span><br><span class="line">  _renderViewElement = RenderObjectToWidgetAdapter&lt;RenderBox&gt;(</span><br><span class="line">    container: renderView,</span><br><span class="line">    debugShortDescription: <span class="string">&#x27;[root]&#x27;</span>,</span><br><span class="line">    child: rootWidget</span><br><span class="line">  ).attachToRenderTree(buildOwner, renderViewElement);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先会创建一个 <code>WidgetsBinding</code> 单例对象，然后把传入的 App 添加到 <code>rootWidget</code> 中，<code>scheduleWarmUpFrame</code> 方法比较长，这边看下对该方法的注释第一句就能了解方法的主要功能了</p>
<blockquote>
<p>Schedule a frame to run as soon as possible </p>
</blockquote>
<p>「安排框架尽快运行起来」(原谅我这渣英语，只能看懂不会翻译..大概就是「快速启动框架」的意思吧)</p>
<h4 id="Flutter-App"><a href="#Flutter-App" class="headerlink" title="Flutter App"></a>Flutter App</h4><p>接着看下 <code>MyApp</code> 这个类，继承自 <code>StatelessWidget</code> 并在 <code>build</code> 方法返回一个 <code>MaterialApp</code> 实例，(偷偷讲下，其实这边还可以返回 <code>CupertinoApp</code>，这是一个 iOS 风格的 widget，基本上你看到部件带 「Cupertino」的都是 iOS 风格的 widget，这里先不讲 iOS 风格的部件，目前 flutter 对 Cupertino 系列的 widget 支持不是很好，包括部件的广度，多语言的支持等等方面都不是很友好，所以我们还是继续看 MD 风格的 Android 部件吧~)，这里先看下 <code>MaterialApp</code> 的构造函数，介绍一些常用的参数</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MaterialApp(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.navigatorKey,</span><br><span class="line">    <span class="keyword">this</span>.home, <span class="comment">// 主界面的内容 widget</span></span><br><span class="line">    <span class="keyword">this</span>.routes = <span class="keyword">const</span> &lt;<span class="built_in">String</span>, WidgetBuilder&gt;&#123;&#125;, <span class="comment">// 带 router 和路由跳转有关</span></span><br><span class="line">    <span class="keyword">this</span>.initialRoute,</span><br><span class="line">    <span class="keyword">this</span>.onGenerateRoute,</span><br><span class="line">    <span class="keyword">this</span>.onUnknownRoute,</span><br><span class="line">    <span class="keyword">this</span>.navigatorObservers = <span class="keyword">const</span> &lt;NavigatorObserver&gt;[], </span><br><span class="line">    <span class="keyword">this</span>.builder,</span><br><span class="line">    <span class="keyword">this</span>.title = <span class="string">&#x27;&#x27;</span>, <span class="comment">// *类似标题</span></span><br><span class="line">    <span class="keyword">this</span>.onGenerateTitle, <span class="comment">// 主要用于多语言情况下，需要根据当前语言替换 title，需要使用该值</span></span><br><span class="line">    <span class="keyword">this</span>.color, <span class="comment">// 主题色，如果该值未设置，取 theme.primaryColor,未设置 theme 则取蓝色</span></span><br><span class="line">    <span class="keyword">this</span>.theme, <span class="comment">// App 的主题风格，包括主题色，按钮默认颜色等等</span></span><br><span class="line">    <span class="keyword">this</span>.locale, <span class="comment">// 带 locale 的和多语言适配相关</span></span><br><span class="line">    <span class="keyword">this</span>.localizationsDelegates,</span><br><span class="line">    <span class="keyword">this</span>.localeListResolutionCallback,</span><br><span class="line">    <span class="keyword">this</span>.localeResolutionCallback,</span><br><span class="line">    <span class="keyword">this</span>.supportedLocales = <span class="keyword">const</span> &lt;Locale&gt;[Locale(<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;US&#x27;</span>)],</span><br><span class="line">    <span class="keyword">this</span>.debugShowMaterialGrid = <span class="keyword">false</span>, </span><br><span class="line">    <span class="keyword">this</span>.showPerformanceOverlay = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.checkerboardRasterCacheImages = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.checkerboardOffscreenLayers = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.showSemanticsDebugger = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.debugShowCheckedModeBanner = <span class="keyword">true</span>, <span class="comment">// debug 模式下，是否显示 DEBUG 标示横幅</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p><code>MaterialApp</code> 继承自 <code>StatefulWidget</code>，它和 <code>MyApp</code> 所继承的类 <code>StatelessWidget</code>，就是日常开发中，自定义部件通常继承的抽象类了。</p>
<ol>
<li><code>StatelessWidget</code> 是状态不可变部件，通过其构建的部件一般用来展示固定内容，例如需要展示固定的功能按钮列表，不需要根据不同界面状态进行修改其展示内容</li>
<li><code>StatefulWidget</code> 是可改变状态的部件，比如我们需要通过网络或者数据库获取数据，然后修改部件锁展示的数据内容，则需要通过 <code>StatefulWidget</code> 来构建。当然，不是说 <code>StatelessWidget</code> 不能实现修改界面数据的功能，这就需要涉及到 <strong>状态管理</strong> 的概念了，后面有机会再讲，这边先埋坑【坑1】</li>
</ol>
<h4 id="Flutter-Scaffold"><a href="#Flutter-Scaffold" class="headerlink" title="Flutter Scaffold"></a>Flutter Scaffold</h4><p>进入 <code>App</code> 后就需要构建界面了，<code>Flutter</code> 提供了 <code>Scaffold</code> 来快速构建一个 <code>MaterialDesign</code> 风格的界面，还是先看下 <code>Scaffold</code> 的构造函数吧，了解几个比较常用的部分。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Scaffold(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.appBar, <span class="comment">// 界面顶部的那条栏，这边需要返回一个 AppBar 实例</span></span><br><span class="line">    <span class="keyword">this</span>.body, <span class="comment">// 界面的内容部分</span></span><br><span class="line">    <span class="keyword">this</span>.floatingActionButton, <span class="comment">// 悬浮部分，可以通过 floatingActionButtonLocation 设置位置</span></span><br><span class="line">    <span class="keyword">this</span>.floatingActionButtonLocation,</span><br><span class="line">    <span class="keyword">this</span>.floatingActionButtonAnimator,</span><br><span class="line">    <span class="keyword">this</span>.persistentFooterButtons,</span><br><span class="line">    <span class="keyword">this</span>.drawer, <span class="comment">// 侧滑抽屉部分，从左侧滑出(应该和语言有关，和文字方向同向)</span></span><br><span class="line">    <span class="keyword">this</span>.endDrawer, <span class="comment">// 侧滑抽屉部分，从右侧滑出</span></span><br><span class="line">    <span class="keyword">this</span>.bottomNavigationBar, <span class="comment">// 底部导航栏，就是通常看到的底部 TAB 切换部件</span></span><br><span class="line">    <span class="keyword">this</span>.bottomSheet, <span class="comment">// 展示从底部弹出的，起到提示作用的，通过 showModalBottomSheet 展示</span></span><br><span class="line">    <span class="keyword">this</span>.backgroundColor, <span class="comment">// 界面的背景色</span></span><br><span class="line">    <span class="keyword">this</span>.resizeToAvoidBottomPadding = <span class="keyword">true</span>, <span class="comment">// 避免 body 被底部弹出部件填充，例如输入法键盘</span></span><br><span class="line">    <span class="keyword">this</span>.primary = <span class="keyword">true</span>, <span class="comment">// 当前的 Scaffold 是否需要被展示在屏幕最上层</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>来张图吧，简洁明了</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-9f3820d96dae7a54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/345/format/webp" width="200" height="350" align="center"/>

<p>了解完 <code>Scaffold</code> 的整体构造后，我们从上到下，通过构造函数来了解下各个 <code>Widget</code> 的使用方法</p>
<h5 id="AppBar"><a href="#AppBar" class="headerlink" title="AppBar"></a>AppBar</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">AppBar(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.leading, <span class="comment">// 用于设置 AppBar 前置的按钮，例如设置返回我们需要的返回按钮等</span></span><br><span class="line">    <span class="keyword">this</span>.automaticallyImplyLeading = <span class="keyword">true</span>, <span class="comment">// 是否使用系统默认生成的按钮，如果替换 leading 的默认按钮，最好将该属性设置成 false</span></span><br><span class="line">    <span class="keyword">this</span>.title, <span class="comment">// AppBar 所需要展示的组件，传入一个 Widget 实例，通常使用 Text 展示一个标题</span></span><br><span class="line">    <span class="keyword">this</span>.actions, <span class="comment">// AppBar 末尾悬浮的一些操作组件，例如常见的会在末尾设置一个「...」按钮，点击弹出一个 menue 提供给用户操作选择</span></span><br><span class="line">    <span class="keyword">this</span>.flexibleSpace, <span class="comment">// AppBar 的背景，可以设置颜色，背景图等等 </span></span><br><span class="line">    <span class="keyword">this</span>.bottom, <span class="comment">// bottom 用于展示顶部导航 TAB</span></span><br><span class="line">    <span class="keyword">this</span>.elevation = <span class="number">4.0</span>,</span><br><span class="line">    <span class="keyword">this</span>.backgroundColor, <span class="comment">// AppBar 的背景色，如果只需要修改颜色，可以不通过 flexibleSpace 修改</span></span><br><span class="line">    <span class="keyword">this</span>.brightness,</span><br><span class="line">    <span class="keyword">this</span>.iconTheme, <span class="comment">// 按钮的默认样式</span></span><br><span class="line">    <span class="keyword">this</span>.textTheme, <span class="comment">// 文字的默认样式</span></span><br><span class="line">    <span class="keyword">this</span>.primary = <span class="keyword">true</span>,</span><br><span class="line">    <span class="keyword">this</span>.centerTitle, <span class="comment">// 是否将展示的 title 居中</span></span><br><span class="line">    <span class="keyword">this</span>.titleSpacing = NavigationToolbar.kMiddleSpacing, <span class="comment">// AppBar title 两侧的空白间隔</span></span><br><span class="line">    <span class="keyword">this</span>.toolbarOpacity = <span class="number">1.0</span>,</span><br><span class="line">    <span class="keyword">this</span>.bottomOpacity = <span class="number">1.0</span>,</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>在展示 <code>AppBar</code> 的 <code>demo</code> 之前，我们先学习几个基本的组件 <strong><code>Text</code>、<code>Image</code>、<code>Icon</code>、<code>Button</code></strong> 分布用于展示文字，图片，图标，按钮</p>
<h5 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Text(<span class="keyword">this</span>.data, &#123; <span class="comment">// Text 需要展示的文字</span></span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.style, <span class="comment">// 文字的样式，包括颜色，大小，间距等等属性，这边就不继续展示 TextStyle 构造函数了，不然我怕大家都不想继续看了，稍后通过例子来说明</span></span><br><span class="line">    <span class="keyword">this</span>.textAlign, <span class="comment">// 文字的对齐方式，包括左对齐，右对齐，居中等，详见 TextAlign 类</span></span><br><span class="line">    <span class="keyword">this</span>.textDirection, <span class="comment">// 文字方向，ltr(left to right) 或者 rtl(right to left)</span></span><br><span class="line">    <span class="keyword">this</span>.locale, </span><br><span class="line">    <span class="keyword">this</span>.softWrap, <span class="comment">// 当文字一行显示不完是否换行</span></span><br><span class="line">    <span class="keyword">this</span>.overflow, <span class="comment">// 如果超出限制的行数，以哪种方式省略未展示的内容</span></span><br><span class="line">    <span class="keyword">this</span>.textScaleFactor, <span class="comment">// 文字缩放比例</span></span><br><span class="line">    <span class="keyword">this</span>.maxLines, <span class="comment">// 最多展示的行数</span></span><br><span class="line">    <span class="keyword">this</span>.semanticsLabel,</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>说了那么多，相信很多小伙伴都要急着撸代码了吧，接着来展示一些 <code>Text</code> 的示例，接下来的例子都会直接替换 <code>HomePage</code> 内的展示内容，其余都是相同的，接下来请关注 <code>Text</code> 别的部件先忽略，后面会介绍，这边先埋坑【坑2】</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(DemoApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">&#x27;Flutter Demo&#x27;</span>,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">      theme: ThemeData(primarySwatch: Colors.lightBlue),</span><br><span class="line">      home: HomePage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">        appBar: AppBar(),</span><br><span class="line">        body: Container(</span><br><span class="line">          padding: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10.0</span>),</span><br><span class="line">          child: Center(</span><br><span class="line">              child: Column(</span><br><span class="line">            mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              Text(<span class="string">&#x27;绿色背景黑色文字展示&#x27;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                      color: Colors.black, <span class="comment">// 设置文字颜色，不可和 foreground 同时设置</span></span><br><span class="line">                      fontSize: <span class="number">24.0</span>, <span class="comment">// 字体大小</span></span><br><span class="line">                      letterSpacing: <span class="number">2.0</span>, <span class="comment">// 每个字符之间的间隔</span></span><br><span class="line">                      background: Paint()..color = Colors.green)), <span class="comment">// 背景色</span></span><br><span class="line">              Text(<span class="string">&#x27;这是一个带红色下划线的文字展示&#x27;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                      color: Colors.black,</span><br><span class="line">                      fontSize: <span class="number">24.0</span>,</span><br><span class="line">                      <span class="comment">// 文字装饰线，除了 underline 还有 overline, lineThrough，</span></span><br><span class="line">                      <span class="comment">// 不同的样式小伙伴可以通过自己修改代码来查看</span></span><br><span class="line">                      decoration: TextDecoration.underline,</span><br><span class="line">                      <span class="comment">// 文字装饰线的类型，除了 solid 还有 double,dotted,dashed,wavy 可选</span></span><br><span class="line">                      decorationStyle: TextDecorationStyle.solid,</span><br><span class="line">                      <span class="comment">// 装饰线的颜色</span></span><br><span class="line">                      decorationColor: Colors.red))</span><br><span class="line">            ],</span><br><span class="line">          )),</span><br><span class="line">        ));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>该部分代码查看源码 <code>text_main.dart</code> 文件</em></p>
<p>最后的展示效果如下图：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-bb16e7da4f522bab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/343/format/webp" width="200" height="350" align="center"/>

<h5 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h5><p>&#x2F;坏笑  按照惯例，我们还是先看下 <code>Image</code> 的构造函数吧</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Image(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="comment">// 一个 ImageProvider 实例，但是 ImageProvider 是一个抽象类，Flutter 已经给我们提供如下</span></span><br><span class="line">    <span class="comment">// AssetImage，NetworkImage，FileImage，MemoryImage 这四种图片加载器，为了方便调用</span></span><br><span class="line">    <span class="comment">// 我们可以直接通过 Image.asset, Image.network, Image.file, Image.memory 简化，</span></span><br><span class="line">    <span class="comment">// 通过方法名，可以看出分别从 asset 文件，网络，文件，内存中加载图片</span></span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.image, </span><br><span class="line">    <span class="keyword">this</span>.semanticLabel,</span><br><span class="line">    <span class="keyword">this</span>.excludeFromSemantics = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.width, <span class="comment">// 图片宽度</span></span><br><span class="line">    <span class="keyword">this</span>.height, <span class="comment">// 图片高度</span></span><br><span class="line">    <span class="keyword">this</span>.color, <span class="comment">// 图片背景色</span></span><br><span class="line">    <span class="keyword">this</span>.colorBlendMode, <span class="comment">// color 和图片的混合模式(这个值比较多，可以一个个尝试)</span></span><br><span class="line">    <span class="keyword">this</span>.fit, <span class="comment">// 图片填充方式 fill, cover, contain, fillWidth, fillHeight, scaleDown, none</span></span><br><span class="line">    <span class="keyword">this</span>.alignment = Alignment.center, <span class="comment">// 对齐方式</span></span><br><span class="line">    <span class="keyword">this</span>.repeat = ImageRepeat.noRepeat, <span class="comment">// 若未填充满空间，重复展示的方式</span></span><br><span class="line">    <span class="keyword">this</span>.centerSlice,</span><br><span class="line">    <span class="keyword">this</span>.matchTextDirection = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.gaplessPlayback = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.filterQuality = FilterQuality.low,</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>好了好了，我知道你们又想自己写代码尝试下了，在这之前，需要你先准备一张本地图片，然后在项目的根目录，也就是 <code>lib</code> 文件夹同层，创建一个新的文件夹，命名为 <code>images</code>，把你准备好的图片放到这个目录下。放好之后打开 <code>pubspec.yaml</code> 把图片资源文件注册下</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The following section is specific to Flutter.</span></span><br><span class="line"><span class="attr">flutter:</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># The following line ensures that the Material Icons font is</span></span><br><span class="line">  <span class="comment"># included with your application, so that you can use the icons in</span></span><br><span class="line">  <span class="comment"># the material Icons class.</span></span><br><span class="line">  <span class="attr">uses-material-design:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 这边注册资源文件，以后有图片文件也可以只注册 images 文件夹，会自动读取内部的文件</span></span><br><span class="line">  <span class="attr">assets:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">images/ali.jpg</span></span><br></pre></td></tr></table></figure>

<p>注册完成后，就可以继续愉快的撸代码了~</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> _assetAli = <span class="string">&#x27;images/ali.jpg&#x27;</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> _picUrl =</span><br><span class="line">      <span class="string">&#x27;https://timg05.bdimg.com/timg?wapbaike&amp;quality=60&amp;size=b1440_952&amp;cut_x=143&amp;cut_y=0&amp;cut_w=1633&amp;&#x27;</span></span><br><span class="line">      <span class="string">&#x27;cut_h=1080&amp;sec=1349839550&amp;di=cbbc175a45ccec5482ce2cff09a3ae34&amp;&#x27;</span></span><br><span class="line">      <span class="string">&#x27;src=http://imgsrc.baidu.com/baike/pic/item/4afbfbedab64034f104872baa7c379310b551d80.jpg&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">        appBar: AppBar(),</span><br><span class="line">        body: Container(</span><br><span class="line">          padding: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10.0</span>),</span><br><span class="line">          child: Center(</span><br><span class="line">              child: Column(</span><br><span class="line">            mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              <span class="comment">// 这种展示图片方式和下一种会有相同的效果</span></span><br><span class="line">              Image(image: AssetImage(_assetAli), width: <span class="number">80.0</span>, height: <span class="number">80.0</span>),</span><br><span class="line">              <span class="comment">// 接下来加载图片都会使用这些比较方便的方法</span></span><br><span class="line">              Image.asset(_assetAli, width: <span class="number">80.0</span>, height: <span class="number">80.0</span>),</span><br><span class="line">              <span class="comment">// 加载一张网络图片</span></span><br><span class="line">              Image.network(_picUrl,</span><br><span class="line">                  height: <span class="number">80.0</span>,</span><br><span class="line">                  <span class="comment">// 横向重复</span></span><br><span class="line">                  repeat: ImageRepeat.repeatX,</span><br><span class="line">                  <span class="comment">// MediaQuery.of(context).size 获取到的为上层容器的宽高</span></span><br><span class="line">                  width: MediaQuery.of(context).size.width),</span><br><span class="line">              <span class="comment">// 通过设置混合模式，可以看到图片展示的样式已经修改</span></span><br><span class="line">              Image.asset(_assetAli,</span><br><span class="line">                  width: <span class="number">80.0</span>, height: <span class="number">80.0</span>, color: Colors.green, colorBlendMode: BlendMode.colorDodge),</span><br><span class="line">              <span class="comment">// 会优先加载指定的 asset 图片，然后等网络图片读取成功后加载网络图片，会通过渐隐渐现方式展现</span></span><br><span class="line">              <span class="comment">// cover 方式按照较小的边布满，较大的给切割</span></span><br><span class="line">              <span class="comment">// contain 会按照最大的边布满，较小的会被留白</span></span><br><span class="line">              <span class="comment">// fill 会把较大的一边压缩</span></span><br><span class="line">              <span class="comment">// fitHeight, fitWidth 分别按照长宽来布满</span></span><br><span class="line">              FadeInImage.assetNetwork(</span><br><span class="line">                  placeholder: _assetAli, image: _picUrl, width: <span class="number">120.0</span>, height: <span class="number">120.0</span>, fit: BoxFit.cover),</span><br><span class="line">              <span class="comment">// Icon 相对属性少了很多，需要传入一个 IconData 实例，flutter 提供了很多图标，</span></span><br><span class="line">              <span class="comment">// 但是实际情况我们需要加入我们自己的图标，这边再埋坑【坑3】</span></span><br><span class="line">              <span class="comment">// size 为图标显示的大小，color 为图标的颜色，这边通过 Theme 获取主题色调</span></span><br><span class="line">              Icon(Icons.android, size: <span class="number">40.0</span>, color: Theme.of(context).primaryColorDark)</span><br><span class="line">            ],</span><br><span class="line">          )),</span><br><span class="line">        ));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>该部分代码查看源码 <code>image_main.dart</code> 文件</em></p>
<p>最后的效果如下：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-100b094be03e05fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/344/format/webp" width="200" height="350" align="center"/>

<h5 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h5><p><code>Flutter</code> 提供了各种类型的 <code>Button</code> 几乎是大同小异的，这边就抽取一些比较常用的展示下效果，常用的主要有 <code>RaisedButton</code> 、<code>FlatButton</code>、<code>IconButton</code>、<code>OutlineButton</code>、<code>MaterialButton</code>、<code>FloatActionButton</code>、<code>FloatingActionButton.extended</code> </p>
<p><code>Button</code> 都有一个 <code>onPress</code> 参数，是 <code>VoidCallback</code> 类型的参数，通过查看源码可以知道 <code>VoidCallback</code> 是无参无返回值的一种类型参数。如果该参数传入的值为 <code>null</code> 那么这个按钮的就不可点击状态，无点击效果，等会可以在例子中查看。还有就是 <code>child</code> 参数，这里就是传入你需要展示的内容，比如 <code>Text</code>、<code>Icon</code> 等等。别的参数基本可以通过参数名了解，这边不扩展了(再看源码我怕你们都不想继续看下去了…)</p>
<blockquote>
<p>Talk is cheap, show me the code</p>
</blockquote>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(),</span><br><span class="line">      body: Container(</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10.0</span>),</span><br><span class="line">        child: Center(</span><br><span class="line">            child: Column(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            RaisedButton(</span><br><span class="line">              onPressed: () &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;This is a Rased Button can be clicked&#x27;</span>);</span><br><span class="line">              &#125;,</span><br><span class="line">              child: Text(<span class="string">&#x27;Raised Enable&#x27;</span>),</span><br><span class="line">            ),</span><br><span class="line">            RaisedButton(onPressed: <span class="keyword">null</span>, child: Text(<span class="string">&#x27;Raised Disable&#x27;</span>)),</span><br><span class="line">            FlatButton(</span><br><span class="line">              onPressed: () =&gt; <span class="built_in">print</span>(<span class="string">&#x27;This is a Flat Button can be clicker&#x27;</span>),</span><br><span class="line">              child: Text(<span class="string">&#x27;Flat Enable&#x27;</span>),</span><br><span class="line">            ),</span><br><span class="line">            FlatButton(onPressed: <span class="keyword">null</span>, child: Text(<span class="string">&#x27;Flat Disable&#x27;</span>)),</span><br><span class="line">            IconButton(icon: Icon(Icons.android), onPressed: () &#123;&#125;),</span><br><span class="line">            IconButton(icon: Icon(Icons.android), onPressed: <span class="keyword">null</span>),</span><br><span class="line">            MaterialButton(onPressed: () &#123;&#125;, child: Text(<span class="string">&#x27;Material Enable&#x27;</span>)),</span><br><span class="line">            MaterialButton(onPressed: <span class="keyword">null</span>, child: Text(<span class="string">&#x27;Material Disable&#x27;</span>)),</span><br><span class="line">            OutlineButton(onPressed: () &#123;&#125;, child: Text(<span class="string">&#x27;Outline Enable&#x27;</span>)),</span><br><span class="line">            OutlineButton(onPressed: <span class="keyword">null</span>, child: Text(<span class="string">&#x27;Outline Enable&#x27;</span>)),</span><br><span class="line">          ],</span><br><span class="line">        )),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton:</span><br><span class="line">          FloatingActionButton.extended(onPressed: () &#123;&#125;, icon: Icon(Icons.android), label: Text(<span class="string">&#x27;Android&#x27;</span>)),</span><br><span class="line">      floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>该部分代码查看源码 <code>button_main.dart</code> 部分</em></p>
<p>最终的效果图：</p>
<img src="https://upload-images.jianshu.io/upload_images/2888797-89402bcc7cb1738a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/369/format/webp" width="200" height="350" align="center"/>

<p>这篇终于到末尾了，最后留了 3 个坑等以后解决</p>
<p>最后代码的地址还是要的：</p>
<ol>
<li><p>文章中涉及的代码：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_arts_demos_app">demos</a></p>
</li>
<li><p>基于郭神 <code>cool weather</code> 接口的一个项目，实现 <code>BLoC</code> 模式，实现状态管理：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_weather">flutter_weather</a></p>
</li>
<li><p>一个课程(当时买了想看下代码规范的，代码更新会比较慢，虽然是跟着课上的一些写代码，但是还是做了自己的修改，很多地方看着不舒服，然后就改成自己的实现方式了)：<a target="_blank" rel="noopener" href="https://github.com/kukyxs/flutter_shop">flutter_shop</a></p>
</li>
</ol>
<p>如果对你有帮助的话，记得给个 <strong>Star</strong>，先谢过，你的认可就是支持我继续写下去的动力~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/09/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-02/" data-id="cl0ukmc2l0009pn1g8zqkhq2c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-入门指北-01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/09/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-01/" class="article-date">
  <time datetime="2019-03-08T16:06:22.000Z" itemprop="datePublished">2019-03-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/09/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-01/">Flutter Guide(01) -- Start With Dart</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近 <code>Flutter</code> 真心火爆到不要不要的，随大流，学一波，在这之前，对于语言的语法还是需要有些必要的了解的，<code>Dart</code> 这门语言，说实话对于会 <code>Java</code> 这类面向对象的语言的小伙伴们来说，真的灰常灰常简单，这边我总结了一些 <code>Dart</code> 和 <code>Java</code> 的一些语法差异，当然，只是部分，但是，按照我目前的学习进度来说，了解了这些对于写 <code>Flutter</code> 项目绝对够了。小伙伴也可以自己查看，我这边提供一个自己学习的网址 <a target="_blank" rel="noopener" href="http://dart.goodev.org/guides/language">Dart 快速入门</a></p>
<p>温馨提示：本篇文章<strong>没有图，没有图，没有图</strong>，可能会造成部分不适，<strong>请注意，请注意，请注意</strong>，系好安全带，我们要「开车了」……</p>
<h5 id="1-Variables"><a href="#1-Variables" class="headerlink" title="1. Variables"></a>1. Variables</h5><p><code>Dart</code> 变量类型可以通过具体的赋值进行推导，例如：<code>var name = &#39;kuky&#39;</code> 则定义了一个 <code>String</code> 类型对象 <code>name</code>，也可以通过指定具体的类型 <code>String name = &#39;kuky&#39;</code>，如果没有初始化变量，则默认值为 null，类型为数字的变量默认值同为 <code>null</code>（**同 <code>java</code> 不同，<code>java</code> 中 <code>int</code> 默认为 0.**）如果需要定义常量，可以通过 <code>final</code> 和 <code>const</code> 进行定义，<code>final</code> 变量只能赋值一次，<code>const</code> 是编译时常量。</p>
<h5 id="2-Build-in-types"><a href="#2-Build-in-types" class="headerlink" title="2. Build-in-types"></a>2. Build-in-types</h5><p><code>Dart</code> 内置类型包括 ：</p>
<ul>
<li><p><code>Numbers </code>    包括 <code>int</code>[-2^53 ~ 2^53]， <code>double</code>[64-bit 浮点数]</p>
</li>
<li><p><code>Strings</code>    <code>Dart</code> 字符串是 <code>UTF-16</code> 编码的字符序列， 可以使用单引号或者双引号来创建字符串。</p>
<ol>
<li>通过 <code>==</code> 判断两个字符串是否相同</li>
<li>通过三对单引号<code>&#39;&#39;&#39;aaa&#39;&#39;&#39;</code>或者双引号<code>&quot;&quot;&quot;aaa&quot;&quot;&quot;</code>可以创建多行字符串对象</li>
<li>使用前缀 <code>r</code> 创建 <code>raw string</code>，字符串内不会进行转义，例如：<code>var a = r&#39;haha \n breakLine&#39;</code> 打印 <code>a</code> 对象则会按照输入的输出，不会进行换行</li>
</ol>
</li>
<li><p><code>Booleans</code>    <code>Dart</code> 中，只有 <code>true</code> 对象才被认为是 <code>true</code>， 所有其他的值都是 <code>false</code></p>
</li>
<li><p><code>Lists</code>    列表，例如：<code>var list = [1, 2, 3, 4]</code></p>
<pre><code>通过 `const` 关键词可以定义一个不可变列表 `var list = const [1, 2, 3, 4]`

  参数化定义`var name = &lt;String&gt;[&#39;Jone&#39;, &#39;Jack&#39;]`
</code></pre>
</li>
<li><p><code>Maps</code>    键值对，例如：<code>var map = &#123;&#39;one&#39;: 1, &#39;two&#39;: 2&#125;</code></p>
<pre><code>如果键值对需要添加新的键值对，直接指定即可，`map[&#39;three&#39;] = 3`，若查找的键不存在，返回 `null`

  参数化定义 `var map = &lt;String, int&gt;&#123;&#39;one&#39;: 1, &#39;two&#39;: 2&#125;`
</code></pre>
</li>
<li><p><code>Runes</code>    代表字符串的 <code>UTF-32 code points</code>，通常使用 <code>\uXXXX</code> 的方式来表示 Unicode code point， XXXX 是4个 16 进制的数，例如 <code>\u2665</code> 返回心形符号 (♥)</p>
</li>
<li><p><code>Symbols</code>    代表 Dart 程序中声明的操作符或者标识符，几乎不使用</p>
</li>
</ul>
<h5 id="3-Function"><a href="#3-Function" class="headerlink" title="3. Function"></a>3. Function</h5><p>函数方法的可选参数通过在参数列表中用 {} 指定，例如：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> say(<span class="built_in">String</span> name, &#123;<span class="built_in">String</span> word = <span class="string">&#x27;hello&#x27;</span>&#125;)&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;<span class="subst">$name</span> say <span class="subst">$word</span>&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过（可选参数名 + :）进行可选参数的赋值</span></span><br><span class="line">main()&#123;</span><br><span class="line">    say(<span class="string">&#x27;kuky&#x27;</span>, word: <span class="string">&#x27;Hello World&#x27;</span>); <span class="comment">// kuky say Hello World</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>word 参数为可选参数，默认值为 hello</p>
<h5 id="4-Operators"><a href="#4-Operators" class="headerlink" title="4. Operators"></a>4. Operators</h5><p>操作符几乎和别的语言类似，提个比较特殊的赋值操作符 <code>??=</code> 和 <code>?.</code>操作符</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> b ?? = a; <span class="comment">// 如果 b 的值是 null 则将 a 赋值给 b，否则保持不变</span></span><br><span class="line"><span class="keyword">var</span> c = size?.x; <span class="comment">// 如果 size 为 null 则返回 null，否则返回 size.a 的值</span></span><br></pre></td></tr></table></figure>

<h5 id="5-Conditional-Expressions"><a href="#5-Conditional-Expressions" class="headerlink" title="5. Conditional Expressions"></a>5. Conditional Expressions</h5><p><code>Dart</code> 可以通过两个特殊的操作符替换 <code>if()&#123;&#125; else&#123;&#125;</code> 表达式</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="language-markdown">condition? expr1: expr2 同 java 三目运算符</span></span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">if</span>(a &lt; <span class="number">0</span>) -a : a</span><br><span class="line"><span class="comment">/// <span class="language-markdown">expr1 ?? expr2 </span></span></span><br><span class="line"><span class="built_in">String</span> toString() =&gt; msg ?? <span class="keyword">super</span>.toString() <span class="comment">// 如果 expr1 不为 null 则返回 expr1 否则返回 expr2</span></span><br></pre></td></tr></table></figure>

<h5 id="6-Cascade-Notaion"><a href="#6-Cascade-Notaion" class="headerlink" title="6. Cascade Notaion(..)"></a>6. Cascade Notaion(..)</h5><p>级联操作符 (<code>..</code>) 可以在同一个对象上 连续调用多个函数以及访问成员变量</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Size</span></span>&#123;</span><br><span class="line">    <span class="built_in">double</span> x;</span><br><span class="line">    <span class="built_in">double</span> y;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">String</span> toString() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Size&#123;x: <span class="subst">$x</span>, y: <span class="subst">$y</span>&#125;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> size = Size();</span><br><span class="line"><span class="comment">/// <span class="language-markdown">通过级联操作符进行赋值，可以更加简洁，!!如果函数返回值为 void 则不能进行级联!!</span></span></span><br><span class="line"><span class="built_in">print</span>(size</span><br><span class="line">      ..x = <span class="number">10</span></span><br><span class="line">      ..y = <span class="number">100</span></span><br><span class="line">      ..toString()); <span class="comment">/// <span class="language-markdown">输出 Size&#123;x: 10.0, y: 100.0&#125;</span></span></span><br></pre></td></tr></table></figure>

<h5 id="7-foreach"><a href="#7-foreach" class="headerlink" title="7. foreach"></a>7. foreach</h5><p>通过 <code>foreach</code> 循环遍历一个实现 <code>Iterable</code> 接口的对象</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> maps = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;;</span><br><span class="line"></span><br><span class="line">items.where((i) =&gt; i &gt; <span class="number">2</span>).forEach((i) =&gt; <span class="built_in">print</span>(i));  <span class="comment">// 3, 4, 5</span></span><br><span class="line">maps.forEach((key, value) =&gt; <span class="built_in">print</span>(<span class="string">&#x27;<span class="subst">$key</span> =&gt; <span class="subst">$value</span>&#x27;</span>)); <span class="comment">// a =&gt; 1, b =&gt; 2</span></span><br></pre></td></tr></table></figure>

<h5 id="8-Switch-and-case"><a href="#8-Switch-and-case" class="headerlink" title="8. Switch and case"></a>8. Switch and case</h5><p>如果需要实现继续到下一个 <code>case</code> 语句中继续执行，则可以 使用 <code>continue</code> 语句跳转到对应的标签处继续执行</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> command = <span class="string">&#x27;Close&#x27;</span>;</span><br><span class="line"><span class="keyword">switch</span> (command.toLowerCase()) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;close&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;close&#x27;</span>);</span><br><span class="line">    <span class="keyword">continue</span> open;</span><br><span class="line">        </span><br><span class="line">  open: <span class="comment">// 这是个标签</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;open&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;open&#x27;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-Assert"><a href="#9-Assert" class="headerlink" title="9. Assert"></a>9. Assert</h5><p>如果条件表达式结果不满足需要，则可以使用 <code>assert</code> 语句俩打断代码的执行，例如：<code>assert(a == 1);</code></p>
<h5 id="10-Exceptions"><a href="#10-Exceptions" class="headerlink" title="10. Exceptions"></a>10. Exceptions</h5><p>所有的 <code>Dart</code> 异常是非检查异常。捕捉 <code>exceptions</code> 的时候可以通过 <code>on</code> 指定 <code>exceptions</code> 类型，再使用 <code>catch</code> 捕获</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; <span class="keyword">on</span> OutOfLlamasException &#123;</span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125; <span class="keyword">on</span> Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Unknown exception: <span class="subst">$e</span>&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e, s) &#123; <span class="comment">// 函数 catch 可以带有一个或两个参数，第一个参数为抛出的异常对象，第二个为堆栈信息</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Something really unknown: <span class="subst">$e</span>&#x27;</span>);</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Stack trace:\n <span class="subst">$s</span>&#x27;</span>);</span><br><span class="line">  <span class="keyword">rethrow</span>; <span class="comment">// 通过 rethrow 可以将异常重新抛出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="11-Classes"><a href="#11-Classes" class="headerlink" title="11. Classes"></a>11. Classes</h5><p><code>Dart</code> 中的类都是单继承，但是同时支持 <em><code>mixin</code></em> 的继承机制（<strong>除 <code>Object</code> 类，每个类都只有一个超类</strong>），所有的类都继承于 <code>Object</code>，通过调用 <code>runtimeType</code> 判断实例的类型。每个实例变量都会自动生成一个 <em><code>getter</code></em> 方法（隐含的）， Non-final 实例变量还会自动生成一个 <em><code>setter</code></em> 方法。</p>
<ul>
<li><p>Constructors</p>
<p><code>Dart</code> 的构造函数同 <code>Java</code> 类似</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Size</span> </span>&#123;</span><br><span class="line">  <span class="built_in">num</span> x, y;</span><br><span class="line"></span><br><span class="line">  Size(<span class="built_in">num</span> nx, <span class="built_in">num</span> y)&#123;</span><br><span class="line">    x = nx;</span><br><span class="line">    <span class="keyword">this</span>.y = y; <span class="comment">// this 关键字只有当名字冲突时候使用，否则 Dart 推荐省略 this</span></span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  Size(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y); <span class="comment">// Dart 通过语法糖省略了构造函数的赋值过程，效果同上</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果没有定义构造函数，则会有个默认构造函数。默认构造函数没有参数，并且会调用超类的 没有参数的构造函数。子类不会继承超类的构造函数，子类如果没有定义构造函数，则只有一个默认构造函数。</p>
<p><code>Dart</code> 通过命名构造函数为类创建多个构造函数，同时指明意图</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Size</span> </span>&#123;</span><br><span class="line">  <span class="built_in">num</span> x, y;</span><br><span class="line"></span><br><span class="line">  Size(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line"></span><br><span class="line">  Size.fromJson(<span class="built_in">Map</span> json)&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = json[<span class="string">&#x27;x&#x27;</span>];</span><br><span class="line">    <span class="keyword">this</span>.y = json[<span class="string">&#x27;y&#x27;</span>];</span><br><span class="line">  &#125; <span class="comment">// 因为构造函数不能继承，如果希望子类也有超类一样的命名构造函数，必须在子类中实现该构造函数</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 构造函数体执行之前除了可以调用超类构造函数之外，还可以初始化实例参数</span></span><br><span class="line">  <span class="comment">// 初始化列表非常适合用来设置 final 变量的值</span></span><br><span class="line">  Size.fromJsonInit(<span class="built_in">Map</span> json)</span><br><span class="line">      : <span class="keyword">this</span>.x = json[<span class="string">&#x27;x&#x27;</span>],</span><br><span class="line">        <span class="keyword">this</span>.y = json[<span class="string">&#x27;y&#x27;</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>常量构造函数（如果类需要提供一个状态不变的对象，通过 <code>const</code> 构造函数实现）</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConstPoint</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">num</span> x;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">num</span> y;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ConstPoint(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>工厂方法构造函数（如果一个类不需要每次都提供一个新的对象，通过 <code>factory</code> 构造函数实现）</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpCore</span> </span>&#123;</span><br><span class="line">  HttpCore._internal();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">factory</span> HttpCore() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_instance == <span class="keyword">null</span>) _instance = HttpCore._internal();</span><br><span class="line">    <span class="keyword">return</span> _instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> HttpCore _instance;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> HttpCore <span class="keyword">get</span> instance =&gt; HttpCore();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">void</span> _request()&#123;</span><br><span class="line">      <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>每个类都隐式的定义了一个包含所有实例成员的接口， 并且这个类实现了这个接口，通过抽象类实现类似 <code>Java</code> 接口的功能。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Callback</span> </span>&#123;</span><br><span class="line">  <span class="keyword">void</span> <span class="built_in">print</span>(<span class="built_in">String</span> msg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">Callback</span></span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> <span class="built_in">print</span>(<span class="built_in">String</span> msg) &#123;</span><br><span class="line">    <span class="built_in">print</span>(msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Mixins  <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a578bd2c42aa">Dart | 什么是Mixin</a></p>
</li>
</ul>
<h5 id="12-Asynchrony-support"><a href="#12-Asynchrony-support" class="headerlink" title="12. Asynchrony support"></a>12. Asynchrony support</h5><ol>
<li><p><code>Future</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">loopIntegers() &#123;</span><br><span class="line">  <span class="comment">// 通过 then 进行获取到 Future 对象后的操作</span></span><br><span class="line">  getListDelay().then((ints) =&gt; ints.forEach((i) =&gt; <span class="built_in">print</span>(i)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成一个 Future 对象</span></span><br><span class="line">Future&lt;<span class="built_in">List</span>&lt;<span class="built_in">int</span>&gt;&gt; getListDelay() &#123;</span><br><span class="line">  <span class="keyword">return</span> Future.delayed(<span class="built_in">Duration</span>(seconds: <span class="number">2</span>), () =&gt; <span class="built_in">List</span>.generate(<span class="number">10</span>, (delta) =&gt; delta));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过 <code>async</code> <code>await</code> 简化 <code>Future</code> 操作</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">runUsingFuture() &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  findEntrypoint().then((entrypoint) &#123;</span><br><span class="line">    <span class="keyword">return</span> runExecutable(entrypoint, args);</span><br><span class="line">  &#125;).then(flushThenExit);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简化了 then</span></span><br><span class="line">runUsingAsyncAwait() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="keyword">var</span> entrypoint = <span class="keyword">await</span> findEntrypoint();</span><br><span class="line">  <span class="keyword">var</span> exitCode = <span class="keyword">await</span> runExecutable(entrypoint, args);</span><br><span class="line">  <span class="keyword">await</span> flushThenExit(exitCode);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>有时候要求调用很多异步方法，并且等待 所有方法完成后再继续执行，通过使用 <code>Future.wait()</code> 进行管理</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Future deleteDone = deleteLotsOfFiles();</span><br><span class="line">Future copyDone = copyLotsOfFiles();</span><br><span class="line">Future checksumDone = checksumLotsOfOtherFiles();</span><br><span class="line"></span><br><span class="line">Future.wait([deleteDone, copyDone, checksumDone])</span><br><span class="line">    .then((<span class="built_in">List</span> values) &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&#x27;Done with all the long steps&#x27;</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Stream <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a5d7758938ef">Dart|什么是 Stream</a></p>
</li>
</ol>
<p>大概了解了 <code>Dart</code> 的语法，下节就开始写 <code>Flutter</code> 啦~，环境的安装具体查看官网，很详细 <a target="_blank" rel="noopener" href="https://flutterchina.club/get-started/install/">Flutter 环境安装</a> 记得一定要<strong>配置镜像，配置镜像，配置镜像</strong> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/09/Flutter-%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-01/" data-id="cl0ukmc2k0005pn1gg31papdt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dart/" rel="tag">Dart</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/FFmpeg/">FFmpeg</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JNI/">JNI</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%88%AC%E8%99%AB-Spider/">爬虫 Spider</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">跨平台</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dart/" rel="tag">Dart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFmpeg/" rel="tag">FFmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JNI/" rel="tag">JNI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jetpack/" rel="tag">Jetpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDL/" rel="tag">SDL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapy/" rel="tag">Scrapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fish-redux/" rel="tag">fish_redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%BF-iOS/" rel="tag">仿 iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag">源码分析</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/Dart/" style="font-size: 12.5px;">Dart</a> <a href="/tags/FFmpeg/" style="font-size: 12.5px;">FFmpeg</a> <a href="/tags/Flutter/" style="font-size: 17.5px;">Flutter</a> <a href="/tags/JNI/" style="font-size: 10px;">JNI</a> <a href="/tags/Jetpack/" style="font-size: 10px;">Jetpack</a> <a href="/tags/Kotlin/" style="font-size: 10px;">Kotlin</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/SDL/" style="font-size: 10px;">SDL</a> <a href="/tags/Scrapy/" style="font-size: 10px;">Scrapy</a> <a href="/tags/fish-redux/" style="font-size: 10px;">fish_redux</a> <a href="/tags/%E4%BB%BF-iOS/" style="font-size: 12.5px;">仿 iOS</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 10px;">源码分析</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/19/fish-redux-%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/">fish_redux 「食用指南」</a>
          </li>
        
          <li>
            <a href="/2019/10/22/FFmpeg-002/">初识 SDL2</a>
          </li>
        
          <li>
            <a href="/2019/10/16/FFmpeg-001/">FFmpeg 配置</a>
          </li>
        
          <li>
            <a href="/2019/09/09/%E5%88%9D%E8%AF%86-JNI/">初识 JNI</a>
          </li>
        
          <li>
            <a href="/2019/09/01/Jetpack-Navigation-%E5%88%86%E6%9E%90/">Jetpack Navigation 分析</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>